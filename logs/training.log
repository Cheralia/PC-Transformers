2025-09-17 09:24:10,944 - INFO - 
########################################################################################################################
2025-09-17 09:24:10,944 - INFO - Using device: cpu (local rank 0)
2025-09-17 09:24:10,944 - INFO - Saving the hyperparameters configurations:
2025-09-17 09:24:10,944 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 1e-05,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1,
      "T": 2,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 09:24:11,298 - INFO - ========== Training started ==========
2025-09-17 09:24:11,299 - INFO - 6.60 M parameters
2025-09-17 09:24:11,299 - INFO - Epoch 1/2
2025-09-17 09:24:16,788 - INFO -   Batch 10/5258 | Batch Energy: 2.9879 | Perplexity: 332899.9098
2025-09-17 09:24:20,785 - INFO -   Batch 20/5258 | Batch Energy: 2.9825 | Perplexity: 13534486.9063
2025-09-17 09:24:24,884 - INFO -   Batch 30/5258 | Batch Energy: 3.0397 | Perplexity: 88880474.2876
2025-09-17 09:24:28,452 - INFO -   Batch 40/5258 | Batch Energy: 3.0825 | Perplexity: 43665266316.6066
2025-09-17 09:24:32,526 - INFO -   Batch 50/5258 | Batch Energy: 3.2599 | Perplexity: 3535787412727.1147
2025-09-17 09:24:36,289 - INFO -   Batch 60/5258 | Batch Energy: 3.3536 | Perplexity: 283788710086817.0625
2025-09-17 09:24:41,291 - INFO -   Batch 70/5258 | Batch Energy: 3.3875 | Perplexity: 28435900190665132.0000
2025-09-17 09:24:45,615 - INFO -   Batch 80/5258 | Batch Energy: 3.5660 | Perplexity: 129102267519288557568.0000
2025-09-17 09:24:49,889 - INFO -   Batch 90/5258 | Batch Energy: 3.7036 | Perplexity: 1047938236901896749056.0000
2025-09-17 09:24:54,954 - INFO -   Batch 100/5258 | Batch Energy: 3.7250 | Perplexity: 6135279512637050716160.0000
2025-09-17 09:24:59,283 - INFO -   Batch 110/5258 | Batch Energy: 3.8149 | Perplexity: 3037060789690324668645376.0000
2025-09-17 09:25:04,547 - INFO -   Batch 120/5258 | Batch Energy: 3.9787 | Perplexity: 22411925490344763582316544.0000
2025-09-17 09:25:08,413 - INFO -   Batch 130/5258 | Batch Energy: 4.3636 | Perplexity: 112768778477477241238712983314497536.0000
2025-09-17 09:25:13,616 - INFO -   Batch 140/5258 | Batch Energy: 4.1106 | Perplexity: 27845612696598929568423236075520.0000
2025-09-17 09:25:17,831 - INFO -   Batch 150/5258 | Batch Energy: 4.5831 | Perplexity: 66783884242470365099296424984576.0000
2025-09-17 09:25:22,840 - INFO -   Batch 160/5258 | Batch Energy: 4.5881 | Perplexity: 391393857891485783290241168120479744000.0000
2025-09-17 09:25:26,626 - INFO -   Batch 170/5258 | Batch Energy: 4.3957 | Perplexity: 22821222024662076140498658453880832.0000
2025-09-17 09:25:31,336 - INFO -   Batch 180/5258 | Batch Energy: 4.6911 | Perplexity: 17317510311541457968760494998738173952.0000
2025-09-17 09:25:35,821 - INFO -   Batch 190/5258 | Batch Energy: 4.9158 | Perplexity: 183157740948072500860957875767345152.0000
2025-09-17 09:25:40,766 - INFO -   Batch 200/5258 | Batch Energy: 5.0309 | Perplexity: 53285555458350246651618888558701445120.0000
2025-09-17 09:25:46,210 - INFO -   Batch 210/5258 | Batch Energy: 5.2031 | Perplexity: 560650093439581980203218246274383872000.0000
2025-09-17 09:25:53,081 - INFO -   Batch 220/5258 | Batch Energy: 5.1847 | Perplexity: 613625946415369736220486335023022080.0000
2025-09-17 09:26:00,506 - INFO -   Batch 230/5258 | Batch Energy: 5.2429 | Perplexity: 214077554705818425503811028551467008.0000
2025-09-17 09:26:05,650 - INFO -   Batch 240/5258 | Batch Energy: 5.4209 | Perplexity: 25898135977579373591549377456898048.0000
2025-09-17 09:26:10,813 - INFO -   Batch 250/5258 | Batch Energy: 5.3779 | Perplexity: 1933152767469737036995775641277169664.0000
2025-09-17 09:26:16,740 - INFO -   Batch 260/5258 | Batch Energy: 5.5727 | Perplexity: 13145450791233615859081031930888585216.0000
2025-09-17 09:26:21,539 - INFO -   Batch 270/5258 | Batch Energy: 5.6708 | Perplexity: 1353417547465015793329588184023040.0000
2025-09-17 09:26:26,508 - INFO -   Batch 280/5258 | Batch Energy: 5.6175 | Perplexity: 8893075916167736416465759817845237088256.0000
2025-09-17 09:26:31,315 - INFO -   Batch 290/5258 | Batch Energy: 6.3805 | Perplexity: 23513745137513630268064939376640.0000
2025-09-17 09:26:36,316 - INFO -   Batch 300/5258 | Batch Energy: 6.0589 | Perplexity: 14141043105783860310004446657293320192.0000
2025-09-17 09:26:40,653 - INFO -   Batch 310/5258 | Batch Energy: 6.1223 | Perplexity: 361690283707976811692241925423079882752.0000
2025-09-17 09:26:45,947 - INFO -   Batch 320/5258 | Batch Energy: 6.2693 | Perplexity: inf
2025-09-17 09:26:49,702 - INFO -   Batch 330/5258 | Batch Energy: 6.2371 | Perplexity: inf
2025-09-17 09:26:53,951 - INFO -   Batch 340/5258 | Batch Energy: 6.5309 | Perplexity: inf
2025-09-17 09:26:58,111 - INFO -   Batch 350/5258 | Batch Energy: 6.3618 | Perplexity: 174652238933013055668415580461351607205888.0000
2025-09-17 09:27:02,508 - INFO -   Batch 360/5258 | Batch Energy: 6.6947 | Perplexity: 27107364878684106572423439473805254197248.0000
2025-09-17 09:27:06,635 - INFO -   Batch 370/5258 | Batch Energy: 6.9034 | Perplexity: inf
2025-09-17 09:27:11,023 - INFO -   Batch 380/5258 | Batch Energy: 6.8975 | Perplexity: 176702895256726651486273457572404673904640.0000
2025-09-17 09:27:15,568 - INFO -   Batch 390/5258 | Batch Energy: 7.7940 | Perplexity: inf
2025-09-17 09:27:19,516 - INFO -   Batch 400/5258 | Batch Energy: 7.1340 | Perplexity: 222522910997372070811429880006388364607488.0000
2025-09-17 09:27:23,988 - INFO -   Batch 410/5258 | Batch Energy: 7.9447 | Perplexity: 192330852433711388623006767231322669711360.0000
2025-09-17 09:27:28,117 - INFO -   Batch 420/5258 | Batch Energy: 7.7437 | Perplexity: inf
2025-09-17 09:27:32,110 - INFO -   Batch 430/5258 | Batch Energy: 8.1865 | Perplexity: 37926434610811407625880811364941824.0000
2025-09-17 09:27:36,600 - INFO -   Batch 440/5258 | Batch Energy: 8.2427 | Perplexity: 887356594818097904821222542027316325777408.0000
2025-09-17 09:27:43,231 - INFO -   Batch 450/5258 | Batch Energy: 8.2749 | Perplexity: 3205480715532801763786691862274959753609216.0000
2025-09-17 09:27:47,529 - INFO -   Batch 460/5258 | Batch Energy: 8.2332 | Perplexity: inf
2025-09-17 09:27:52,145 - INFO -   Batch 470/5258 | Batch Energy: 8.1776 | Perplexity: 1569490022635937088486514376018683139981312.0000
2025-09-17 09:27:57,689 - INFO -   Batch 480/5258 | Batch Energy: 8.5368 | Perplexity: inf
2025-09-17 09:28:01,940 - INFO -   Batch 490/5258 | Batch Energy: 9.3267 | Perplexity: inf
2025-09-17 09:28:06,575 - INFO -   Batch 500/5258 | Batch Energy: 10.5681 | Perplexity: inf
2025-09-17 09:28:11,509 - INFO -   Batch 510/5258 | Batch Energy: 8.8014 | Perplexity: inf
2025-09-17 09:28:16,000 - INFO -   Batch 520/5258 | Batch Energy: 9.8723 | Perplexity: inf
2025-09-17 09:28:20,443 - INFO -   Batch 530/5258 | Batch Energy: 10.2043 | Perplexity: inf
2025-09-17 09:28:24,547 - INFO -   Batch 540/5258 | Batch Energy: 10.6303 | Perplexity: 395529502383504383869438743896464006578176.0000
2025-09-17 09:28:28,287 - INFO -   Batch 550/5258 | Batch Energy: 10.3175 | Perplexity: inf
2025-09-17 09:28:33,613 - INFO -   Batch 560/5258 | Batch Energy: 11.6872 | Perplexity: inf
2025-09-17 09:28:37,806 - INFO -   Batch 570/5258 | Batch Energy: 10.7959 | Perplexity: inf
2025-09-17 09:28:42,048 - INFO -   Batch 580/5258 | Batch Energy: 10.9461 | Perplexity: inf
2025-09-17 09:28:46,121 - INFO -   Batch 590/5258 | Batch Energy: 10.4630 | Perplexity: inf
2025-09-17 09:28:50,482 - INFO -   Batch 600/5258 | Batch Energy: 11.5203 | Perplexity: inf
2025-09-17 09:28:54,628 - INFO -   Batch 610/5258 | Batch Energy: 10.2486 | Perplexity: inf
2025-09-17 09:28:59,603 - INFO -   Batch 620/5258 | Batch Energy: 10.4579 | Perplexity: inf
2025-09-17 09:29:03,866 - INFO -   Batch 630/5258 | Batch Energy: 11.3328 | Perplexity: inf
2025-09-17 09:29:08,006 - INFO -   Batch 640/5258 | Batch Energy: 10.0960 | Perplexity: inf
2025-09-17 09:29:13,195 - INFO -   Batch 650/5258 | Batch Energy: 11.7521 | Perplexity: inf
2025-09-17 09:29:17,280 - INFO -   Batch 660/5258 | Batch Energy: 13.2575 | Perplexity: inf
2025-09-17 09:35:55,782 - INFO - 
########################################################################################################################
2025-09-17 09:35:55,782 - INFO - Using device: cpu (local rank 0)
2025-09-17 09:35:55,782 - INFO - Saving the hyperparameters configurations:
2025-09-17 09:35:55,783 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 1e-05,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1,
      "T": 2,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 09:35:56,097 - INFO - ========== Training started ==========
2025-09-17 09:35:56,098 - INFO - 6.60 M parameters
2025-09-17 09:35:56,098 - INFO - Epoch 1/2
2025-09-17 09:35:58,153 - INFO -   Batch 10/3655 | Batch Energy: 3.1033 | Perplexity: 44973.6008
2025-09-17 09:36:00,072 - INFO -   Batch 20/3655 | Batch Energy: 3.0873 | Perplexity: 78339.6640
2025-09-17 09:36:02,075 - INFO -   Batch 30/3655 | Batch Energy: 3.2185 | Perplexity: 495935.2199
2025-09-17 09:36:03,961 - INFO -   Batch 40/3655 | Batch Energy: 3.2027 | Perplexity: 1127325.9847
2025-09-17 09:36:05,877 - INFO -   Batch 50/3655 | Batch Energy: 3.1567 | Perplexity: 119513.6597
2025-09-17 09:36:07,740 - INFO -   Batch 60/3655 | Batch Energy: 3.2623 | Perplexity: 1133306.4570
2025-09-17 09:36:09,663 - INFO -   Batch 70/3655 | Batch Energy: 3.2906 | Perplexity: 4997279.1100
2025-09-17 09:36:11,559 - INFO -   Batch 80/3655 | Batch Energy: 3.2090 | Perplexity: 2519124.1624
2025-09-17 09:36:13,482 - INFO -   Batch 90/3655 | Batch Energy: 3.2378 | Perplexity: 23667747.0325
2025-09-17 09:36:15,408 - INFO -   Batch 100/3655 | Batch Energy: 3.4197 | Perplexity: 27366971.1596
2025-09-17 09:36:17,293 - INFO -   Batch 110/3655 | Batch Energy: 3.2837 | Perplexity: 16523317.5619
2025-09-17 09:36:19,202 - INFO -   Batch 120/3655 | Batch Energy: 3.2359 | Perplexity: 243027070.2694
2025-09-17 09:36:21,148 - INFO -   Batch 130/3655 | Batch Energy: 3.4038 | Perplexity: 48670443.9923
2025-09-17 09:36:23,067 - INFO -   Batch 140/3655 | Batch Energy: 3.3282 | Perplexity: 61002066.8557
2025-09-17 09:36:24,982 - INFO -   Batch 150/3655 | Batch Energy: 3.3201 | Perplexity: 23080130441.8710
2025-09-17 09:36:26,899 - INFO -   Batch 160/3655 | Batch Energy: 3.3489 | Perplexity: 2347991445.4739
2025-09-17 09:36:28,788 - INFO -   Batch 170/3655 | Batch Energy: 3.4269 | Perplexity: 263126495.7058
2025-09-17 09:36:30,705 - INFO -   Batch 180/3655 | Batch Energy: 3.3226 | Perplexity: 1118598508.7671
2025-09-17 09:36:32,640 - INFO -   Batch 190/3655 | Batch Energy: 3.4556 | Perplexity: 1242448142.7632
2025-09-17 09:36:34,563 - INFO -   Batch 200/3655 | Batch Energy: 3.3953 | Perplexity: 160380906678.6131
2025-09-17 09:36:36,506 - INFO -   Batch 210/3655 | Batch Energy: 3.5825 | Perplexity: 189762287928.8183
2025-09-17 09:36:38,394 - INFO -   Batch 220/3655 | Batch Energy: 3.5831 | Perplexity: 90253073040.2082
2025-09-17 09:36:40,325 - INFO -   Batch 230/3655 | Batch Energy: 3.4405 | Perplexity: 364164159373.9285
2025-09-17 09:36:42,365 - INFO -   Batch 240/3655 | Batch Energy: 3.4909 | Perplexity: 20484626640798.9336
2025-09-17 09:36:44,477 - INFO -   Batch 250/3655 | Batch Energy: 3.4986 | Perplexity: 13944278449402.5645
2025-09-17 09:36:46,561 - INFO -   Batch 260/3655 | Batch Energy: 3.4065 | Perplexity: 243425389774987.3125
2025-09-17 09:36:48,611 - INFO -   Batch 270/3655 | Batch Energy: 3.6807 | Perplexity: 1125287074327953.2500
2025-09-17 09:36:50,595 - INFO -   Batch 280/3655 | Batch Energy: 3.6179 | Perplexity: 1042055201656707.0000
2025-09-17 09:36:52,647 - INFO -   Batch 290/3655 | Batch Energy: 3.4731 | Perplexity: 1176365749220875.5000
2025-09-17 09:36:54,657 - INFO -   Batch 300/3655 | Batch Energy: 3.4503 | Perplexity: 1356910082008008.5000
2025-09-17 09:36:56,687 - INFO -   Batch 310/3655 | Batch Energy: 3.5563 | Perplexity: 2007120389059852.2500
2025-09-17 09:36:58,666 - INFO -   Batch 320/3655 | Batch Energy: 3.4441 | Perplexity: 275361273319512928.0000
2025-09-17 09:37:00,594 - INFO -   Batch 330/3655 | Batch Energy: 3.6555 | Perplexity: 6456217648104775.0000
2025-09-17 09:37:02,541 - INFO -   Batch 340/3655 | Batch Energy: 3.8104 | Perplexity: 11799546151882780672.0000
2025-09-17 09:37:04,552 - INFO -   Batch 350/3655 | Batch Energy: 3.6492 | Perplexity: 664236430328560128.0000
2025-09-17 09:37:06,587 - INFO -   Batch 360/3655 | Batch Energy: 3.6287 | Perplexity: 3107531678955262976.0000
2025-09-17 09:37:08,581 - INFO -   Batch 370/3655 | Batch Energy: 3.8507 | Perplexity: 605953429373677824.0000
2025-09-17 09:37:10,606 - INFO -   Batch 380/3655 | Batch Energy: 3.6216 | Perplexity: 942267771373119104.0000
2025-09-17 09:37:12,618 - INFO -   Batch 390/3655 | Batch Energy: 3.5254 | Perplexity: 734743633020790912.0000
2025-09-17 09:37:14,599 - INFO -   Batch 400/3655 | Batch Energy: 3.6792 | Perplexity: 25732340077317087821824.0000
2025-09-17 09:37:16,614 - INFO -   Batch 410/3655 | Batch Energy: 3.7319 | Perplexity: 6154491637325771776.0000
2025-09-17 09:37:18,623 - INFO -   Batch 420/3655 | Batch Energy: 3.7626 | Perplexity: 1800721489981115727872.0000
2025-09-17 09:37:20,567 - INFO -   Batch 430/3655 | Batch Energy: 3.6428 | Perplexity: 1795786555763231744.0000
2025-09-17 09:37:22,563 - INFO -   Batch 440/3655 | Batch Energy: 3.8830 | Perplexity: 386018214183414792192.0000
2025-09-17 09:37:24,536 - INFO -   Batch 450/3655 | Batch Energy: 4.0658 | Perplexity: 54853549856951140352.0000
2025-09-17 09:37:26,593 - INFO -   Batch 460/3655 | Batch Energy: 4.0863 | Perplexity: 19934157075549339516928.0000
2025-09-17 09:37:28,585 - INFO -   Batch 470/3655 | Batch Energy: 3.8907 | Perplexity: 1570335626866729156608.0000
2025-09-17 09:37:30,548 - INFO -   Batch 480/3655 | Batch Energy: 3.9463 | Perplexity: 59606825177730646016.0000
2025-09-17 09:37:32,574 - INFO -   Batch 490/3655 | Batch Energy: 3.6895 | Perplexity: 433570779595610674692096.0000
2025-09-17 09:37:34,562 - INFO -   Batch 500/3655 | Batch Energy: 3.7507 | Perplexity: 271814358313906470912.0000
2025-09-17 09:37:36,538 - INFO -   Batch 510/3655 | Batch Energy: 3.7969 | Perplexity: 13349813093792152027136.0000
2025-09-17 09:37:38,583 - INFO -   Batch 520/3655 | Batch Energy: 3.8580 | Perplexity: 16599413684329655566336.0000
2025-09-17 09:37:40,519 - INFO -   Batch 530/3655 | Batch Energy: 4.0599 | Perplexity: 9807829587804439500029952.0000
2025-09-17 09:37:42,497 - INFO -   Batch 540/3655 | Batch Energy: 4.0158 | Perplexity: 72944215713795555721216.0000
2025-09-17 09:37:44,512 - INFO -   Batch 550/3655 | Batch Energy: 4.0900 | Perplexity: 1089315119788410789691392.0000
2025-09-17 09:37:46,448 - INFO -   Batch 560/3655 | Batch Energy: 3.9584 | Perplexity: 135221650355819560960.0000
2025-09-17 09:37:48,394 - INFO -   Batch 570/3655 | Batch Energy: 3.9980 | Perplexity: 38048565274408685731315712.0000
2025-09-17 09:37:50,328 - INFO -   Batch 580/3655 | Batch Energy: 4.1628 | Perplexity: 2319552341973724527853568.0000
2025-09-17 09:37:52,247 - INFO -   Batch 590/3655 | Batch Energy: 3.8574 | Perplexity: 35742446591137399439360.0000
2025-09-17 09:37:54,200 - INFO -   Batch 600/3655 | Batch Energy: 3.8977 | Perplexity: 155863990089699811131392.0000
2025-09-17 09:37:56,194 - INFO -   Batch 610/3655 | Batch Energy: 4.2139 | Perplexity: 7501415302904744199061504.0000
2025-09-17 09:37:58,165 - INFO -   Batch 620/3655 | Batch Energy: 4.1438 | Perplexity: 114747028642478502984024064.0000
2025-09-17 09:38:00,205 - INFO -   Batch 630/3655 | Batch Energy: 4.3163 | Perplexity: 593492894932598837653536768.0000
2025-09-17 09:38:02,228 - INFO -   Batch 640/3655 | Batch Energy: 4.0187 | Perplexity: 8419486693868570417936990208.0000
2025-09-17 09:38:04,278 - INFO -   Batch 650/3655 | Batch Energy: 4.0012 | Perplexity: 34854776617793239300177920.0000
2025-09-17 09:38:06,361 - INFO -   Batch 660/3655 | Batch Energy: 4.3198 | Perplexity: 27133704843714264825856.0000
2025-09-17 09:38:08,411 - INFO -   Batch 670/3655 | Batch Energy: 4.2572 | Perplexity: 4576872637480038385582080.0000
2025-09-17 09:38:10,460 - INFO -   Batch 680/3655 | Batch Energy: 4.3825 | Perplexity: 10724724016609764665458688.0000
2025-09-17 09:38:12,609 - INFO -   Batch 690/3655 | Batch Energy: 4.0896 | Perplexity: 207539210161609997650231296.0000
2025-09-17 09:38:14,668 - INFO -   Batch 700/3655 | Batch Energy: 4.0996 | Perplexity: 17477278157975145121054720.0000
2025-09-17 09:38:16,629 - INFO -   Batch 710/3655 | Batch Energy: 4.2001 | Perplexity: 48396861765804740972029935616.0000
2025-09-17 09:38:18,657 - INFO -   Batch 720/3655 | Batch Energy: 4.2149 | Perplexity: 11041340193398986941399040.0000
2025-09-17 09:38:20,708 - INFO -   Batch 730/3655 | Batch Energy: 4.2380 | Perplexity: 140582417647896023470702592.0000
2025-09-17 09:38:22,818 - INFO -   Batch 740/3655 | Batch Energy: 4.3096 | Perplexity: 526084441712348186592411648.0000
2025-09-17 09:38:24,859 - INFO -   Batch 750/3655 | Batch Energy: 4.2400 | Perplexity: 813445926235306673431379968.0000
2025-09-17 09:38:26,812 - INFO -   Batch 760/3655 | Batch Energy: 4.2167 | Perplexity: 822747030206809488263768702976.0000
2025-09-17 09:38:28,758 - INFO -   Batch 770/3655 | Batch Energy: 4.2756 | Perplexity: 1690048777327929769378015346688.0000
2025-09-17 09:38:30,707 - INFO -   Batch 780/3655 | Batch Energy: 4.3954 | Perplexity: 48211416997881514498719744.0000
2025-09-17 09:38:32,703 - INFO -   Batch 790/3655 | Batch Energy: 4.4274 | Perplexity: 3014769149697806436591271411712.0000
2025-09-17 09:38:34,672 - INFO -   Batch 800/3655 | Batch Energy: 4.4166 | Perplexity: 2242400630634228106255138816.0000
2025-09-17 09:38:36,646 - INFO -   Batch 810/3655 | Batch Energy: 4.3628 | Perplexity: 96682729563523747596468224.0000
2025-09-17 09:38:38,570 - INFO -   Batch 820/3655 | Batch Energy: 4.4079 | Perplexity: 74946974568947179134648320.0000
2025-09-17 09:38:40,610 - INFO -   Batch 830/3655 | Batch Energy: 4.4779 | Perplexity: 80055137155574481903765422080.0000
2025-09-17 09:38:42,696 - INFO -   Batch 840/3655 | Batch Energy: 4.6335 | Perplexity: 19977198070764035603693568.0000
2025-09-17 09:38:44,734 - INFO -   Batch 850/3655 | Batch Energy: 4.8978 | Perplexity: 64353746053191426136604672.0000
2025-09-17 09:38:46,757 - INFO -   Batch 860/3655 | Batch Energy: 4.5086 | Perplexity: 4732812614702450306344298741760.0000
2025-09-17 09:38:48,748 - INFO -   Batch 870/3655 | Batch Energy: 4.5084 | Perplexity: 66266695757691043646394886782976.0000
2025-09-17 09:38:50,775 - INFO -   Batch 880/3655 | Batch Energy: 4.5957 | Perplexity: 7709315145423216302077509632.0000
2025-09-17 09:38:52,807 - INFO -   Batch 890/3655 | Batch Energy: 4.8539 | Perplexity: 2163580265703626595086609386831872.0000
2025-09-17 09:38:54,979 - INFO -   Batch 900/3655 | Batch Energy: 4.7133 | Perplexity: 1091083434570325083377555398983680.0000
2025-09-17 09:38:57,004 - INFO -   Batch 910/3655 | Batch Energy: 4.8677 | Perplexity: 12185477916749147905458176.0000
2025-09-17 09:38:59,056 - INFO -   Batch 920/3655 | Batch Energy: 4.4369 | Perplexity: 198966526546824392468986117226496.0000
2025-09-17 09:39:01,001 - INFO -   Batch 930/3655 | Batch Energy: 4.7467 | Perplexity: 1219146032580017968985193578496.0000
2025-09-17 09:39:02,949 - INFO -   Batch 940/3655 | Batch Energy: 4.7828 | Perplexity: 153579421950393887609766052626432.0000
2025-09-17 09:39:04,923 - INFO -   Batch 950/3655 | Batch Energy: 4.9960 | Perplexity: 160104793118684324302647535337472.0000
2025-09-17 09:39:06,878 - INFO -   Batch 960/3655 | Batch Energy: 4.8190 | Perplexity: 363101189807898634568390704009052160.0000
2025-09-17 09:39:08,837 - INFO -   Batch 970/3655 | Batch Energy: 4.8574 | Perplexity: 11495648155910127016897393977196544.0000
2025-09-17 09:39:10,804 - INFO -   Batch 980/3655 | Batch Energy: 4.9326 | Perplexity: 9604262754434061865680117956608.0000
2025-09-17 09:39:12,880 - INFO -   Batch 990/3655 | Batch Energy: 4.9824 | Perplexity: 608538132598673409741821476011969085440.0000
2025-09-17 09:39:14,916 - INFO -   Batch 1000/3655 | Batch Energy: 4.9774 | Perplexity: 3784735907033270023358824939782144.0000
2025-09-17 09:39:16,854 - INFO -   Batch 1010/3655 | Batch Energy: 4.9673 | Perplexity: 615496748633270879871818199231102976.0000
2025-09-17 09:39:18,851 - INFO -   Batch 1020/3655 | Batch Energy: 5.0453 | Perplexity: 12270616416583750232280430876295168.0000
2025-09-17 09:39:20,763 - INFO -   Batch 1030/3655 | Batch Energy: 5.0564 | Perplexity: 499628541253534297351263329177305088.0000
2025-09-17 09:39:22,699 - INFO -   Batch 1040/3655 | Batch Energy: 5.0223 | Perplexity: 156820132056718766782343939096576.0000
2025-09-17 09:39:24,658 - INFO -   Batch 1050/3655 | Batch Energy: 5.0103 | Perplexity: 236192084496128026237865620930560.0000
2025-09-17 09:39:26,630 - INFO -   Batch 1060/3655 | Batch Energy: 4.9994 | Perplexity: 8290093044388685219012542464.0000
2025-09-17 09:39:29,030 - INFO -   Batch 1070/3655 | Batch Energy: 5.2379 | Perplexity: 980124945846759524302155419746304.0000
2025-09-17 09:39:31,160 - INFO -   Batch 1080/3655 | Batch Energy: 5.1173 | Perplexity: 153196747712385138930404128980992.0000
2025-09-17 09:39:33,200 - INFO -   Batch 1090/3655 | Batch Energy: 5.0848 | Perplexity: 284916600845770199182968424694284288.0000
2025-09-17 09:39:35,238 - INFO -   Batch 1100/3655 | Batch Energy: 5.0120 | Perplexity: 1564690905736077373781535895612030976.0000
2025-09-17 09:39:37,158 - INFO -   Batch 1110/3655 | Batch Energy: 5.3813 | Perplexity: 459995024845905857321916791181541376.0000
2025-09-17 09:39:39,094 - INFO -   Batch 1120/3655 | Batch Energy: 5.3406 | Perplexity: 190374450634767025923360418693120.0000
2025-09-17 09:39:41,144 - INFO -   Batch 1130/3655 | Batch Energy: 5.2430 | Perplexity: 105852683104103687581315670999040.0000
2025-09-17 09:39:43,120 - INFO -   Batch 1140/3655 | Batch Energy: 5.2464 | Perplexity: 4499610977274377416636167580955413839872.0000
2025-09-17 09:39:45,213 - INFO -   Batch 1150/3655 | Batch Energy: 5.3472 | Perplexity: 2911224456907429072536947916737588756480.0000
2025-09-17 09:39:47,226 - INFO -   Batch 1160/3655 | Batch Energy: 5.4431 | Perplexity: 12626530273584480852751324737794211840.0000
2025-09-17 09:39:49,315 - INFO -   Batch 1170/3655 | Batch Energy: 5.5497 | Perplexity: 352300467262159073632001821989928960.0000
2025-09-17 09:39:51,347 - INFO -   Batch 1180/3655 | Batch Energy: 5.3530 | Perplexity: 961045892207296318724501786412101664768.0000
2025-09-17 09:39:53,382 - INFO -   Batch 1190/3655 | Batch Energy: 5.2870 | Perplexity: 471665763003096825277793397177843712.0000
2025-09-17 09:39:55,804 - INFO -   Batch 1200/3655 | Batch Energy: 5.4323 | Perplexity: 71901091718682121519816771633152.0000
2025-09-17 09:39:57,767 - INFO -   Batch 1210/3655 | Batch Energy: 5.2946 | Perplexity: 91575997027762936481525306856740749312.0000
2025-09-17 09:39:59,800 - INFO -   Batch 1220/3655 | Batch Energy: 5.5507 | Perplexity: 1046854661395607836949750888070158917566464.0000
2025-09-17 09:40:01,779 - INFO -   Batch 1230/3655 | Batch Energy: 5.4077 | Perplexity: 30493980503113183410226310712517459968.0000
2025-09-17 09:40:04,542 - INFO -   Batch 1240/3655 | Batch Energy: 5.5598 | Perplexity: 151352702408861021799804595368624128.0000
2025-09-17 09:40:06,672 - INFO -   Batch 1250/3655 | Batch Energy: 5.4537 | Perplexity: 11604032857223883697817968388866048.0000
2025-09-17 09:40:08,652 - INFO -   Batch 1260/3655 | Batch Energy: 5.6167 | Perplexity: 9138994429053592195095760664111611904.0000
2025-09-17 09:40:10,581 - INFO -   Batch 1270/3655 | Batch Energy: 5.5410 | Perplexity: 2159167552534363666594413220457961488384.0000
2025-09-17 09:40:12,599 - INFO -   Batch 1280/3655 | Batch Energy: 5.4761 | Perplexity: 44565689536450135543035893645312000.0000
2025-09-17 09:40:14,575 - INFO -   Batch 1290/3655 | Batch Energy: 5.5920 | Perplexity: 1452448257406925756797450314579968.0000
2025-09-17 09:40:16,580 - INFO -   Batch 1300/3655 | Batch Energy: 5.6537 | Perplexity: 235582714116279346949174193700879728640.0000
2025-09-17 09:40:18,530 - INFO -   Batch 1310/3655 | Batch Energy: 5.5276 | Perplexity: 24023600919344335378100317702848512.0000
2025-09-17 09:40:20,495 - INFO -   Batch 1320/3655 | Batch Energy: 5.7377 | Perplexity: 7542792760228583377113644985787216822272.0000
2025-09-17 09:40:22,465 - INFO -   Batch 1330/3655 | Batch Energy: 5.7441 | Perplexity: 7217707120615609631497728248774656.0000
2025-09-17 09:40:24,456 - INFO -   Batch 1340/3655 | Batch Energy: 5.9468 | Perplexity: 109001955273434969100269677585629184.0000
2025-09-17 09:40:26,565 - INFO -   Batch 1350/3655 | Batch Energy: 5.8440 | Perplexity: 77357497874703088805571534977465581568.0000
2025-09-17 09:40:28,601 - INFO -   Batch 1360/3655 | Batch Energy: 5.8289 | Perplexity: 26974154237840454901733526097807540224.0000
2025-09-17 09:40:30,599 - INFO -   Batch 1370/3655 | Batch Energy: 5.7462 | Perplexity: 1453903960384621383079633616896.0000
2025-09-17 09:40:32,517 - INFO -   Batch 1380/3655 | Batch Energy: 5.9720 | Perplexity: 91949637122757661995022152066306823684096.0000
2025-09-17 09:40:34,562 - INFO -   Batch 1390/3655 | Batch Energy: 5.9239 | Perplexity: 16098452548250077730561648201357180962603008.0000
2025-09-17 09:40:36,714 - INFO -   Batch 1400/3655 | Batch Energy: 6.0282 | Perplexity: 3411773925076488469519459500973563869921280.0000
2025-09-17 09:40:38,776 - INFO -   Batch 1410/3655 | Batch Energy: 5.8726 | Perplexity: 54522973123497579188831164649271459840.0000
2025-09-17 09:40:40,859 - INFO -   Batch 1420/3655 | Batch Energy: 6.2148 | Perplexity: 238741341814638091203920138369943413456896.0000
2025-09-17 09:40:43,012 - INFO -   Batch 1430/3655 | Batch Energy: 5.9654 | Perplexity: inf
2025-09-17 09:40:45,073 - INFO -   Batch 1440/3655 | Batch Energy: 5.9153 | Perplexity: 6982263275597997182453321029304179281100800.0000
2025-09-17 09:40:47,012 - INFO -   Batch 1450/3655 | Batch Energy: 5.9613 | Perplexity: 11693268969751347888231717283109021086121984.0000
2025-09-17 09:40:48,978 - INFO -   Batch 1460/3655 | Batch Energy: 6.1865 | Perplexity: 2460203692754981863725861657238879120392192.0000
2025-09-17 09:40:50,978 - INFO -   Batch 1470/3655 | Batch Energy: 6.0134 | Perplexity: 8642577883696596177092472042514966118400.0000
2025-09-17 09:40:52,951 - INFO -   Batch 1480/3655 | Batch Energy: 6.1903 | Perplexity: 149618723780241341440659379702573563904.0000
2025-09-17 09:40:55,037 - INFO -   Batch 1490/3655 | Batch Energy: 6.3873 | Perplexity: 44745371708210069994909010815769242501120.0000
2025-09-17 09:40:57,109 - INFO -   Batch 1500/3655 | Batch Energy: 6.3716 | Perplexity: inf
2025-09-17 09:40:59,191 - INFO -   Batch 1510/3655 | Batch Energy: 6.2580 | Perplexity: 239041887847283628642400055853056.0000
2025-09-17 09:41:01,241 - INFO -   Batch 1520/3655 | Batch Energy: 6.3086 | Perplexity: 273215477839643049505446238800653787856896.0000
2025-09-17 09:41:03,524 - INFO -   Batch 1530/3655 | Batch Energy: 6.3975 | Perplexity: 733674855735097055700080369728487424.0000
2025-09-17 09:41:05,699 - INFO -   Batch 1540/3655 | Batch Energy: 6.3069 | Perplexity: 6777843017304558433601979758567065911296.0000
2025-09-17 09:41:07,938 - INFO -   Batch 1550/3655 | Batch Energy: 6.6915 | Perplexity: 129390397856637113730679986209328988160.0000
2025-09-17 09:41:10,282 - INFO -   Batch 1560/3655 | Batch Energy: 6.3301 | Perplexity: 327803670185336627199730799131435728896.0000
2025-09-17 09:41:12,330 - INFO -   Batch 1570/3655 | Batch Energy: 6.6995 | Perplexity: 1646506397774031670822246618267866691010560.0000
2025-09-17 09:41:14,392 - INFO -   Batch 1580/3655 | Batch Energy: 6.4715 | Perplexity: 2171089010141463901698167428510829797965824.0000
2025-09-17 09:41:16,372 - INFO -   Batch 1590/3655 | Batch Energy: 6.4117 | Perplexity: 10042836504901375162397730711535616.0000
2025-09-17 09:41:18,331 - INFO -   Batch 1600/3655 | Batch Energy: 6.4605 | Perplexity: 1770369642435661556560852879526514397282304.0000
2025-09-17 09:41:20,354 - INFO -   Batch 1610/3655 | Batch Energy: 6.6456 | Perplexity: 178892648231185863066527554529489059840.0000
2025-09-17 09:41:22,441 - INFO -   Batch 1620/3655 | Batch Energy: 6.5551 | Perplexity: inf
2025-09-17 09:41:24,442 - INFO -   Batch 1630/3655 | Batch Energy: 6.6146 | Perplexity: 287068867872019025843378545927197571416064.0000
2025-09-17 09:41:26,493 - INFO -   Batch 1640/3655 | Batch Energy: 6.6822 | Perplexity: 44694978241865111155401615752736800768.0000
2025-09-17 09:41:28,574 - INFO -   Batch 1650/3655 | Batch Energy: 6.8350 | Perplexity: inf
2025-09-17 09:41:30,678 - INFO -   Batch 1660/3655 | Batch Energy: 6.6259 | Perplexity: inf
2025-09-17 09:41:32,720 - INFO -   Batch 1670/3655 | Batch Energy: 6.7867 | Perplexity: 1725497560425826228336958771845631546753024.0000
2025-09-17 09:41:34,744 - INFO -   Batch 1680/3655 | Batch Energy: 6.8145 | Perplexity: inf
2025-09-17 09:41:36,813 - INFO -   Batch 1690/3655 | Batch Energy: 6.6756 | Perplexity: 7115305996140739823040840550128834614132736.0000
2025-09-17 09:41:38,775 - INFO -   Batch 1700/3655 | Batch Energy: 6.7011 | Perplexity: 1114098956327008530763063115029244169682944.0000
2025-09-17 09:41:40,885 - INFO -   Batch 1710/3655 | Batch Energy: 6.7003 | Perplexity: 17134268810188391068430670389264378757120.0000
2025-09-17 09:41:42,850 - INFO -   Batch 1720/3655 | Batch Energy: 6.9838 | Perplexity: 2223631567080009673494469431369096232960.0000
2025-09-17 09:41:44,856 - INFO -   Batch 1730/3655 | Batch Energy: 6.8071 | Perplexity: 5842732166167078170405947170591407603712.0000
2025-09-17 09:41:46,798 - INFO -   Batch 1740/3655 | Batch Energy: 6.9434 | Perplexity: 26050149479498959556489282203941995561353216.0000
2025-09-17 09:41:48,727 - INFO -   Batch 1750/3655 | Batch Energy: 6.8427 | Perplexity: 833246566485830501720894424205672579072.0000
2025-09-17 09:41:50,669 - INFO -   Batch 1760/3655 | Batch Energy: 7.0980 | Perplexity: inf
2025-09-17 09:41:52,637 - INFO -   Batch 1770/3655 | Batch Energy: 6.9040 | Perplexity: 105305826623112007311177984077600621854720.0000
2025-09-17 09:41:54,648 - INFO -   Batch 1780/3655 | Batch Energy: 7.1152 | Perplexity: 502532822603289273019296587340744491008.0000
2025-09-17 09:41:56,900 - INFO -   Batch 1790/3655 | Batch Energy: 7.1266 | Perplexity: 2579634868114508318371248832650059710464.0000
2025-09-17 09:41:58,887 - INFO -   Batch 1800/3655 | Batch Energy: 6.9715 | Perplexity: inf
2025-09-17 09:42:00,878 - INFO -   Batch 1810/3655 | Batch Energy: 7.0357 | Perplexity: 5337418634352545553653138868894527937052672.0000
2025-09-17 09:42:09,592 - INFO - 
########################################################################################################################
2025-09-17 09:42:09,592 - INFO - Using device: cpu (local rank 0)
2025-09-17 09:42:09,592 - INFO - Saving the hyperparameters configurations:
2025-09-17 09:42:09,592 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 1e-05,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1,
      "T": 2,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 09:42:09,903 - INFO - ========== Training started ==========
2025-09-17 09:42:09,903 - INFO - 6.60 M parameters
2025-09-17 09:42:09,903 - INFO - Epoch 1/2
2025-09-17 09:43:15,917 - INFO - 
########################################################################################################################
2025-09-17 09:43:15,918 - INFO - Using device: cpu (local rank 0)
2025-09-17 09:43:15,919 - INFO - Saving the hyperparameters configurations:
2025-09-17 09:43:15,919 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 1e-05,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1,
      "T": 2,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 09:43:16,215 - INFO - ========== Training started ==========
2025-09-17 09:43:16,216 - INFO - 6.60 M parameters
2025-09-17 09:43:16,216 - INFO - Epoch 1/2
2025-09-17 09:43:18,977 - INFO -   Batch 10/1827 | Batch Energy: 3.0766 | Batch Loss: 12.5901  | Perplexity: 293631.3245
2025-09-17 09:43:22,128 - INFO -   Batch 20/1827 | Batch Energy: 3.0627 | Batch Loss: 16.1136  | Perplexity: 9955521.9415
2025-09-17 09:43:25,084 - INFO -   Batch 30/1827 | Batch Energy: 3.0861 | Batch Loss: 17.5894  | Perplexity: 43547759.7989
2025-09-17 09:43:28,368 - INFO -   Batch 40/1827 | Batch Energy: 3.1558 | Batch Loss: 19.6041  | Perplexity: 326565544.4891
2025-09-17 09:43:31,631 - INFO -   Batch 50/1827 | Batch Energy: 3.2044 | Batch Loss: 20.7125  | Perplexity: 989287756.0435
2025-09-17 09:43:34,510 - INFO -   Batch 60/1827 | Batch Energy: 3.2819 | Batch Loss: 22.2983  | Perplexity: 4830924065.0416
2025-09-17 09:45:45,826 - INFO - 
########################################################################################################################
2025-09-17 09:45:45,827 - INFO - Using device: cpu (local rank 0)
2025-09-17 09:45:45,827 - INFO - Saving the hyperparameters configurations:
2025-09-17 09:45:45,827 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 4,
      "n_blocks": 4,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 09:45:46,147 - INFO - ========== Training started ==========
2025-09-17 09:45:46,147 - INFO - 6.70 M parameters
2025-09-17 09:45:46,147 - INFO - Epoch 1/2
2025-09-17 09:45:50,518 - INFO -   Batch 10/1827 | Batch Energy: 2.4434 | Batch Loss: 15.3067  | Perplexity: 4442290.4980
2025-09-17 09:45:54,763 - INFO -   Batch 20/1827 | Batch Energy: 2.4969 | Batch Loss: 15.8800  | Perplexity: 7881529.4794
2025-09-17 09:45:58,768 - INFO -   Batch 30/1827 | Batch Energy: 2.5603 | Batch Loss: 16.8203  | Perplexity: 20181333.0963
2025-09-17 09:46:03,029 - INFO -   Batch 40/1827 | Batch Energy: 2.6387 | Batch Loss: 18.8988  | Perplexity: 161297306.1227
2025-09-17 09:46:07,120 - INFO -   Batch 50/1827 | Batch Energy: 2.7703 | Batch Loss: 20.4320  | Perplexity: 747329222.8263
2025-09-17 09:46:11,274 - INFO -   Batch 60/1827 | Batch Energy: 2.7599 | Batch Loss: 23.8552  | Perplexity: 22919090659.5639
2025-09-17 09:46:15,479 - INFO -   Batch 70/1827 | Batch Energy: 2.8477 | Batch Loss: 20.7798  | Perplexity: 1058128893.1248
2025-09-17 09:46:20,128 - INFO -   Batch 80/1827 | Batch Energy: 2.9171 | Batch Loss: 28.0186  | Perplexity: 1473452016213.3079
2025-09-17 09:46:24,894 - INFO -   Batch 90/1827 | Batch Energy: 3.1965 | Batch Loss: 29.4026  | Perplexity: 5880417776740.8506
2025-09-17 09:46:29,102 - INFO -   Batch 100/1827 | Batch Energy: 3.1309 | Batch Loss: 30.6958  | Perplexity: 21428717926886.9648
2025-09-17 09:46:33,463 - INFO -   Batch 110/1827 | Batch Energy: 3.2343 | Batch Loss: 32.4026  | Perplexity: 118101887017679.2656
2025-09-17 09:46:38,370 - INFO -   Batch 120/1827 | Batch Energy: 3.1621 | Batch Loss: 38.9869  | Perplexity: 85462540600855456.0000
2025-09-17 09:46:42,496 - INFO -   Batch 130/1827 | Batch Energy: 3.2953 | Batch Loss: 43.0845  | Perplexity: 5144742475253236736.0000
2025-09-17 09:46:46,752 - INFO -   Batch 140/1827 | Batch Energy: 3.3277 | Batch Loss: 42.4622  | Perplexity: 2761177024048557056.0000
2025-09-17 09:46:51,005 - INFO -   Batch 150/1827 | Batch Energy: 3.1882 | Batch Loss: 43.6261  | Perplexity: 8842375080500792320.0000
2025-09-17 09:46:55,222 - INFO -   Batch 160/1827 | Batch Energy: 3.4365 | Batch Loss: 47.1727  | Perplexity: 306800536532792836096.0000
2025-09-17 09:46:59,696 - INFO -   Batch 170/1827 | Batch Energy: 3.5450 | Batch Loss: 54.6127  | Perplexity: 522382043534429108830208.0000
2025-09-17 09:47:04,114 - INFO -   Batch 180/1827 | Batch Energy: 3.4634 | Batch Loss: 52.0823  | Perplexity: 41598049851703193239552.0000
2025-09-17 09:47:08,682 - INFO -   Batch 190/1827 | Batch Energy: 3.6792 | Batch Loss: 52.2577  | Perplexity: 49572955771245707657216.0000
2025-09-17 09:47:13,429 - INFO -   Batch 200/1827 | Batch Energy: 3.8368 | Batch Loss: 57.7240  | Perplexity: 11727379943638112223100928.0000
2025-09-17 09:47:23,808 - INFO - 
########################################################################################################################
2025-09-17 09:47:23,808 - INFO - Using device: cpu (local rank 0)
2025-09-17 09:47:23,808 - INFO - Saving the hyperparameters configurations:
2025-09-17 09:47:23,808 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 256,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 4,
      "n_blocks": 4,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 09:47:24,336 - INFO - ========== Training started ==========
2025-09-17 09:47:24,336 - INFO - 29.01 M parameters
2025-09-17 09:47:24,336 - INFO - Epoch 1/2
2025-09-17 09:47:32,098 - INFO -   Batch 10/1827 | Batch Energy: 20.6103 | Batch Loss: 81.0281  | Perplexity: 154894651002697972951628793803440128.0000
2025-09-17 09:47:39,392 - INFO -   Batch 20/1827 | Batch Energy: 20.7543 | Batch Loss: 139.0038  | Perplexity: inf
2025-09-17 09:47:47,422 - INFO -   Batch 30/1827 | Batch Energy: 20.8867 | Batch Loss: 160.7054  | Perplexity: inf
2025-09-17 09:47:54,920 - INFO -   Batch 40/1827 | Batch Energy: 22.2241 | Batch Loss: 218.3213  | Perplexity: inf
2025-09-17 09:48:02,171 - INFO -   Batch 50/1827 | Batch Energy: 22.6194 | Batch Loss: 269.1865  | Perplexity: inf
2025-09-17 09:48:09,451 - INFO -   Batch 60/1827 | Batch Energy: 23.6937 | Batch Loss: 318.8591  | Perplexity: inf
2025-09-17 09:48:16,482 - INFO -   Batch 70/1827 | Batch Energy: 24.5643 | Batch Loss: 333.9620  | Perplexity: inf
2025-09-17 09:48:23,740 - INFO -   Batch 80/1827 | Batch Energy: 26.2806 | Batch Loss: 404.5021  | Perplexity: inf
2025-09-17 09:48:30,893 - INFO -   Batch 90/1827 | Batch Energy: 26.8737 | Batch Loss: 417.1060  | Perplexity: inf
2025-09-17 09:48:38,297 - INFO -   Batch 100/1827 | Batch Energy: 28.5732 | Batch Loss: 468.6844  | Perplexity: inf
2025-09-17 09:48:45,681 - INFO -   Batch 110/1827 | Batch Energy: 29.5280 | Batch Loss: 478.3982  | Perplexity: inf
2025-09-17 09:48:52,785 - INFO -   Batch 120/1827 | Batch Energy: 30.9127 | Batch Loss: 512.6677  | Perplexity: inf
2025-09-17 09:48:59,831 - INFO -   Batch 130/1827 | Batch Energy: 32.0497 | Batch Loss: 533.0268  | Perplexity: inf
2025-09-17 09:49:06,965 - INFO -   Batch 140/1827 | Batch Energy: 34.1988 | Batch Loss: 530.6530  | Perplexity: inf
2025-09-17 09:49:14,074 - INFO -   Batch 150/1827 | Batch Energy: 36.2737 | Batch Loss: 566.2352  | Perplexity: inf
2025-09-17 09:49:21,355 - INFO -   Batch 160/1827 | Batch Energy: 36.7347 | Batch Loss: 585.2505  | Perplexity: inf
2025-09-17 09:49:28,738 - INFO -   Batch 170/1827 | Batch Energy: 39.1715 | Batch Loss: 582.7690  | Perplexity: inf
2025-09-17 09:49:35,712 - INFO -   Batch 180/1827 | Batch Energy: 39.8276 | Batch Loss: 663.1489  | Perplexity: inf
2025-09-17 09:49:42,858 - INFO -   Batch 190/1827 | Batch Energy: 41.1881 | Batch Loss: 645.5049  | Perplexity: inf
2025-09-17 09:49:50,313 - INFO -   Batch 200/1827 | Batch Energy: 43.4121 | Batch Loss: 677.1633  | Perplexity: inf
2025-09-17 09:49:57,845 - INFO -   Batch 210/1827 | Batch Energy: 46.8383 | Batch Loss: 658.2603  | Perplexity: inf
2025-09-17 09:50:05,401 - INFO -   Batch 220/1827 | Batch Energy: 47.4833 | Batch Loss: 764.9381  | Perplexity: inf
2025-09-17 09:50:13,270 - INFO -   Batch 230/1827 | Batch Energy: 50.9304 | Batch Loss: 751.2028  | Perplexity: inf
2025-09-17 09:50:22,220 - INFO -   Batch 240/1827 | Batch Energy: 55.0988 | Batch Loss: 788.8808  | Perplexity: inf
2025-09-17 09:50:29,987 - INFO -   Batch 250/1827 | Batch Energy: 55.2392 | Batch Loss: 814.8922  | Perplexity: inf
2025-09-17 09:50:39,661 - INFO -   Batch 260/1827 | Batch Energy: 58.7878 | Batch Loss: 793.1165  | Perplexity: inf
2025-09-17 09:50:49,273 - INFO -   Batch 270/1827 | Batch Energy: 60.4888 | Batch Loss: 763.0881  | Perplexity: inf
2025-09-17 09:50:57,479 - INFO -   Batch 280/1827 | Batch Energy: 64.7908 | Batch Loss: 908.9625  | Perplexity: inf
2025-09-17 09:51:05,546 - INFO -   Batch 290/1827 | Batch Energy: 267.2254 | Batch Loss: 887.6615  | Perplexity: inf
2025-09-17 09:51:13,090 - INFO -   Batch 300/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:51:21,262 - INFO -   Batch 310/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:51:28,749 - INFO -   Batch 320/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:51:36,543 - INFO -   Batch 330/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:51:44,519 - INFO -   Batch 340/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:51:52,426 - INFO -   Batch 350/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:02,431 - INFO -   Batch 360/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:10,219 - INFO -   Batch 370/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:19,156 - INFO -   Batch 380/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:27,388 - INFO -   Batch 390/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:35,097 - INFO -   Batch 400/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:42,654 - INFO -   Batch 410/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:50,043 - INFO -   Batch 420/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:52:57,403 - INFO -   Batch 430/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:04,586 - INFO -   Batch 440/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:11,846 - INFO -   Batch 450/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:20,416 - INFO -   Batch 460/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:32,319 - INFO -   Batch 470/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:40,865 - INFO -   Batch 480/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:49,694 - INFO -   Batch 490/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:53:58,215 - INFO -   Batch 500/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:54:07,626 - INFO -   Batch 510/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:54:18,604 - INFO -   Batch 520/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:54:27,683 - INFO -   Batch 530/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:54:37,236 - INFO -   Batch 540/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:54:45,064 - INFO -   Batch 550/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:54:52,497 - INFO -   Batch 560/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:01,448 - INFO -   Batch 570/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:11,157 - INFO -   Batch 580/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:19,363 - INFO -   Batch 590/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:27,969 - INFO -   Batch 600/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:35,916 - INFO -   Batch 610/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:43,658 - INFO -   Batch 620/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:51,953 - INFO -   Batch 630/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:55:59,911 - INFO -   Batch 640/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:08,173 - INFO -   Batch 650/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:16,341 - INFO -   Batch 660/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:24,062 - INFO -   Batch 670/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:31,902 - INFO -   Batch 680/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:39,611 - INFO -   Batch 690/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:47,767 - INFO -   Batch 700/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:56:56,715 - INFO -   Batch 710/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:05,648 - INFO -   Batch 720/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:14,075 - INFO -   Batch 730/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:21,868 - INFO -   Batch 740/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:29,968 - INFO -   Batch 750/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:37,712 - INFO -   Batch 760/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:45,418 - INFO -   Batch 770/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:57:52,805 - INFO -   Batch 780/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:00,480 - INFO -   Batch 790/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:08,167 - INFO -   Batch 800/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:16,251 - INFO -   Batch 810/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:24,789 - INFO -   Batch 820/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:33,443 - INFO -   Batch 830/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:41,660 - INFO -   Batch 840/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:49,798 - INFO -   Batch 850/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:58:58,114 - INFO -   Batch 860/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:59:10,442 - INFO -   Batch 870/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:59:20,318 - INFO -   Batch 880/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:59:30,490 - INFO -   Batch 890/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:59:41,794 - INFO -   Batch 900/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:59:50,509 - INFO -   Batch 910/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 09:59:59,091 - INFO -   Batch 920/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:00:09,782 - INFO -   Batch 930/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:00:19,044 - INFO -   Batch 940/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:00:28,052 - INFO -   Batch 950/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:00:36,981 - INFO -   Batch 960/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:00:46,254 - INFO -   Batch 970/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:00:54,502 - INFO -   Batch 980/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:03,477 - INFO -   Batch 990/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:13,615 - INFO -   Batch 1000/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:22,485 - INFO -   Batch 1010/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:30,701 - INFO -   Batch 1020/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:39,793 - INFO -   Batch 1030/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:50,174 - INFO -   Batch 1040/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:01:58,829 - INFO -   Batch 1050/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:07,156 - INFO -   Batch 1060/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:15,913 - INFO -   Batch 1070/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:24,260 - INFO -   Batch 1080/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:32,325 - INFO -   Batch 1090/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:40,586 - INFO -   Batch 1100/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:48,818 - INFO -   Batch 1110/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:02:57,069 - INFO -   Batch 1120/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:03:06,244 - INFO -   Batch 1130/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:03:16,378 - INFO -   Batch 1140/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:03:25,968 - INFO -   Batch 1150/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:03:33,938 - INFO -   Batch 1160/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:03:43,030 - INFO -   Batch 1170/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:03:50,803 - INFO -   Batch 1180/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:00,075 - INFO -   Batch 1190/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:08,593 - INFO -   Batch 1200/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:17,194 - INFO -   Batch 1210/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:26,058 - INFO -   Batch 1220/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:33,922 - INFO -   Batch 1230/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:41,773 - INFO -   Batch 1240/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:50,053 - INFO -   Batch 1250/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:04:57,998 - INFO -   Batch 1260/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:06,302 - INFO -   Batch 1270/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:14,354 - INFO -   Batch 1280/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:22,873 - INFO -   Batch 1290/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:30,535 - INFO -   Batch 1300/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:38,803 - INFO -   Batch 1310/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:47,368 - INFO -   Batch 1320/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:05:55,881 - INFO -   Batch 1330/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:03,810 - INFO -   Batch 1340/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:11,589 - INFO -   Batch 1350/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:19,831 - INFO -   Batch 1360/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:27,494 - INFO -   Batch 1370/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:34,882 - INFO -   Batch 1380/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:42,835 - INFO -   Batch 1390/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:50,590 - INFO -   Batch 1400/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:06:58,612 - INFO -   Batch 1410/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:07,043 - INFO -   Batch 1420/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:14,869 - INFO -   Batch 1430/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:22,531 - INFO -   Batch 1440/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:30,069 - INFO -   Batch 1450/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:37,631 - INFO -   Batch 1460/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:45,171 - INFO -   Batch 1470/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:52,513 - INFO -   Batch 1480/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:07:59,941 - INFO -   Batch 1490/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:07,200 - INFO -   Batch 1500/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:14,222 - INFO -   Batch 1510/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:21,907 - INFO -   Batch 1520/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:29,368 - INFO -   Batch 1530/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:36,732 - INFO -   Batch 1540/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:44,309 - INFO -   Batch 1550/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:51,620 - INFO -   Batch 1560/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:08:58,954 - INFO -   Batch 1570/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:06,825 - INFO -   Batch 1580/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:14,902 - INFO -   Batch 1590/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:22,849 - INFO -   Batch 1600/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:30,764 - INFO -   Batch 1610/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:38,640 - INFO -   Batch 1620/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:46,692 - INFO -   Batch 1630/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:09:54,818 - INFO -   Batch 1640/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:10:02,641 - INFO -   Batch 1650/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:10:10,041 - INFO -   Batch 1660/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:10:17,636 - INFO -   Batch 1670/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:10:26,203 - INFO -   Batch 1680/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:10:35,089 - INFO -   Batch 1690/1827 | Batch Energy: nan | Batch Loss: nan  | Perplexity: inf
2025-09-17 10:10:54,263 - INFO - 
########################################################################################################################
2025-09-17 10:10:54,263 - INFO - Using device: cpu (local rank 0)
2025-09-17 10:10:54,264 - INFO - Saving the hyperparameters configurations:
2025-09-17 10:10:54,264 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 4,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 10:10:54,559 - INFO - ========== Training started ==========
2025-09-17 10:10:54,559 - INFO - 1.27 M parameters
2025-09-17 10:10:54,559 - INFO - Epoch 1/2
2025-09-17 10:10:58,447 - INFO -   Batch 10/1827 | Batch Energy: 1.7960 | Batch Loss: 9.8599  | Perplexity: 19146.4177
2025-09-17 10:11:02,553 - INFO -   Batch 20/1827 | Batch Energy: 1.7662 | Batch Loss: 9.3427  | Perplexity: 11414.8176
2025-09-17 10:11:06,468 - INFO -   Batch 30/1827 | Batch Energy: 1.7754 | Batch Loss: 9.2098  | Perplexity: 9994.4048
2025-09-17 10:11:10,151 - INFO -   Batch 40/1827 | Batch Energy: 1.7711 | Batch Loss: 8.7788  | Perplexity: 6494.8988
2025-09-17 10:11:14,986 - INFO -   Batch 50/1827 | Batch Energy: 1.7963 | Batch Loss: 8.7360  | Perplexity: 6222.7230
2025-09-17 10:11:19,262 - INFO -   Batch 60/1827 | Batch Energy: 1.7832 | Batch Loss: 8.9261  | Perplexity: 7525.8340
2025-09-17 10:11:22,788 - INFO -   Batch 70/1827 | Batch Energy: 1.7606 | Batch Loss: 8.4354  | Perplexity: 4607.5059
2025-09-17 10:11:26,287 - INFO -   Batch 80/1827 | Batch Energy: 1.7543 | Batch Loss: 7.9059  | Perplexity: 2713.1748
2025-09-17 10:11:30,095 - INFO -   Batch 90/1827 | Batch Energy: 1.7593 | Batch Loss: 8.6321  | Perplexity: 5608.9092
2025-09-17 10:11:34,292 - INFO -   Batch 100/1827 | Batch Energy: 1.7871 | Batch Loss: 8.0060  | Perplexity: 2998.7675
2025-09-17 10:11:38,075 - INFO -   Batch 110/1827 | Batch Energy: 1.7824 | Batch Loss: 7.9656  | Perplexity: 2880.0936
2025-09-17 10:11:41,832 - INFO -   Batch 120/1827 | Batch Energy: 1.8277 | Batch Loss: 8.3240  | Perplexity: 4121.6150
2025-09-17 10:11:45,693 - INFO -   Batch 130/1827 | Batch Energy: 1.8181 | Batch Loss: 8.0261  | Perplexity: 3059.8236
2025-09-17 10:11:49,742 - INFO -   Batch 140/1827 | Batch Energy: 1.8044 | Batch Loss: 8.5380  | Perplexity: 5105.0222
2025-09-17 10:11:53,267 - INFO -   Batch 150/1827 | Batch Energy: 1.8106 | Batch Loss: 7.7905  | Perplexity: 2417.4653
2025-09-17 10:11:56,860 - INFO -   Batch 160/1827 | Batch Energy: 1.7960 | Batch Loss: 8.2462  | Perplexity: 3812.9360
2025-09-17 10:12:00,393 - INFO -   Batch 170/1827 | Batch Energy: 1.7926 | Batch Loss: 8.6590  | Perplexity: 5761.9207
2025-09-17 10:12:04,238 - INFO -   Batch 180/1827 | Batch Energy: 1.7929 | Batch Loss: 7.3395  | Perplexity: 1539.8949
2025-09-17 10:12:07,941 - INFO -   Batch 190/1827 | Batch Energy: 1.7879 | Batch Loss: 8.3615  | Perplexity: 4279.0261
2025-09-17 10:12:11,652 - INFO -   Batch 200/1827 | Batch Energy: 1.8132 | Batch Loss: 8.1117  | Perplexity: 3333.2145
2025-09-17 10:12:15,129 - INFO -   Batch 210/1827 | Batch Energy: 1.8140 | Batch Loss: 8.0204  | Perplexity: 3042.3101
2025-09-17 10:12:18,811 - INFO -   Batch 220/1827 | Batch Energy: 1.7812 | Batch Loss: 8.1529  | Perplexity: 3473.5227
2025-09-17 10:12:22,574 - INFO -   Batch 230/1827 | Batch Energy: 1.7731 | Batch Loss: 8.1396  | Perplexity: 3427.6407
2025-09-17 10:12:26,214 - INFO -   Batch 240/1827 | Batch Energy: 1.8018 | Batch Loss: 7.7079  | Perplexity: 2225.9512
2025-09-17 10:12:31,361 - INFO -   Batch 250/1827 | Batch Energy: 1.8381 | Batch Loss: 8.0630  | Perplexity: 3174.7873
2025-09-17 10:12:36,465 - INFO -   Batch 260/1827 | Batch Energy: 1.8045 | Batch Loss: 7.7816  | Perplexity: 2396.0667
2025-09-17 10:12:41,416 - INFO -   Batch 270/1827 | Batch Energy: 1.8466 | Batch Loss: 7.8139  | Perplexity: 2474.7632
2025-09-17 10:12:45,401 - INFO -   Batch 280/1827 | Batch Energy: 1.8127 | Batch Loss: 8.4295  | Perplexity: 4580.0155
2025-09-17 10:12:49,324 - INFO -   Batch 290/1827 | Batch Energy: 1.8401 | Batch Loss: 7.9547  | Perplexity: 2848.8126
2025-09-17 10:12:52,916 - INFO -   Batch 300/1827 | Batch Energy: 1.8458 | Batch Loss: 7.5277  | Perplexity: 1858.8163
2025-09-17 10:12:56,712 - INFO -   Batch 310/1827 | Batch Energy: 1.8124 | Batch Loss: 8.1914  | Perplexity: 3609.9430
2025-09-17 10:13:00,485 - INFO -   Batch 320/1827 | Batch Energy: 1.8981 | Batch Loss: 8.0461  | Perplexity: 3121.6823
2025-09-17 10:13:04,464 - INFO -   Batch 330/1827 | Batch Energy: 1.8288 | Batch Loss: 8.1045  | Perplexity: 3309.2692
2025-09-17 10:13:08,095 - INFO -   Batch 340/1827 | Batch Energy: 1.8349 | Batch Loss: 7.9319  | Perplexity: 2784.7354
2025-09-17 10:13:11,959 - INFO -   Batch 350/1827 | Batch Energy: 1.8098 | Batch Loss: 7.7233  | Perplexity: 2260.4616
2025-09-17 10:13:15,829 - INFO -   Batch 360/1827 | Batch Energy: 1.7991 | Batch Loss: 8.1466  | Perplexity: 3451.6063
2025-09-17 10:13:19,551 - INFO -   Batch 370/1827 | Batch Energy: 1.8171 | Batch Loss: 8.0898  | Perplexity: 3260.9167
2025-09-17 10:13:23,269 - INFO -   Batch 380/1827 | Batch Energy: 1.8637 | Batch Loss: 7.6244  | Perplexity: 2047.6075
2025-09-17 10:13:27,148 - INFO -   Batch 390/1827 | Batch Energy: 1.8417 | Batch Loss: 8.0282  | Perplexity: 3066.2414
2025-09-17 10:13:31,031 - INFO -   Batch 400/1827 | Batch Energy: 1.8618 | Batch Loss: 8.0494  | Perplexity: 3131.8984
2025-09-17 10:13:34,888 - INFO -   Batch 410/1827 | Batch Energy: 1.8624 | Batch Loss: 8.0336  | Perplexity: 3082.7489
2025-09-17 10:13:38,514 - INFO -   Batch 420/1827 | Batch Energy: 1.8529 | Batch Loss: 7.9235  | Perplexity: 2761.3943
2025-09-17 10:13:42,221 - INFO -   Batch 430/1827 | Batch Energy: 1.8677 | Batch Loss: 7.4401  | Perplexity: 1702.8445
2025-09-17 10:13:46,037 - INFO -   Batch 440/1827 | Batch Energy: 1.8182 | Batch Loss: 7.7492  | Perplexity: 2319.6548
2025-09-17 10:13:49,584 - INFO -   Batch 450/1827 | Batch Energy: 1.8274 | Batch Loss: 8.0970  | Perplexity: 3284.5654
2025-09-17 10:13:53,258 - INFO -   Batch 460/1827 | Batch Energy: 1.8388 | Batch Loss: 7.5514  | Perplexity: 1903.4205
2025-09-17 10:13:56,993 - INFO -   Batch 470/1827 | Batch Energy: 1.8295 | Batch Loss: 7.9172  | Perplexity: 2744.0797
2025-09-17 10:14:00,675 - INFO -   Batch 480/1827 | Batch Energy: 1.8630 | Batch Loss: 7.6877  | Perplexity: 2181.3273
2025-09-17 10:14:04,743 - INFO -   Batch 490/1827 | Batch Energy: 1.8580 | Batch Loss: 8.0207  | Perplexity: 3043.2038
2025-09-17 10:14:08,343 - INFO -   Batch 500/1827 | Batch Energy: 1.8536 | Batch Loss: 7.7232  | Perplexity: 2260.1555
2025-09-17 10:14:12,081 - INFO -   Batch 510/1827 | Batch Energy: 1.8108 | Batch Loss: 7.7436  | Perplexity: 2306.8088
2025-09-17 10:14:15,893 - INFO -   Batch 520/1827 | Batch Energy: 1.8784 | Batch Loss: 8.0022  | Perplexity: 2987.4667
2025-09-17 10:14:19,682 - INFO -   Batch 530/1827 | Batch Energy: 1.8057 | Batch Loss: 7.4231  | Perplexity: 1674.1620
2025-09-17 10:14:23,489 - INFO -   Batch 540/1827 | Batch Energy: 1.8684 | Batch Loss: 7.9514  | Perplexity: 2839.5172
2025-09-17 10:14:27,132 - INFO -   Batch 550/1827 | Batch Energy: 1.8776 | Batch Loss: 7.8881  | Perplexity: 2665.4757
2025-09-17 10:14:31,133 - INFO -   Batch 560/1827 | Batch Energy: 1.8720 | Batch Loss: 7.8434  | Perplexity: 2548.8283
2025-09-17 10:14:34,730 - INFO -   Batch 570/1827 | Batch Energy: 1.8587 | Batch Loss: 7.6149  | Perplexity: 2028.2657
2025-09-17 10:14:38,504 - INFO -   Batch 580/1827 | Batch Energy: 1.9017 | Batch Loss: 7.5698  | Perplexity: 1938.8022
2025-09-17 10:14:42,123 - INFO -   Batch 590/1827 | Batch Energy: 1.8746 | Batch Loss: 7.8783  | Perplexity: 2639.3798
2025-09-17 10:14:45,801 - INFO -   Batch 600/1827 | Batch Energy: 1.8694 | Batch Loss: 7.8384  | Perplexity: 2536.0286
2025-09-17 10:14:49,532 - INFO -   Batch 610/1827 | Batch Energy: 1.9061 | Batch Loss: 7.6901  | Perplexity: 2186.6854
2025-09-17 10:14:53,064 - INFO -   Batch 620/1827 | Batch Energy: 1.8424 | Batch Loss: 7.5942  | Perplexity: 1986.6459
2025-09-17 10:14:56,554 - INFO -   Batch 630/1827 | Batch Energy: 1.9140 | Batch Loss: 7.6696  | Perplexity: 2142.2796
2025-09-17 10:15:00,077 - INFO -   Batch 640/1827 | Batch Energy: 1.8698 | Batch Loss: 7.5517  | Perplexity: 1903.9661
2025-09-17 10:15:03,830 - INFO -   Batch 650/1827 | Batch Energy: 1.8929 | Batch Loss: 8.4485  | Perplexity: 4667.8680
2025-09-17 10:15:07,573 - INFO -   Batch 660/1827 | Batch Energy: 1.8832 | Batch Loss: 8.0261  | Perplexity: 3059.6806
2025-09-17 10:15:11,217 - INFO -   Batch 670/1827 | Batch Energy: 1.8807 | Batch Loss: 7.8838  | Perplexity: 2653.8676
2025-09-17 10:15:15,208 - INFO -   Batch 680/1827 | Batch Energy: 1.8811 | Batch Loss: 8.1194  | Perplexity: 3359.1426
2025-09-17 10:15:18,854 - INFO -   Batch 690/1827 | Batch Energy: 1.8835 | Batch Loss: 8.0300  | Perplexity: 3071.6940
2025-09-17 10:15:22,688 - INFO -   Batch 700/1827 | Batch Energy: 1.9151 | Batch Loss: 7.1789  | Perplexity: 1311.4627
2025-09-17 10:15:26,614 - INFO -   Batch 710/1827 | Batch Energy: 1.9210 | Batch Loss: 7.8088  | Perplexity: 2462.1593
2025-09-17 10:15:30,372 - INFO -   Batch 720/1827 | Batch Energy: 1.9300 | Batch Loss: 7.9040  | Perplexity: 2708.1661
2025-09-17 10:15:35,667 - INFO -   Batch 730/1827 | Batch Energy: 1.9041 | Batch Loss: 7.5768  | Perplexity: 1952.4456
2025-09-17 10:15:39,409 - INFO -   Batch 740/1827 | Batch Energy: 1.9265 | Batch Loss: 7.7321  | Perplexity: 2280.4915
2025-09-17 10:15:43,227 - INFO -   Batch 750/1827 | Batch Energy: 1.9754 | Batch Loss: 7.8021  | Perplexity: 2445.6993
2025-09-17 10:15:46,795 - INFO -   Batch 760/1827 | Batch Energy: 1.9226 | Batch Loss: 7.8584  | Perplexity: 2587.3017
2025-09-17 10:15:50,359 - INFO -   Batch 770/1827 | Batch Energy: 1.9262 | Batch Loss: 8.1137  | Perplexity: 3339.8648
2025-09-17 10:15:53,947 - INFO -   Batch 780/1827 | Batch Energy: 1.9364 | Batch Loss: 7.2184  | Perplexity: 1364.3005
2025-09-17 10:15:57,642 - INFO -   Batch 790/1827 | Batch Energy: 1.9414 | Batch Loss: 7.9822  | Perplexity: 2928.2593
2025-09-17 10:16:01,326 - INFO -   Batch 800/1827 | Batch Energy: 1.9563 | Batch Loss: 7.9992  | Perplexity: 2978.6874
2025-09-17 10:16:04,908 - INFO -   Batch 810/1827 | Batch Energy: 1.9767 | Batch Loss: 7.7740  | Perplexity: 2377.8784
2025-09-17 10:16:08,789 - INFO -   Batch 820/1827 | Batch Energy: 2.0039 | Batch Loss: 8.3745  | Perplexity: 4334.9691
2025-09-17 10:16:12,555 - INFO -   Batch 830/1827 | Batch Energy: 1.9824 | Batch Loss: 8.2098  | Perplexity: 3676.6379
2025-09-17 10:16:16,218 - INFO -   Batch 840/1827 | Batch Energy: 1.9467 | Batch Loss: 7.2801  | Perplexity: 1451.1495
2025-09-17 10:16:19,959 - INFO -   Batch 850/1827 | Batch Energy: 1.9505 | Batch Loss: 8.2319  | Perplexity: 3759.0702
2025-09-17 10:16:23,650 - INFO -   Batch 860/1827 | Batch Energy: 2.0183 | Batch Loss: 7.6067  | Perplexity: 2011.5462
2025-09-17 10:16:27,248 - INFO -   Batch 870/1827 | Batch Energy: 2.0459 | Batch Loss: 7.9872  | Perplexity: 2942.9320
2025-09-17 10:16:30,908 - INFO -   Batch 880/1827 | Batch Energy: 2.0504 | Batch Loss: 7.6551  | Perplexity: 2111.3155
2025-09-17 10:16:34,609 - INFO -   Batch 890/1827 | Batch Energy: 2.0357 | Batch Loss: 7.6546  | Perplexity: 2110.2557
2025-09-17 10:16:38,087 - INFO -   Batch 900/1827 | Batch Energy: 2.0399 | Batch Loss: 7.6781  | Perplexity: 2160.5307
2025-09-17 10:16:41,622 - INFO -   Batch 910/1827 | Batch Energy: 2.0954 | Batch Loss: 7.8813  | Perplexity: 2647.2714
2025-09-17 10:16:45,282 - INFO -   Batch 920/1827 | Batch Energy: 2.0940 | Batch Loss: 7.8611  | Perplexity: 2594.4251
2025-09-17 10:16:48,836 - INFO -   Batch 930/1827 | Batch Energy: 2.1195 | Batch Loss: 8.2362  | Perplexity: 3775.0714
2025-09-17 10:16:52,553 - INFO -   Batch 940/1827 | Batch Energy: 2.1664 | Batch Loss: 8.1515  | Perplexity: 3468.4746
2025-09-17 10:16:56,078 - INFO -   Batch 950/1827 | Batch Energy: 2.1082 | Batch Loss: 7.0123  | Perplexity: 1110.2008
2025-09-17 10:16:59,810 - INFO -   Batch 960/1827 | Batch Energy: 2.1479 | Batch Loss: 7.5539  | Perplexity: 1908.2561
2025-09-17 10:17:03,676 - INFO -   Batch 970/1827 | Batch Energy: 2.2811 | Batch Loss: 7.9383  | Perplexity: 2802.6258
2025-09-17 10:17:07,288 - INFO -   Batch 980/1827 | Batch Energy: 2.1990 | Batch Loss: 7.6903  | Perplexity: 2187.0764
2025-09-17 10:17:11,151 - INFO -   Batch 990/1827 | Batch Energy: 2.2099 | Batch Loss: 8.5371  | Perplexity: 5100.6959
2025-09-17 10:17:14,799 - INFO -   Batch 1000/1827 | Batch Energy: 2.2824 | Batch Loss: 7.7140  | Perplexity: 2239.4636
2025-09-17 10:17:19,581 - INFO -   Batch 1010/1827 | Batch Energy: 2.2708 | Batch Loss: 7.9560  | Perplexity: 2852.6541
2025-09-17 10:17:23,416 - INFO -   Batch 1020/1827 | Batch Energy: 2.2941 | Batch Loss: 8.2768  | Perplexity: 3931.7700
2025-09-17 10:17:27,196 - INFO -   Batch 1030/1827 | Batch Energy: 2.3586 | Batch Loss: 7.6239  | Perplexity: 2046.6128
2025-09-17 10:17:30,948 - INFO -   Batch 1040/1827 | Batch Energy: 2.3416 | Batch Loss: 8.2194  | Perplexity: 3712.2829
2025-09-17 10:17:34,616 - INFO -   Batch 1050/1827 | Batch Energy: 2.4772 | Batch Loss: 8.5009  | Perplexity: 4919.0735
2025-09-17 10:17:38,244 - INFO -   Batch 1060/1827 | Batch Energy: 2.4357 | Batch Loss: 8.4788  | Perplexity: 4811.5844
2025-09-17 10:17:41,939 - INFO -   Batch 1070/1827 | Batch Energy: 2.4984 | Batch Loss: 8.5939  | Perplexity: 5398.8163
2025-09-17 10:17:45,674 - INFO -   Batch 1080/1827 | Batch Energy: 2.5058 | Batch Loss: 7.7244  | Perplexity: 2262.8190
2025-09-17 10:17:49,466 - INFO -   Batch 1090/1827 | Batch Energy: 2.5334 | Batch Loss: 7.9560  | Perplexity: 2852.6486
2025-09-17 10:17:53,405 - INFO -   Batch 1100/1827 | Batch Energy: 2.5676 | Batch Loss: 8.3502  | Perplexity: 4231.0216
2025-09-17 10:17:57,526 - INFO -   Batch 1110/1827 | Batch Energy: 2.5526 | Batch Loss: 8.1372  | Perplexity: 3419.3055
2025-09-17 10:18:01,245 - INFO -   Batch 1120/1827 | Batch Energy: 2.5857 | Batch Loss: 8.4911  | Perplexity: 4871.1951
2025-09-17 10:18:05,036 - INFO -   Batch 1130/1827 | Batch Energy: 2.5618 | Batch Loss: 7.9878  | Perplexity: 2944.8818
2025-09-17 10:18:09,454 - INFO -   Batch 1140/1827 | Batch Energy: 2.5227 | Batch Loss: 8.0262  | Perplexity: 3060.2147
2025-09-17 10:18:14,537 - INFO -   Batch 1150/1827 | Batch Energy: 2.5782 | Batch Loss: 7.9182  | Perplexity: 2746.7752
2025-09-17 10:18:19,247 - INFO -   Batch 1160/1827 | Batch Energy: 2.6709 | Batch Loss: 7.9866  | Perplexity: 2941.1658
2025-09-17 10:18:24,406 - INFO -   Batch 1170/1827 | Batch Energy: 2.5921 | Batch Loss: 8.2158  | Perplexity: 3698.9529
2025-09-17 10:18:28,576 - INFO -   Batch 1180/1827 | Batch Energy: 2.7784 | Batch Loss: 8.2039  | Perplexity: 3655.1093
2025-09-17 10:18:32,297 - INFO -   Batch 1190/1827 | Batch Energy: 2.6571 | Batch Loss: 7.8960  | Perplexity: 2686.5504
2025-09-17 10:18:35,973 - INFO -   Batch 1200/1827 | Batch Energy: 2.8303 | Batch Loss: 8.3557  | Perplexity: 4254.4489
2025-09-17 10:18:39,826 - INFO -   Batch 1210/1827 | Batch Energy: 2.8946 | Batch Loss: 8.4979  | Perplexity: 4904.5055
2025-09-17 10:18:43,527 - INFO -   Batch 1220/1827 | Batch Energy: 2.9686 | Batch Loss: 8.3354  | Perplexity: 4168.8911
2025-09-17 10:18:47,590 - INFO -   Batch 1230/1827 | Batch Energy: 3.0484 | Batch Loss: 8.6692  | Perplexity: 5820.8127
2025-09-17 10:18:51,261 - INFO -   Batch 1240/1827 | Batch Energy: 3.0241 | Batch Loss: 7.7757  | Perplexity: 2381.9842
2025-09-17 10:18:54,976 - INFO -   Batch 1250/1827 | Batch Energy: 2.8418 | Batch Loss: 7.9523  | Perplexity: 2842.0381
2025-09-17 10:18:58,460 - INFO -   Batch 1260/1827 | Batch Energy: 2.9847 | Batch Loss: 7.9932  | Perplexity: 2960.7952
2025-09-17 10:19:02,068 - INFO -   Batch 1270/1827 | Batch Energy: 2.9969 | Batch Loss: 7.6299  | Perplexity: 2058.8784
2025-09-17 10:19:05,835 - INFO -   Batch 1280/1827 | Batch Energy: 3.2113 | Batch Loss: 7.4677  | Perplexity: 1750.5240
2025-09-17 10:19:09,703 - INFO -   Batch 1290/1827 | Batch Energy: 3.1887 | Batch Loss: 8.8324  | Perplexity: 6852.4348
2025-09-17 10:19:13,423 - INFO -   Batch 1300/1827 | Batch Energy: 3.2041 | Batch Loss: 8.0135  | Perplexity: 3021.5032
2025-09-17 10:19:17,104 - INFO -   Batch 1310/1827 | Batch Energy: 3.2659 | Batch Loss: 8.5930  | Perplexity: 5393.8090
2025-09-17 10:19:20,874 - INFO -   Batch 1320/1827 | Batch Energy: 3.2249 | Batch Loss: 7.7267  | Perplexity: 2268.0095
2025-09-17 10:19:24,619 - INFO -   Batch 1330/1827 | Batch Energy: 3.4329 | Batch Loss: 9.2609  | Perplexity: 10518.0794
2025-09-17 10:19:28,644 - INFO -   Batch 1340/1827 | Batch Energy: 3.5798 | Batch Loss: 8.4185  | Perplexity: 4530.1418
2025-09-17 10:19:32,341 - INFO -   Batch 1350/1827 | Batch Energy: 3.4580 | Batch Loss: 8.1423  | Perplexity: 3436.6910
2025-09-17 10:19:36,262 - INFO -   Batch 1360/1827 | Batch Energy: 3.3737 | Batch Loss: 8.6340  | Perplexity: 5619.7301
2025-09-17 10:19:40,234 - INFO -   Batch 1370/1827 | Batch Energy: 3.6879 | Batch Loss: 8.8722  | Perplexity: 7131.2239
2025-09-17 10:19:43,826 - INFO -   Batch 1380/1827 | Batch Energy: 3.7930 | Batch Loss: 8.1724  | Perplexity: 3541.9642
2025-09-17 10:19:47,685 - INFO -   Batch 1390/1827 | Batch Energy: 3.7421 | Batch Loss: 7.8370  | Perplexity: 2532.7137
2025-09-17 10:19:51,928 - INFO -   Batch 1400/1827 | Batch Energy: 3.5391 | Batch Loss: 7.7839  | Perplexity: 2401.5296
2025-09-17 10:19:55,946 - INFO -   Batch 1410/1827 | Batch Energy: 3.6901 | Batch Loss: 8.2055  | Perplexity: 3661.1830
2025-09-17 10:20:00,149 - INFO -   Batch 1420/1827 | Batch Energy: 3.5880 | Batch Loss: 8.2768  | Perplexity: 3931.6575
2025-09-17 10:20:03,929 - INFO -   Batch 1430/1827 | Batch Energy: 3.8363 | Batch Loss: 8.6839  | Perplexity: 5907.0441
2025-09-17 10:20:07,712 - INFO -   Batch 1440/1827 | Batch Energy: 3.8077 | Batch Loss: 9.4219  | Perplexity: 12355.6804
2025-09-17 10:20:11,314 - INFO -   Batch 1450/1827 | Batch Energy: 4.1014 | Batch Loss: 8.3034  | Perplexity: 4037.6925
2025-09-17 10:20:14,999 - INFO -   Batch 1460/1827 | Batch Energy: 4.0107 | Batch Loss: 8.0002  | Perplexity: 2981.4527
2025-09-17 10:20:18,790 - INFO -   Batch 1470/1827 | Batch Energy: 3.8962 | Batch Loss: 7.7114  | Perplexity: 2233.6886
2025-09-17 10:20:22,482 - INFO -   Batch 1480/1827 | Batch Energy: 4.2097 | Batch Loss: 8.8467  | Perplexity: 6951.2503
2025-09-17 10:20:26,020 - INFO -   Batch 1490/1827 | Batch Energy: 4.1440 | Batch Loss: 8.2481  | Perplexity: 3820.2265
2025-09-17 10:20:29,607 - INFO -   Batch 1500/1827 | Batch Energy: 4.5433 | Batch Loss: 8.8452  | Perplexity: 6941.3004
2025-09-17 10:20:33,323 - INFO -   Batch 1510/1827 | Batch Energy: 4.3807 | Batch Loss: 8.3864  | Perplexity: 4386.9008
2025-09-17 10:20:36,906 - INFO -   Batch 1520/1827 | Batch Energy: 4.5137 | Batch Loss: 8.4555  | Perplexity: 4700.7517
2025-09-17 10:20:40,484 - INFO -   Batch 1530/1827 | Batch Energy: 4.2535 | Batch Loss: 8.6893  | Perplexity: 5939.0097
2025-09-17 10:20:44,102 - INFO -   Batch 1540/1827 | Batch Energy: 4.8537 | Batch Loss: 8.6779  | Perplexity: 5871.4753
2025-09-17 10:20:47,835 - INFO -   Batch 1550/1827 | Batch Energy: 4.4950 | Batch Loss: 8.5486  | Perplexity: 5159.3696
2025-09-17 10:20:51,523 - INFO -   Batch 1560/1827 | Batch Energy: 4.7249 | Batch Loss: 8.0113  | Perplexity: 3014.8916
2025-09-17 10:20:55,175 - INFO -   Batch 1570/1827 | Batch Energy: 4.4549 | Batch Loss: 9.2992  | Perplexity: 10929.0332
2025-09-17 10:20:58,976 - INFO -   Batch 1580/1827 | Batch Energy: 5.0482 | Batch Loss: 7.5947  | Perplexity: 1987.7166
2025-09-17 10:21:02,770 - INFO -   Batch 1590/1827 | Batch Energy: 4.8131 | Batch Loss: 9.0371  | Perplexity: 8409.2810
2025-09-17 10:21:06,529 - INFO -   Batch 1600/1827 | Batch Energy: 5.1088 | Batch Loss: 8.4697  | Perplexity: 4767.9205
2025-09-17 10:21:10,359 - INFO -   Batch 1610/1827 | Batch Energy: 4.6433 | Batch Loss: 8.3128  | Perplexity: 4075.7456
2025-09-17 10:21:13,997 - INFO -   Batch 1620/1827 | Batch Energy: 4.7638 | Batch Loss: 8.2910  | Perplexity: 3987.7720
2025-09-17 10:21:17,563 - INFO -   Batch 1630/1827 | Batch Energy: 4.9831 | Batch Loss: 8.8925  | Perplexity: 7277.3763
2025-09-17 10:21:21,192 - INFO -   Batch 1640/1827 | Batch Energy: 5.4589 | Batch Loss: 9.6442  | Perplexity: 15431.6741
2025-09-17 10:21:25,333 - INFO -   Batch 1650/1827 | Batch Energy: 5.1024 | Batch Loss: 8.7201  | Perplexity: 6124.4961
2025-09-17 10:21:29,538 - INFO -   Batch 1660/1827 | Batch Energy: 5.1650 | Batch Loss: 8.8359  | Perplexity: 6876.9062
2025-09-17 10:21:33,553 - INFO -   Batch 1670/1827 | Batch Energy: 5.1827 | Batch Loss: 7.9896  | Perplexity: 2950.1257
2025-09-17 10:21:37,396 - INFO -   Batch 1680/1827 | Batch Energy: 5.6295 | Batch Loss: 9.0063  | Perplexity: 8153.9521
2025-09-17 10:21:41,344 - INFO -   Batch 1690/1827 | Batch Energy: 5.7292 | Batch Loss: 8.6111  | Perplexity: 5492.3089
2025-09-17 10:21:45,152 - INFO -   Batch 1700/1827 | Batch Energy: 5.1479 | Batch Loss: 9.7999  | Perplexity: 18032.2350
2025-09-17 10:21:48,808 - INFO -   Batch 1710/1827 | Batch Energy: 5.5636 | Batch Loss: 8.8040  | Perplexity: 6660.5476
2025-09-17 10:21:54,818 - INFO -   Batch 1720/1827 | Batch Energy: 5.5750 | Batch Loss: 9.0947  | Perplexity: 8908.3363
2025-09-17 10:21:58,833 - INFO -   Batch 1730/1827 | Batch Energy: 5.8948 | Batch Loss: 8.3201  | Perplexity: 4105.6912
2025-09-17 10:22:02,591 - INFO -   Batch 1740/1827 | Batch Energy: 5.8933 | Batch Loss: 8.6372  | Perplexity: 5637.6913
2025-09-17 10:22:06,120 - INFO -   Batch 1750/1827 | Batch Energy: 5.7373 | Batch Loss: 8.2270  | Perplexity: 3740.4176
2025-09-17 10:22:09,936 - INFO -   Batch 1760/1827 | Batch Energy: 6.1908 | Batch Loss: 8.5496  | Perplexity: 5164.8489
2025-09-17 10:22:13,841 - INFO -   Batch 1770/1827 | Batch Energy: 6.3267 | Batch Loss: 9.2937  | Perplexity: 10869.2457
2025-09-17 10:22:17,567 - INFO -   Batch 1780/1827 | Batch Energy: 6.1499 | Batch Loss: 7.7409  | Perplexity: 2300.5069
2025-09-17 10:22:21,792 - INFO -   Batch 1790/1827 | Batch Energy: 6.0090 | Batch Loss: 7.8916  | Perplexity: 2674.7025
2025-09-17 10:22:26,170 - INFO -   Batch 1800/1827 | Batch Energy: 6.4732 | Batch Loss: 8.9346  | Perplexity: 7590.2507
2025-09-17 10:22:30,204 - INFO -   Batch 1810/1827 | Batch Energy: 6.5738 | Batch Loss: 8.9154  | Perplexity: 7445.9198
2025-09-17 10:22:40,054 - INFO - 
########################################################################################################################
2025-09-17 10:22:40,054 - INFO - Using device: cpu (local rank 0)
2025-09-17 10:22:40,054 - INFO - Saving the hyperparameters configurations:
2025-09-17 10:22:40,054 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 8,
      "n_blocks": 8,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 10:22:40,359 - INFO - ========== Training started ==========
2025-09-17 10:22:40,359 - INFO - 1.27 M parameters
2025-09-17 10:22:40,359 - INFO - Epoch 1/2
2025-09-17 10:24:10,398 - INFO - 
########################################################################################################################
2025-09-17 10:24:10,398 - INFO - Using device: cpu (local rank 0)
2025-09-17 10:24:10,398 - INFO - Saving the hyperparameters configurations:
2025-09-17 10:24:10,398 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 4,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 10:24:10,654 - INFO - ========== Training started ==========
2025-09-17 10:24:10,654 - INFO - 1.27 M parameters
2025-09-17 10:24:10,654 - INFO - Epoch 1/2
2025-09-17 10:24:14,467 - INFO -   Batch 10/1827 | Batch Energy: 1.7654 | Batch Loss: 9.1015  | Perplexity: 8968.6206
2025-09-17 10:24:18,304 - INFO -   Batch 20/1827 | Batch Energy: 1.7644 | Batch Loss: 9.2330  | Perplexity: 10229.6786
2025-09-17 10:24:22,328 - INFO -   Batch 30/1827 | Batch Energy: 1.7477 | Batch Loss: 8.5081  | Perplexity: 4954.5064
2025-09-17 10:24:30,507 - INFO - 
########################################################################################################################
2025-09-17 10:24:30,507 - INFO - Using device: cpu (local rank 0)
2025-09-17 10:24:30,507 - INFO - Saving the hyperparameters configurations:
2025-09-17 10:24:30,507 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 4,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 10:24:30,813 - INFO - ========== Training started ==========
2025-09-17 10:24:30,814 - INFO - 6.70 M parameters
2025-09-17 10:24:30,814 - INFO - Epoch 1/2
2025-09-17 10:24:52,861 - INFO - 
########################################################################################################################
2025-09-17 10:24:52,861 - INFO - Using device: cpu (local rank 0)
2025-09-17 10:24:52,861 - INFO - Saving the hyperparameters configurations:
2025-09-17 10:24:52,862 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 6,
      "batch_size": 8,
      "num_epochs": 2,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 10:24:53,099 - INFO - ========== Training started ==========
2025-09-17 10:24:53,100 - INFO - 1.27 M parameters
2025-09-17 10:24:53,100 - INFO - Epoch 1/2
2025-09-17 10:24:57,200 - INFO -   Batch 10/1827 | Batch Energy: 1.8227 | Batch Loss: 9.4612  | Perplexity: 12851.2692
2025-09-17 10:25:01,336 - INFO -   Batch 20/1827 | Batch Energy: 1.8159 | Batch Loss: 9.9407  | Perplexity: 20757.6673
2025-09-17 10:25:05,003 - INFO -   Batch 30/1827 | Batch Energy: 1.8091 | Batch Loss: 9.5624  | Perplexity: 14220.1075
2025-09-17 10:25:08,846 - INFO -   Batch 40/1827 | Batch Energy: 1.8308 | Batch Loss: 8.6394  | Perplexity: 5649.7584
2025-09-17 10:25:12,607 - INFO -   Batch 50/1827 | Batch Energy: 1.8208 | Batch Loss: 8.9017  | Perplexity: 7344.3296
2025-09-17 10:25:16,517 - INFO -   Batch 60/1827 | Batch Energy: 1.8015 | Batch Loss: 8.8398  | Perplexity: 6903.7229
2025-09-17 10:25:20,543 - INFO -   Batch 70/1827 | Batch Energy: 1.8215 | Batch Loss: 8.6651  | Perplexity: 5797.3067
2025-09-17 10:25:24,329 - INFO -   Batch 80/1827 | Batch Energy: 1.8100 | Batch Loss: 8.3318  | Perplexity: 4153.7471
2025-09-17 10:25:28,566 - INFO -   Batch 90/1827 | Batch Energy: 1.8165 | Batch Loss: 8.4885  | Perplexity: 4858.4413
2025-09-17 10:25:32,619 - INFO -   Batch 100/1827 | Batch Energy: 1.8241 | Batch Loss: 8.2092  | Perplexity: 3674.4471
2025-09-17 10:25:37,126 - INFO -   Batch 110/1827 | Batch Energy: 1.8373 | Batch Loss: 8.5833  | Perplexity: 5341.5188
2025-09-17 10:25:42,538 - INFO -   Batch 120/1827 | Batch Energy: 1.8443 | Batch Loss: 7.8254  | Perplexity: 2503.4992
2025-09-17 10:25:46,873 - INFO -   Batch 130/1827 | Batch Energy: 1.8255 | Batch Loss: 8.5244  | Perplexity: 5035.9469
2025-09-17 10:25:51,179 - INFO -   Batch 140/1827 | Batch Energy: 1.8796 | Batch Loss: 7.8518  | Perplexity: 2570.2721
2025-09-17 10:25:55,148 - INFO -   Batch 150/1827 | Batch Energy: 1.8585 | Batch Loss: 8.1262  | Perplexity: 3381.7745
2025-09-17 10:25:59,656 - INFO -   Batch 160/1827 | Batch Energy: 1.8703 | Batch Loss: 7.9360  | Perplexity: 2796.2918
2025-09-17 10:26:03,750 - INFO -   Batch 170/1827 | Batch Energy: 1.8455 | Batch Loss: 7.8408  | Perplexity: 2542.2349
2025-09-17 10:26:07,787 - INFO -   Batch 180/1827 | Batch Energy: 1.8874 | Batch Loss: 7.8475  | Perplexity: 2559.2800
2025-09-17 10:26:11,689 - INFO -   Batch 190/1827 | Batch Energy: 1.8141 | Batch Loss: 8.1890  | Perplexity: 3600.9687
2025-09-17 10:26:15,508 - INFO -   Batch 200/1827 | Batch Energy: 1.8442 | Batch Loss: 7.1169  | Perplexity: 1232.6445
2025-09-17 10:26:19,661 - INFO -   Batch 210/1827 | Batch Energy: 1.8425 | Batch Loss: 8.2855  | Perplexity: 3965.9380
2025-09-17 10:26:23,506 - INFO -   Batch 220/1827 | Batch Energy: 1.8523 | Batch Loss: 8.2803  | Perplexity: 3945.2392
2025-09-17 10:26:27,589 - INFO -   Batch 230/1827 | Batch Energy: 1.8303 | Batch Loss: 7.7128  | Perplexity: 2236.8286
2025-09-17 10:26:31,396 - INFO -   Batch 240/1827 | Batch Energy: 1.8577 | Batch Loss: 8.0358  | Perplexity: 3089.5388
2025-09-17 10:26:35,428 - INFO -   Batch 250/1827 | Batch Energy: 1.8820 | Batch Loss: 8.5288  | Perplexity: 5058.4156
2025-09-17 10:26:39,354 - INFO -   Batch 260/1827 | Batch Energy: 1.8659 | Batch Loss: 7.2666  | Perplexity: 1431.7074
2025-09-17 10:26:43,371 - INFO -   Batch 270/1827 | Batch Energy: 1.8896 | Batch Loss: 8.4422  | Perplexity: 4638.9512
2025-09-17 10:26:47,099 - INFO -   Batch 280/1827 | Batch Energy: 1.8673 | Batch Loss: 8.1789  | Perplexity: 3564.7977
2025-09-17 10:26:51,101 - INFO -   Batch 290/1827 | Batch Energy: 1.8971 | Batch Loss: 7.5478  | Perplexity: 1896.5857
2025-09-17 10:26:55,127 - INFO -   Batch 300/1827 | Batch Energy: 1.8233 | Batch Loss: 7.9991  | Perplexity: 2978.1790
2025-09-17 10:26:59,117 - INFO -   Batch 310/1827 | Batch Energy: 1.8568 | Batch Loss: 8.2977  | Perplexity: 4014.7657
2025-09-17 10:27:02,931 - INFO -   Batch 320/1827 | Batch Energy: 1.8291 | Batch Loss: 8.1521  | Perplexity: 3470.5128
2025-09-17 10:27:06,984 - INFO -   Batch 330/1827 | Batch Energy: 1.8749 | Batch Loss: 8.0806  | Perplexity: 3231.0228
2025-09-17 10:27:10,903 - INFO -   Batch 340/1827 | Batch Energy: 1.8773 | Batch Loss: 7.9010  | Perplexity: 2699.9733
2025-09-17 10:27:14,823 - INFO -   Batch 350/1827 | Batch Energy: 1.8226 | Batch Loss: 7.4473  | Perplexity: 1715.2969
2025-09-17 10:27:18,836 - INFO -   Batch 360/1827 | Batch Energy: 1.8856 | Batch Loss: 8.1360  | Perplexity: 3415.3099
2025-09-17 10:27:22,993 - INFO -   Batch 370/1827 | Batch Energy: 1.8844 | Batch Loss: 7.7387  | Perplexity: 2295.5135
2025-09-17 10:27:27,071 - INFO -   Batch 380/1827 | Batch Energy: 1.8748 | Batch Loss: 7.8311  | Perplexity: 2517.6169
2025-09-17 10:27:31,286 - INFO -   Batch 390/1827 | Batch Energy: 1.8748 | Batch Loss: 7.6465  | Perplexity: 2093.2815
2025-09-17 10:27:35,383 - INFO -   Batch 400/1827 | Batch Energy: 1.8193 | Batch Loss: 8.3024  | Perplexity: 4033.7245
2025-09-17 10:27:39,506 - INFO -   Batch 410/1827 | Batch Energy: 1.8473 | Batch Loss: 7.8028  | Perplexity: 2447.3663
2025-09-17 10:27:43,541 - INFO -   Batch 420/1827 | Batch Energy: 1.8700 | Batch Loss: 7.8397  | Perplexity: 2539.4132
2025-09-17 10:27:47,614 - INFO -   Batch 430/1827 | Batch Energy: 1.8539 | Batch Loss: 7.5371  | Perplexity: 1876.3275
2025-09-17 10:27:51,735 - INFO -   Batch 440/1827 | Batch Energy: 1.8671 | Batch Loss: 7.5912  | Perplexity: 1980.7699
2025-09-17 10:27:56,885 - INFO -   Batch 450/1827 | Batch Energy: 1.8672 | Batch Loss: 7.6400  | Perplexity: 2079.6830
2025-09-17 10:28:00,961 - INFO -   Batch 460/1827 | Batch Energy: 1.8491 | Batch Loss: 7.9202  | Perplexity: 2752.3723
2025-09-17 10:28:04,797 - INFO -   Batch 470/1827 | Batch Energy: 1.8699 | Batch Loss: 7.8590  | Perplexity: 2588.8406
2025-09-17 10:28:08,888 - INFO -   Batch 480/1827 | Batch Energy: 1.9036 | Batch Loss: 8.2691  | Perplexity: 3901.2583
2025-09-17 10:28:12,817 - INFO -   Batch 490/1827 | Batch Energy: 1.8823 | Batch Loss: 7.7013  | Perplexity: 2211.1588
2025-09-17 10:28:17,171 - INFO -   Batch 500/1827 | Batch Energy: 1.8792 | Batch Loss: 7.2921  | Perplexity: 1468.6614
2025-09-17 10:28:21,172 - INFO -   Batch 510/1827 | Batch Energy: 1.8854 | Batch Loss: 7.7159  | Perplexity: 2243.8514
2025-09-17 10:28:25,652 - INFO -   Batch 520/1827 | Batch Energy: 1.8794 | Batch Loss: 7.4069  | Perplexity: 1647.3682
2025-09-17 10:28:29,694 - INFO -   Batch 530/1827 | Batch Energy: 1.8834 | Batch Loss: 7.6748  | Perplexity: 2153.3538
2025-09-17 10:28:33,741 - INFO -   Batch 540/1827 | Batch Energy: 1.8725 | Batch Loss: 8.3165  | Perplexity: 4091.0187
2025-09-17 10:28:37,659 - INFO -   Batch 550/1827 | Batch Energy: 1.8646 | Batch Loss: 7.6508  | Perplexity: 2102.4205
2025-09-17 10:28:41,892 - INFO -   Batch 560/1827 | Batch Energy: 1.8566 | Batch Loss: 7.2594  | Perplexity: 1421.4087
2025-09-17 10:28:46,138 - INFO -   Batch 570/1827 | Batch Energy: 1.8560 | Batch Loss: 8.4736  | Perplexity: 4786.8098
2025-09-17 10:28:50,031 - INFO -   Batch 580/1827 | Batch Energy: 1.8702 | Batch Loss: 7.1604  | Perplexity: 1287.4189
2025-09-17 10:28:54,209 - INFO -   Batch 590/1827 | Batch Energy: 1.8723 | Batch Loss: 7.8408  | Perplexity: 2542.2858
2025-09-17 10:28:58,379 - INFO -   Batch 600/1827 | Batch Energy: 1.8713 | Batch Loss: 8.3753  | Perplexity: 4338.5094
2025-09-17 10:29:02,989 - INFO -   Batch 610/1827 | Batch Energy: 1.8948 | Batch Loss: 7.7247  | Perplexity: 2263.4827
2025-09-17 10:29:07,095 - INFO -   Batch 620/1827 | Batch Energy: 1.8919 | Batch Loss: 8.1715  | Perplexity: 3538.5677
2025-09-17 10:29:10,999 - INFO -   Batch 630/1827 | Batch Energy: 1.8921 | Batch Loss: 7.8753  | Perplexity: 2631.5155
2025-09-17 10:29:15,043 - INFO -   Batch 640/1827 | Batch Energy: 1.9355 | Batch Loss: 7.7165  | Perplexity: 2245.0276
2025-09-17 10:29:19,413 - INFO -   Batch 650/1827 | Batch Energy: 1.9206 | Batch Loss: 7.6250  | Perplexity: 2048.7385
2025-09-17 10:29:23,611 - INFO -   Batch 660/1827 | Batch Energy: 1.9297 | Batch Loss: 7.3039  | Perplexity: 1486.1485
2025-09-17 10:29:28,095 - INFO -   Batch 670/1827 | Batch Energy: 1.9137 | Batch Loss: 7.9414  | Perplexity: 2811.3607
2025-09-17 10:29:32,523 - INFO -   Batch 680/1827 | Batch Energy: 1.9114 | Batch Loss: 8.2425  | Perplexity: 3798.9475
2025-09-17 10:29:36,430 - INFO -   Batch 690/1827 | Batch Energy: 1.9422 | Batch Loss: 8.5384  | Perplexity: 5107.2768
2025-09-17 10:29:40,467 - INFO -   Batch 700/1827 | Batch Energy: 1.9446 | Batch Loss: 8.1411  | Perplexity: 3432.7472
2025-09-17 10:29:44,557 - INFO -   Batch 710/1827 | Batch Energy: 1.9364 | Batch Loss: 8.0875  | Perplexity: 3253.4647
2025-09-17 10:29:48,555 - INFO -   Batch 720/1827 | Batch Energy: 1.9411 | Batch Loss: 8.1450  | Perplexity: 3446.2056
2025-09-17 10:29:52,364 - INFO -   Batch 730/1827 | Batch Energy: 1.9226 | Batch Loss: 7.5710  | Perplexity: 1941.0861
2025-09-17 10:29:56,693 - INFO -   Batch 740/1827 | Batch Energy: 1.9128 | Batch Loss: 7.7341  | Perplexity: 2284.8878
2025-09-17 10:30:00,859 - INFO -   Batch 750/1827 | Batch Energy: 1.9291 | Batch Loss: 8.3710  | Perplexity: 4319.8274
2025-09-17 10:30:05,442 - INFO -   Batch 760/1827 | Batch Energy: 1.9172 | Batch Loss: 7.6488  | Perplexity: 2098.0401
2025-09-17 10:30:10,718 - INFO -   Batch 770/1827 | Batch Energy: 1.9293 | Batch Loss: 7.6835  | Perplexity: 2172.2130
2025-09-17 10:30:15,390 - INFO -   Batch 780/1827 | Batch Energy: 1.9722 | Batch Loss: 7.9010  | Perplexity: 2699.9746
2025-09-17 10:30:19,358 - INFO -   Batch 790/1827 | Batch Energy: 1.9396 | Batch Loss: 7.2432  | Perplexity: 1398.6300
2025-09-17 10:30:23,246 - INFO -   Batch 800/1827 | Batch Energy: 1.9661 | Batch Loss: 7.7362  | Perplexity: 2289.6867
2025-09-17 10:30:27,097 - INFO -   Batch 810/1827 | Batch Energy: 1.9578 | Batch Loss: 8.5052  | Perplexity: 4940.4789
2025-09-17 10:30:31,037 - INFO -   Batch 820/1827 | Batch Energy: 1.9710 | Batch Loss: 7.9107  | Perplexity: 2726.4304
2025-09-17 10:30:35,046 - INFO -   Batch 830/1827 | Batch Energy: 1.9797 | Batch Loss: 7.9581  | Perplexity: 2858.6128
2025-09-17 10:30:39,167 - INFO -   Batch 840/1827 | Batch Energy: 1.9621 | Batch Loss: 7.2643  | Perplexity: 1428.3457
2025-09-17 10:30:43,080 - INFO -   Batch 850/1827 | Batch Energy: 2.0046 | Batch Loss: 7.9261  | Perplexity: 2768.6603
2025-09-17 10:30:46,753 - INFO -   Batch 860/1827 | Batch Energy: 1.9911 | Batch Loss: 7.9699  | Perplexity: 2892.5699
2025-09-17 10:30:50,556 - INFO -   Batch 870/1827 | Batch Energy: 1.9906 | Batch Loss: 7.7244  | Perplexity: 2262.7942
2025-09-17 10:30:54,516 - INFO -   Batch 880/1827 | Batch Energy: 2.0116 | Batch Loss: 7.7317  | Perplexity: 2279.5000
2025-09-17 10:30:58,492 - INFO -   Batch 890/1827 | Batch Energy: 2.0142 | Batch Loss: 8.2405  | Perplexity: 3791.4083
2025-09-17 10:31:02,420 - INFO -   Batch 900/1827 | Batch Energy: 2.0548 | Batch Loss: 8.5687  | Perplexity: 5264.3211
2025-09-17 10:31:06,360 - INFO -   Batch 910/1827 | Batch Energy: 2.0615 | Batch Loss: 8.3551  | Perplexity: 4251.6300
2025-09-17 10:31:10,503 - INFO -   Batch 920/1827 | Batch Energy: 2.0469 | Batch Loss: 7.5393  | Perplexity: 1880.4782
2025-09-17 10:31:14,782 - INFO -   Batch 930/1827 | Batch Energy: 2.0706 | Batch Loss: 7.7806  | Perplexity: 2393.6902
2025-09-17 10:31:18,811 - INFO -   Batch 940/1827 | Batch Energy: 2.0818 | Batch Loss: 7.8238  | Perplexity: 2499.4592
2025-09-17 10:31:22,914 - INFO -   Batch 950/1827 | Batch Energy: 2.0648 | Batch Loss: 8.1761  | Perplexity: 3555.0065
2025-09-17 10:31:26,928 - INFO -   Batch 960/1827 | Batch Energy: 2.0409 | Batch Loss: 7.8991  | Perplexity: 2694.8503
2025-09-17 10:31:30,720 - INFO -   Batch 970/1827 | Batch Energy: 2.0400 | Batch Loss: 8.6202  | Perplexity: 5542.5432
2025-09-17 10:31:34,671 - INFO -   Batch 980/1827 | Batch Energy: 2.0481 | Batch Loss: 8.5296  | Perplexity: 5062.4936
2025-09-17 10:31:39,201 - INFO -   Batch 990/1827 | Batch Energy: 2.0129 | Batch Loss: 7.6019  | Perplexity: 2001.9447
2025-09-17 10:31:43,689 - INFO -   Batch 1000/1827 | Batch Energy: 2.0340 | Batch Loss: 8.1854  | Perplexity: 3588.3121
2025-09-17 10:31:47,944 - INFO -   Batch 1010/1827 | Batch Energy: 2.0410 | Batch Loss: 8.1793  | Perplexity: 3566.2258
2025-09-17 10:31:51,913 - INFO -   Batch 1020/1827 | Batch Energy: 2.0480 | Batch Loss: 8.3011  | Perplexity: 4028.1465
2025-09-17 10:31:56,123 - INFO -   Batch 1030/1827 | Batch Energy: 2.0661 | Batch Loss: 8.2747  | Perplexity: 3923.5332
2025-09-17 10:32:00,145 - INFO -   Batch 1040/1827 | Batch Energy: 2.0388 | Batch Loss: 8.5026  | Perplexity: 4927.6800
2025-09-17 10:32:04,562 - INFO -   Batch 1050/1827 | Batch Energy: 2.0238 | Batch Loss: 8.1021  | Perplexity: 3301.4800
2025-09-17 10:32:08,773 - INFO -   Batch 1060/1827 | Batch Energy: 2.0794 | Batch Loss: 7.7458  | Perplexity: 2311.8732
2025-09-17 10:32:12,932 - INFO -   Batch 1070/1827 | Batch Energy: 2.0837 | Batch Loss: 8.6170  | Perplexity: 5524.9010
2025-09-17 10:32:17,004 - INFO -   Batch 1080/1827 | Batch Energy: 2.1140 | Batch Loss: 7.7100  | Perplexity: 2230.5083
2025-09-17 10:32:20,882 - INFO -   Batch 1090/1827 | Batch Energy: 2.0975 | Batch Loss: 8.4369  | Perplexity: 4614.4097
2025-09-17 10:32:24,886 - INFO -   Batch 1100/1827 | Batch Energy: 2.1135 | Batch Loss: 7.8856  | Perplexity: 2658.7200
2025-09-17 10:32:29,154 - INFO -   Batch 1110/1827 | Batch Energy: 2.0887 | Batch Loss: 7.7106  | Perplexity: 2231.7914
2025-09-17 10:32:33,130 - INFO -   Batch 1120/1827 | Batch Energy: 2.1626 | Batch Loss: 8.1615  | Perplexity: 3503.4177
2025-09-17 10:32:37,184 - INFO -   Batch 1130/1827 | Batch Energy: 2.1197 | Batch Loss: 7.9424  | Perplexity: 2814.2444
2025-09-17 10:32:41,624 - INFO -   Batch 1140/1827 | Batch Energy: 2.1682 | Batch Loss: 8.4142  | Perplexity: 4510.5788
2025-09-17 10:32:45,771 - INFO -   Batch 1150/1827 | Batch Energy: 2.1885 | Batch Loss: 7.8895  | Perplexity: 2669.0572
2025-09-17 10:32:49,664 - INFO -   Batch 1160/1827 | Batch Energy: 2.1835 | Batch Loss: 8.2029  | Perplexity: 3651.3500
2025-09-17 10:32:53,527 - INFO -   Batch 1170/1827 | Batch Energy: 2.2068 | Batch Loss: 8.2122  | Perplexity: 3685.7902
2025-09-17 10:32:57,524 - INFO -   Batch 1180/1827 | Batch Energy: 2.2517 | Batch Loss: 8.2682  | Perplexity: 3898.0302
2025-09-17 10:33:01,608 - INFO -   Batch 1190/1827 | Batch Energy: 2.2026 | Batch Loss: 8.7298  | Perplexity: 6184.7461
2025-09-17 10:33:06,013 - INFO -   Batch 1200/1827 | Batch Energy: 2.2634 | Batch Loss: 8.4825  | Perplexity: 4829.3155
2025-09-17 10:33:09,964 - INFO -   Batch 1210/1827 | Batch Energy: 2.2563 | Batch Loss: 7.7730  | Perplexity: 2375.5721
2025-09-17 10:33:14,120 - INFO -   Batch 1220/1827 | Batch Energy: 2.2595 | Batch Loss: 8.6143  | Perplexity: 5509.9364
2025-09-17 10:33:19,004 - INFO -   Batch 1230/1827 | Batch Energy: 2.2939 | Batch Loss: 7.4112  | Perplexity: 1654.3332
2025-09-17 10:33:23,844 - INFO -   Batch 1240/1827 | Batch Energy: 2.3929 | Batch Loss: 8.7170  | Perplexity: 6105.6711
2025-09-17 10:33:28,195 - INFO -   Batch 1250/1827 | Batch Energy: 2.3256 | Batch Loss: 8.4602  | Perplexity: 4723.0310
2025-09-17 10:33:32,428 - INFO -   Batch 1260/1827 | Batch Energy: 2.2814 | Batch Loss: 9.2789  | Perplexity: 10709.7894
2025-09-17 10:33:36,399 - INFO -   Batch 1270/1827 | Batch Energy: 2.3391 | Batch Loss: 8.4572  | Perplexity: 4708.7382
2025-09-17 10:33:40,373 - INFO -   Batch 1280/1827 | Batch Energy: 2.3029 | Batch Loss: 7.6356  | Perplexity: 2070.5421
2025-09-17 10:33:44,857 - INFO -   Batch 1290/1827 | Batch Energy: 2.2890 | Batch Loss: 8.8305  | Perplexity: 6839.6447
2025-09-17 10:33:49,639 - INFO -   Batch 1300/1827 | Batch Energy: 2.3114 | Batch Loss: 8.7153  | Perplexity: 6095.5885
2025-09-17 10:33:54,177 - INFO -   Batch 1310/1827 | Batch Energy: 2.3724 | Batch Loss: 8.2142  | Perplexity: 3693.0559
2025-09-17 10:33:58,291 - INFO -   Batch 1320/1827 | Batch Energy: 2.4046 | Batch Loss: 8.3393  | Perplexity: 4185.2555
2025-09-17 10:34:02,561 - INFO -   Batch 1330/1827 | Batch Energy: 2.4800 | Batch Loss: 8.6164  | Perplexity: 5521.7089
2025-09-17 10:34:07,592 - INFO -   Batch 1340/1827 | Batch Energy: 2.4964 | Batch Loss: 9.0922  | Perplexity: 8886.0292
2025-09-17 10:34:12,138 - INFO -   Batch 1350/1827 | Batch Energy: 2.5479 | Batch Loss: 8.1283  | Perplexity: 3389.0582
2025-09-17 10:34:16,536 - INFO -   Batch 1360/1827 | Batch Energy: 2.4627 | Batch Loss: 8.1709  | Perplexity: 3536.5030
2025-09-17 10:34:21,334 - INFO -   Batch 1370/1827 | Batch Energy: 2.5740 | Batch Loss: 9.0522  | Perplexity: 8536.8950
2025-09-17 10:34:26,687 - INFO -   Batch 1380/1827 | Batch Energy: 2.6244 | Batch Loss: 8.0613  | Perplexity: 3169.3179
2025-09-17 10:34:31,111 - INFO -   Batch 1390/1827 | Batch Energy: 2.5930 | Batch Loss: 8.1489  | Perplexity: 3459.4858
2025-09-17 10:34:35,280 - INFO -   Batch 1400/1827 | Batch Energy: 2.7218 | Batch Loss: 7.8863  | Perplexity: 2660.5247
2025-09-17 10:34:39,398 - INFO -   Batch 1410/1827 | Batch Energy: 2.7642 | Batch Loss: 7.8471  | Perplexity: 2558.4259
2025-09-17 10:34:43,383 - INFO -   Batch 1420/1827 | Batch Energy: 2.7522 | Batch Loss: 8.5627  | Perplexity: 5232.9268
2025-09-17 10:34:47,346 - INFO -   Batch 1430/1827 | Batch Energy: 2.9065 | Batch Loss: 8.8946  | Perplexity: 7292.5635
2025-09-17 10:34:51,439 - INFO -   Batch 1440/1827 | Batch Energy: 2.8062 | Batch Loss: 8.2061  | Perplexity: 3663.2087
2025-09-17 10:34:55,467 - INFO -   Batch 1450/1827 | Batch Energy: 2.9655 | Batch Loss: 8.9217  | Perplexity: 7492.9198
2025-09-17 10:34:59,631 - INFO -   Batch 1460/1827 | Batch Energy: 2.9891 | Batch Loss: 8.6646  | Perplexity: 5794.2446
2025-09-17 10:35:03,563 - INFO -   Batch 1470/1827 | Batch Energy: 3.0144 | Batch Loss: 8.5427  | Perplexity: 5129.2273
2025-09-17 10:35:07,427 - INFO -   Batch 1480/1827 | Batch Energy: 2.9588 | Batch Loss: 8.8280  | Perplexity: 6822.3031
2025-09-17 10:35:11,389 - INFO -   Batch 1490/1827 | Batch Energy: 2.8862 | Batch Loss: 8.0223  | Perplexity: 3048.1823
2025-09-17 10:35:15,715 - INFO -   Batch 1500/1827 | Batch Energy: 2.9555 | Batch Loss: 8.7689  | Perplexity: 6431.3760
2025-09-17 10:35:19,967 - INFO -   Batch 1510/1827 | Batch Energy: 2.8565 | Batch Loss: 8.4010  | Perplexity: 4451.3124
2025-09-17 10:35:23,713 - INFO -   Batch 1520/1827 | Batch Energy: 2.8913 | Batch Loss: 8.4019  | Perplexity: 4455.5085
2025-09-17 10:35:27,853 - INFO -   Batch 1530/1827 | Batch Energy: 2.8700 | Batch Loss: 9.0739  | Perplexity: 8724.5937
2025-09-17 10:35:32,671 - INFO -   Batch 1540/1827 | Batch Energy: 2.9104 | Batch Loss: 9.3096  | Perplexity: 11043.9919
2025-09-17 10:35:38,494 - INFO -   Batch 1550/1827 | Batch Energy: 3.0123 | Batch Loss: 8.1452  | Perplexity: 3446.7117
2025-09-17 10:35:43,865 - INFO -   Batch 1560/1827 | Batch Energy: 3.0680 | Batch Loss: 9.2099  | Perplexity: 9995.2531
2025-09-17 10:35:48,849 - INFO -   Batch 1570/1827 | Batch Energy: 3.1949 | Batch Loss: 8.2618  | Perplexity: 3873.1510
2025-09-17 10:35:52,936 - INFO -   Batch 1580/1827 | Batch Energy: 3.1431 | Batch Loss: 8.7320  | Perplexity: 6198.1319
2025-09-17 10:35:57,495 - INFO -   Batch 1590/1827 | Batch Energy: 3.2399 | Batch Loss: 7.9980  | Perplexity: 2974.9755
2025-09-17 10:36:01,850 - INFO -   Batch 1600/1827 | Batch Energy: 3.3383 | Batch Loss: 7.5029  | Perplexity: 1813.3342
2025-09-17 10:36:06,837 - INFO -   Batch 1610/1827 | Batch Energy: 3.4328 | Batch Loss: 8.0525  | Perplexity: 3141.5097
2025-09-17 10:36:11,538 - INFO -   Batch 1620/1827 | Batch Energy: 3.3875 | Batch Loss: 8.9147  | Perplexity: 7440.3334
2025-09-17 10:36:16,576 - INFO -   Batch 1630/1827 | Batch Energy: 3.4421 | Batch Loss: 8.7427  | Perplexity: 6264.8094
2025-09-17 10:36:20,906 - INFO -   Batch 1640/1827 | Batch Energy: 3.4655 | Batch Loss: 8.3102  | Perplexity: 4064.9814
2025-09-17 10:36:25,024 - INFO -   Batch 1650/1827 | Batch Energy: 3.4463 | Batch Loss: 8.9003  | Perplexity: 7334.3975
2025-09-17 10:36:29,012 - INFO -   Batch 1660/1827 | Batch Energy: 3.4329 | Batch Loss: 7.4438  | Perplexity: 1709.1800
2025-09-17 10:36:32,950 - INFO -   Batch 1670/1827 | Batch Energy: 3.6770 | Batch Loss: 8.5178  | Perplexity: 5002.8649
2025-09-17 10:36:37,153 - INFO -   Batch 1680/1827 | Batch Energy: 3.6429 | Batch Loss: 8.6899  | Perplexity: 5942.7773
2025-09-17 10:36:41,106 - INFO -   Batch 1690/1827 | Batch Energy: 3.6547 | Batch Loss: 8.8233  | Perplexity: 6790.4514
2025-09-17 10:36:45,414 - INFO -   Batch 1700/1827 | Batch Energy: 3.8391 | Batch Loss: 8.6899  | Perplexity: 5942.7377
2025-09-17 10:36:49,304 - INFO -   Batch 1710/1827 | Batch Energy: 3.7074 | Batch Loss: 8.2351  | Perplexity: 3771.1313
2025-09-17 10:36:53,052 - INFO -   Batch 1720/1827 | Batch Energy: 3.8350 | Batch Loss: 8.6859  | Perplexity: 5918.6095
2025-09-17 10:36:57,100 - INFO -   Batch 1730/1827 | Batch Energy: 3.4991 | Batch Loss: 7.8862  | Perplexity: 2660.2215
2025-09-17 10:37:01,492 - INFO -   Batch 1740/1827 | Batch Energy: 3.9091 | Batch Loss: 8.6156  | Perplexity: 5516.8191
2025-09-17 10:37:05,787 - INFO -   Batch 1750/1827 | Batch Energy: 3.9757 | Batch Loss: 9.8814  | Perplexity: 19563.7283
2025-09-17 10:37:09,778 - INFO -   Batch 1760/1827 | Batch Energy: 3.6951 | Batch Loss: 8.0089  | Perplexity: 3007.6060
2025-09-17 10:37:13,918 - INFO -   Batch 1770/1827 | Batch Energy: 4.0803 | Batch Loss: 8.8886  | Perplexity: 7248.5897
2025-09-17 10:37:17,821 - INFO -   Batch 1780/1827 | Batch Energy: 3.8346 | Batch Loss: 8.3891  | Perplexity: 4398.8741
2025-09-17 10:37:22,021 - INFO -   Batch 1790/1827 | Batch Energy: 3.9375 | Batch Loss: 9.0556  | Perplexity: 8566.1319
2025-09-17 10:37:26,057 - INFO -   Batch 1800/1827 | Batch Energy: 3.9409 | Batch Loss: 8.1967  | Perplexity: 3628.9242
2025-09-17 10:37:30,285 - INFO -   Batch 1810/1827 | Batch Energy: 4.3636 | Batch Loss: 8.1467  | Perplexity: 3452.0474
2025-09-17 10:37:34,749 - INFO -   Batch 1820/1827 | Batch Energy: 4.2615 | Batch Loss: 8.9655  | Perplexity: 7828.3014
2025-09-17 10:38:23,682 - INFO - Epoch 1/2 | Train Energy: 2.3264 | Train Perplexity: 3578.4019 | Val Energy: 4.4234 | Val Perplexity: 7361.9836
2025-09-17 10:38:23,682 - INFO - Epoch 2/2
2025-09-17 10:38:30,605 - INFO -   Batch 10/1827 | Batch Energy: 4.3156 | Batch Loss: 8.6596  | Perplexity: 5765.2516
2025-09-17 10:38:36,801 - INFO -   Batch 20/1827 | Batch Energy: 4.4048 | Batch Loss: 8.9688  | Perplexity: 7854.2801
2025-09-17 10:38:45,626 - INFO -   Batch 30/1827 | Batch Energy: 4.5162 | Batch Loss: 9.1207  | Perplexity: 9142.5109
2025-09-17 10:38:50,120 - INFO -   Batch 40/1827 | Batch Energy: 4.6394 | Batch Loss: 7.7456  | Perplexity: 2311.4653
2025-09-17 10:38:55,253 - INFO -   Batch 50/1827 | Batch Energy: 4.6559 | Batch Loss: 7.6260  | Perplexity: 2050.8673
2025-09-17 10:38:59,727 - INFO -   Batch 60/1827 | Batch Energy: 4.3796 | Batch Loss: 9.0335  | Perplexity: 8378.9331
2025-09-17 10:39:03,780 - INFO -   Batch 70/1827 | Batch Energy: 4.6337 | Batch Loss: 8.7981  | Perplexity: 6621.9003
2025-09-17 10:39:08,212 - INFO -   Batch 80/1827 | Batch Energy: 4.9979 | Batch Loss: 8.1717  | Perplexity: 3539.2427
2025-09-17 10:39:13,115 - INFO -   Batch 90/1827 | Batch Energy: 4.9299 | Batch Loss: 8.1192  | Perplexity: 3358.4058
2025-09-17 10:39:17,613 - INFO -   Batch 100/1827 | Batch Energy: 4.6713 | Batch Loss: 8.0641  | Perplexity: 3178.2013
2025-09-17 10:39:22,627 - INFO -   Batch 110/1827 | Batch Energy: 5.2467 | Batch Loss: 7.7841  | Perplexity: 2402.1779
2025-09-17 10:39:26,743 - INFO -   Batch 120/1827 | Batch Energy: 5.0338 | Batch Loss: 9.4961  | Perplexity: 13307.6295
2025-09-17 10:39:31,296 - INFO -   Batch 130/1827 | Batch Energy: 5.1634 | Batch Loss: 8.5579  | Perplexity: 5207.7208
2025-09-17 10:39:35,540 - INFO -   Batch 140/1827 | Batch Energy: 4.9671 | Batch Loss: 9.4730  | Perplexity: 13004.2688
2025-09-17 10:39:39,694 - INFO -   Batch 150/1827 | Batch Energy: 5.1621 | Batch Loss: 9.2554  | Perplexity: 10460.6498
2025-09-17 10:39:43,724 - INFO -   Batch 160/1827 | Batch Energy: 5.0581 | Batch Loss: 9.7359  | Perplexity: 16913.3243
2025-09-17 10:39:48,036 - INFO -   Batch 170/1827 | Batch Energy: 5.4869 | Batch Loss: 8.8262  | Perplexity: 6810.5174
2025-09-17 10:39:52,417 - INFO -   Batch 180/1827 | Batch Energy: 5.6530 | Batch Loss: 8.8691  | Perplexity: 7108.8909
2025-09-17 10:39:56,345 - INFO -   Batch 190/1827 | Batch Energy: 5.3030 | Batch Loss: 8.7470  | Perplexity: 6292.0588
2025-09-17 10:40:00,731 - INFO -   Batch 200/1827 | Batch Energy: 5.2555 | Batch Loss: 9.4765  | Perplexity: 13049.7886
2025-09-17 10:40:04,781 - INFO -   Batch 210/1827 | Batch Energy: 5.5379 | Batch Loss: 9.3529  | Perplexity: 11532.1473
2025-09-17 10:40:08,750 - INFO -   Batch 220/1827 | Batch Energy: 5.8421 | Batch Loss: 8.9101  | Perplexity: 7406.1120
2025-09-17 10:40:12,650 - INFO -   Batch 230/1827 | Batch Energy: 5.9507 | Batch Loss: 9.9952  | Perplexity: 21921.1628
2025-09-17 10:40:16,658 - INFO -   Batch 240/1827 | Batch Energy: 6.6995 | Batch Loss: 9.6330  | Perplexity: 15260.2701
2025-09-17 10:40:20,751 - INFO -   Batch 250/1827 | Batch Energy: 6.5095 | Batch Loss: 10.0213  | Perplexity: 22499.5531
2025-09-17 10:40:25,208 - INFO -   Batch 260/1827 | Batch Energy: 5.8058 | Batch Loss: 7.7162  | Perplexity: 2244.3308
2025-09-17 10:40:29,309 - INFO -   Batch 270/1827 | Batch Energy: 6.5290 | Batch Loss: 8.8515  | Perplexity: 6984.8553
2025-09-17 10:40:33,379 - INFO -   Batch 280/1827 | Batch Energy: 6.1810 | Batch Loss: 9.1392  | Perplexity: 9313.2868
2025-09-17 10:40:37,766 - INFO -   Batch 290/1827 | Batch Energy: 6.6245 | Batch Loss: 9.5202  | Perplexity: 13632.9844
2025-09-17 10:40:42,390 - INFO -   Batch 300/1827 | Batch Energy: 7.2865 | Batch Loss: 9.0616  | Perplexity: 8618.0164
2025-09-17 10:40:46,498 - INFO -   Batch 310/1827 | Batch Energy: 6.8018 | Batch Loss: 8.7833  | Perplexity: 6524.1507
2025-09-17 10:40:50,998 - INFO -   Batch 320/1827 | Batch Energy: 6.8428 | Batch Loss: 9.6022  | Perplexity: 14797.9565
2025-09-17 10:40:55,351 - INFO -   Batch 330/1827 | Batch Energy: 7.1172 | Batch Loss: 9.0671  | Perplexity: 8665.7348
2025-09-17 10:40:59,477 - INFO -   Batch 340/1827 | Batch Energy: 6.8366 | Batch Loss: 10.3863  | Perplexity: 32412.1504
2025-09-17 10:41:03,700 - INFO -   Batch 350/1827 | Batch Energy: 7.4271 | Batch Loss: 9.3255  | Perplexity: 11220.8733
2025-09-17 10:41:07,588 - INFO -   Batch 360/1827 | Batch Energy: 7.7250 | Batch Loss: 7.9528  | Perplexity: 2843.6458
2025-09-17 10:41:11,707 - INFO -   Batch 370/1827 | Batch Energy: 8.0332 | Batch Loss: 9.9417  | Perplexity: 20778.1069
2025-09-17 10:41:16,201 - INFO -   Batch 380/1827 | Batch Energy: 7.7939 | Batch Loss: 9.1838  | Perplexity: 9738.2705
2025-09-17 10:41:21,721 - INFO -   Batch 390/1827 | Batch Energy: 8.7076 | Batch Loss: 8.5099  | Perplexity: 4963.4447
2025-09-17 10:41:27,562 - INFO -   Batch 400/1827 | Batch Energy: 8.8359 | Batch Loss: 9.0716  | Perplexity: 8704.2158
2025-09-17 10:41:33,101 - INFO -   Batch 410/1827 | Batch Energy: 8.3468 | Batch Loss: 9.5772  | Perplexity: 14431.6770
2025-09-17 10:41:37,540 - INFO -   Batch 420/1827 | Batch Energy: 8.9716 | Batch Loss: 9.0193  | Perplexity: 8261.1695
2025-09-17 10:41:41,771 - INFO -   Batch 430/1827 | Batch Energy: 9.1549 | Batch Loss: 9.3133  | Perplexity: 11084.1615
2025-09-17 10:41:45,722 - INFO -   Batch 440/1827 | Batch Energy: 8.5770 | Batch Loss: 8.8518  | Perplexity: 6986.8340
2025-09-17 10:41:49,687 - INFO -   Batch 450/1827 | Batch Energy: 8.8091 | Batch Loss: 9.0487  | Perplexity: 8507.3035
2025-09-17 10:41:53,672 - INFO -   Batch 460/1827 | Batch Energy: 8.2340 | Batch Loss: 9.0380  | Perplexity: 8416.8390
2025-09-17 10:41:57,468 - INFO -   Batch 470/1827 | Batch Energy: 8.4752 | Batch Loss: 9.2508  | Perplexity: 10413.0430
2025-09-17 10:42:01,266 - INFO -   Batch 480/1827 | Batch Energy: 9.2971 | Batch Loss: 9.4131  | Perplexity: 12247.7716
2025-09-17 10:42:05,343 - INFO -   Batch 490/1827 | Batch Energy: 9.1475 | Batch Loss: 8.7672  | Perplexity: 6419.9167
2025-09-17 10:42:09,554 - INFO -   Batch 500/1827 | Batch Energy: 10.2174 | Batch Loss: 9.4074  | Perplexity: 12177.6571
2025-09-17 10:42:13,688 - INFO -   Batch 510/1827 | Batch Energy: 10.1517 | Batch Loss: 9.3029  | Perplexity: 10969.6530
2025-09-17 10:42:18,037 - INFO -   Batch 520/1827 | Batch Energy: 10.2140 | Batch Loss: 9.0800  | Perplexity: 8777.6305
2025-09-17 10:42:22,650 - INFO -   Batch 530/1827 | Batch Energy: 11.5724 | Batch Loss: 10.0633  | Perplexity: 23466.6918
2025-09-17 10:42:27,204 - INFO -   Batch 540/1827 | Batch Energy: 10.7621 | Batch Loss: 8.7380  | Perplexity: 6235.5308
2025-09-17 10:42:31,241 - INFO -   Batch 550/1827 | Batch Energy: 10.3756 | Batch Loss: 10.2652  | Perplexity: 28714.5879
2025-09-17 10:42:35,438 - INFO -   Batch 560/1827 | Batch Energy: 11.5728 | Batch Loss: 11.0894  | Perplexity: 65471.5962
2025-09-17 10:42:39,941 - INFO -   Batch 570/1827 | Batch Energy: 10.8721 | Batch Loss: 9.5952  | Perplexity: 14694.5928
2025-09-17 10:42:43,971 - INFO -   Batch 580/1827 | Batch Energy: 12.3774 | Batch Loss: 8.3897  | Perplexity: 4401.4800
2025-09-17 10:42:47,832 - INFO -   Batch 590/1827 | Batch Energy: 12.1170 | Batch Loss: 9.2631  | Perplexity: 10541.9598
2025-09-17 10:42:52,232 - INFO -   Batch 600/1827 | Batch Energy: 12.6800 | Batch Loss: 11.5948  | Perplexity: 108532.8942
2025-09-17 10:42:56,726 - INFO -   Batch 610/1827 | Batch Energy: 11.6899 | Batch Loss: 9.1258  | Perplexity: 9189.5220
2025-09-17 10:43:01,365 - INFO -   Batch 620/1827 | Batch Energy: 11.4747 | Batch Loss: 9.9254  | Perplexity: 20442.1065
2025-09-17 10:43:05,457 - INFO -   Batch 630/1827 | Batch Energy: 11.3879 | Batch Loss: 8.4024  | Perplexity: 4457.7569
2025-09-17 10:43:09,573 - INFO -   Batch 640/1827 | Batch Energy: 12.0552 | Batch Loss: 10.0420  | Perplexity: 22972.4146
2025-09-17 10:43:14,336 - INFO -   Batch 650/1827 | Batch Energy: 12.3647 | Batch Loss: 9.2906  | Perplexity: 10836.0020
2025-09-17 10:43:18,612 - INFO -   Batch 660/1827 | Batch Energy: 12.2790 | Batch Loss: 10.2206  | Perplexity: 27461.8596
2025-09-17 10:43:22,822 - INFO -   Batch 670/1827 | Batch Energy: 13.4173 | Batch Loss: 9.0529  | Perplexity: 8543.5165
2025-09-17 10:43:26,885 - INFO -   Batch 680/1827 | Batch Energy: 13.6366 | Batch Loss: 8.0602  | Perplexity: 3166.0432
2025-09-17 10:43:30,926 - INFO -   Batch 690/1827 | Batch Energy: 14.3504 | Batch Loss: 8.7959  | Perplexity: 6607.2843
2025-09-17 10:43:34,900 - INFO -   Batch 700/1827 | Batch Energy: 14.2366 | Batch Loss: 8.0524  | Perplexity: 3141.2251
2025-09-17 10:43:39,036 - INFO -   Batch 710/1827 | Batch Energy: 15.9420 | Batch Loss: 9.2854  | Perplexity: 10779.3857
2025-09-17 10:43:43,044 - INFO -   Batch 720/1827 | Batch Energy: 13.8658 | Batch Loss: 8.2095  | Perplexity: 3675.5861
2025-09-17 10:43:47,218 - INFO -   Batch 730/1827 | Batch Energy: 14.5455 | Batch Loss: 8.8286  | Perplexity: 6826.9957
2025-09-17 10:43:51,626 - INFO -   Batch 740/1827 | Batch Energy: 15.2767 | Batch Loss: 9.7934  | Perplexity: 17914.9228
2025-09-17 10:43:55,680 - INFO -   Batch 750/1827 | Batch Energy: 15.9159 | Batch Loss: 9.1869  | Perplexity: 9768.6403
2025-09-17 10:43:59,698 - INFO -   Batch 760/1827 | Batch Energy: 15.6600 | Batch Loss: 9.0705  | Perplexity: 8695.2969
2025-09-17 10:44:03,655 - INFO -   Batch 770/1827 | Batch Energy: 16.8058 | Batch Loss: 9.2852  | Perplexity: 10777.8643
2025-09-17 10:44:07,607 - INFO -   Batch 780/1827 | Batch Energy: 16.6683 | Batch Loss: 9.3378  | Perplexity: 11359.0329
2025-09-17 10:44:11,689 - INFO -   Batch 790/1827 | Batch Energy: 16.3436 | Batch Loss: 9.6574  | Perplexity: 15637.0178
2025-09-17 10:44:15,857 - INFO -   Batch 800/1827 | Batch Energy: 17.4413 | Batch Loss: 9.8212  | Perplexity: 18420.0958
2025-09-17 10:44:20,299 - INFO -   Batch 810/1827 | Batch Energy: 16.0528 | Batch Loss: 8.8789  | Perplexity: 7179.1399
2025-09-17 10:44:24,564 - INFO -   Batch 820/1827 | Batch Energy: 18.1953 | Batch Loss: 9.3204  | Perplexity: 11162.9806
2025-09-17 10:44:28,507 - INFO -   Batch 830/1827 | Batch Energy: 16.0215 | Batch Loss: 8.5895  | Perplexity: 5374.7997
2025-09-17 10:44:32,582 - INFO -   Batch 840/1827 | Batch Energy: 18.8853 | Batch Loss: 9.0112  | Perplexity: 8194.1294
2025-09-17 10:44:36,578 - INFO -   Batch 850/1827 | Batch Energy: 16.8888 | Batch Loss: 8.8292  | Perplexity: 6830.9228
2025-09-17 10:44:40,599 - INFO -   Batch 860/1827 | Batch Energy: 16.8991 | Batch Loss: 9.4900  | Perplexity: 13226.6031
2025-09-17 10:44:44,876 - INFO -   Batch 870/1827 | Batch Energy: 18.1881 | Batch Loss: 9.7279  | Perplexity: 16779.8794
2025-09-17 10:44:49,145 - INFO -   Batch 880/1827 | Batch Energy: 17.8655 | Batch Loss: 9.5141  | Perplexity: 13549.9124
2025-09-17 10:44:53,171 - INFO -   Batch 890/1827 | Batch Energy: 17.0640 | Batch Loss: 9.9502  | Perplexity: 20957.4542
2025-09-17 10:44:57,029 - INFO -   Batch 900/1827 | Batch Energy: 17.6780 | Batch Loss: 9.1475  | Perplexity: 9391.2564
2025-09-17 10:45:01,006 - INFO -   Batch 910/1827 | Batch Energy: 20.1639 | Batch Loss: 9.3008  | Perplexity: 10946.6827
2025-09-17 10:45:05,187 - INFO -   Batch 920/1827 | Batch Energy: 19.2098 | Batch Loss: 9.5503  | Perplexity: 14048.9975
2025-09-17 10:45:09,318 - INFO -   Batch 930/1827 | Batch Energy: 18.5972 | Batch Loss: 9.0131  | Perplexity: 8210.2040
2025-09-17 10:45:13,892 - INFO -   Batch 940/1827 | Batch Energy: 19.4690 | Batch Loss: 9.2287  | Perplexity: 10185.2500
2025-09-17 10:45:18,114 - INFO -   Batch 950/1827 | Batch Energy: 21.4727 | Batch Loss: 11.0384  | Perplexity: 62218.7164
2025-09-17 10:45:22,161 - INFO -   Batch 960/1827 | Batch Energy: 21.3901 | Batch Loss: 10.3518  | Perplexity: 31312.6085
2025-09-17 10:45:26,269 - INFO -   Batch 970/1827 | Batch Energy: 21.6858 | Batch Loss: 8.7089  | Perplexity: 6056.6429
2025-09-17 10:45:30,116 - INFO -   Batch 980/1827 | Batch Energy: 22.2715 | Batch Loss: 8.9772  | Perplexity: 7920.5789
2025-09-17 10:45:34,259 - INFO -   Batch 990/1827 | Batch Energy: 21.2977 | Batch Loss: 9.0179  | Perplexity: 8249.7221
2025-09-17 10:45:38,203 - INFO -   Batch 1000/1827 | Batch Energy: 22.7228 | Batch Loss: 10.9075  | Perplexity: 54585.1656
2025-09-17 10:45:42,181 - INFO -   Batch 1010/1827 | Batch Energy: 22.8326 | Batch Loss: 9.2593  | Perplexity: 10501.4414
2025-09-17 10:45:46,467 - INFO -   Batch 1020/1827 | Batch Energy: 24.1435 | Batch Loss: 9.2869  | Perplexity: 10796.0110
2025-09-17 10:45:50,611 - INFO -   Batch 1030/1827 | Batch Energy: 24.5318 | Batch Loss: 10.4479  | Perplexity: 34473.5780
2025-09-17 10:45:54,765 - INFO -   Batch 1040/1827 | Batch Energy: 24.1017 | Batch Loss: 9.4915  | Perplexity: 13247.2176
2025-09-17 10:45:58,838 - INFO -   Batch 1050/1827 | Batch Energy: 26.9593 | Batch Loss: 8.5173  | Perplexity: 5000.6802
2025-09-17 10:46:03,099 - INFO -   Batch 1060/1827 | Batch Energy: 25.2415 | Batch Loss: 9.3711  | Perplexity: 11743.9194
2025-09-17 10:46:07,513 - INFO -   Batch 1070/1827 | Batch Energy: 26.4621 | Batch Loss: 8.8815  | Perplexity: 7197.8279
2025-09-17 10:46:11,439 - INFO -   Batch 1080/1827 | Batch Energy: 25.8660 | Batch Loss: 11.2030  | Perplexity: 73346.6701
2025-09-17 10:46:15,690 - INFO -   Batch 1090/1827 | Batch Energy: 27.8037 | Batch Loss: 8.1835  | Perplexity: 3581.2012
2025-09-17 10:46:19,757 - INFO -   Batch 1100/1827 | Batch Energy: 27.0853 | Batch Loss: 9.4013  | Perplexity: 12104.1457
2025-09-17 10:46:24,531 - INFO -   Batch 1110/1827 | Batch Energy: 26.0558 | Batch Loss: 10.2592  | Perplexity: 28543.1825
2025-09-17 10:46:28,758 - INFO -   Batch 1120/1827 | Batch Energy: 27.9877 | Batch Loss: 10.4126  | Perplexity: 33277.2456
2025-09-17 10:46:32,969 - INFO -   Batch 1130/1827 | Batch Energy: 27.2191 | Batch Loss: 8.1251  | Perplexity: 3378.3318
2025-09-17 10:46:37,537 - INFO -   Batch 1140/1827 | Batch Energy: 30.2316 | Batch Loss: 10.1262  | Perplexity: 24990.0757
2025-09-17 10:46:41,532 - INFO -   Batch 1150/1827 | Batch Energy: 29.9324 | Batch Loss: 8.8559  | Perplexity: 7015.6715
2025-09-17 10:46:45,262 - INFO -   Batch 1160/1827 | Batch Energy: 26.6645 | Batch Loss: 9.2750  | Perplexity: 10667.7103
2025-09-17 10:46:49,403 - INFO -   Batch 1170/1827 | Batch Energy: 32.5744 | Batch Loss: 10.5265  | Perplexity: 37291.2878
2025-09-17 10:46:53,505 - INFO -   Batch 1180/1827 | Batch Energy: 31.6821 | Batch Loss: 9.3376  | Perplexity: 11356.5741
2025-09-17 10:46:57,517 - INFO -   Batch 1190/1827 | Batch Energy: 30.9110 | Batch Loss: 10.1062  | Perplexity: 24493.2890
2025-09-17 10:47:01,674 - INFO -   Batch 1200/1827 | Batch Energy: 28.4462 | Batch Loss: 10.1766  | Perplexity: 26281.1975
2025-09-17 10:47:05,730 - INFO -   Batch 1210/1827 | Batch Energy: 30.1784 | Batch Loss: 10.5907  | Perplexity: 39763.8885
2025-09-17 10:47:10,235 - INFO -   Batch 1220/1827 | Batch Energy: 35.0441 | Batch Loss: 9.0578  | Perplexity: 8585.3349
2025-09-17 10:47:14,701 - INFO -   Batch 1230/1827 | Batch Energy: 30.9771 | Batch Loss: 10.2211  | Perplexity: 27477.2373
2025-09-17 10:47:19,269 - INFO -   Batch 1240/1827 | Batch Energy: 31.7651 | Batch Loss: 11.6754  | Perplexity: 117640.6883
2025-09-17 10:47:23,450 - INFO -   Batch 1250/1827 | Batch Energy: 33.2972 | Batch Loss: 9.0026  | Perplexity: 8124.2235
2025-09-17 10:47:27,252 - INFO -   Batch 1260/1827 | Batch Energy: 31.9280 | Batch Loss: 9.0631  | Perplexity: 8630.7073
2025-09-17 10:47:31,407 - INFO -   Batch 1270/1827 | Batch Energy: 35.5603 | Batch Loss: 10.1166  | Perplexity: 24751.0670
2025-09-17 10:47:35,650 - INFO -   Batch 1280/1827 | Batch Energy: 33.8932 | Batch Loss: 9.6930  | Perplexity: 16203.6875
2025-09-17 10:47:39,755 - INFO -   Batch 1290/1827 | Batch Energy: 37.9702 | Batch Loss: 10.9769  | Perplexity: 58507.5211
2025-09-17 10:47:44,115 - INFO -   Batch 1300/1827 | Batch Energy: 38.0331 | Batch Loss: 9.3329  | Perplexity: 11303.3699
2025-09-17 10:47:48,313 - INFO -   Batch 1310/1827 | Batch Energy: 36.3655 | Batch Loss: 8.8316  | Perplexity: 6847.5614
2025-09-17 10:47:52,652 - INFO -   Batch 1320/1827 | Batch Energy: 39.4747 | Batch Loss: 9.3625  | Perplexity: 11643.3298
2025-09-17 10:47:56,598 - INFO -   Batch 1330/1827 | Batch Energy: 38.1145 | Batch Loss: 10.4002  | Perplexity: 32867.3544
2025-09-17 10:48:00,681 - INFO -   Batch 1340/1827 | Batch Energy: 38.0853 | Batch Loss: 8.6550  | Perplexity: 5738.9864
2025-09-17 10:48:05,866 - INFO -   Batch 1350/1827 | Batch Energy: 42.9072 | Batch Loss: 10.5856  | Perplexity: 39562.6554
2025-09-17 10:48:10,643 - INFO -   Batch 1360/1827 | Batch Energy: 40.5216 | Batch Loss: 9.4049  | Perplexity: 12148.3451
2025-09-17 10:48:16,766 - INFO -   Batch 1370/1827 | Batch Energy: 41.1391 | Batch Loss: 8.4200  | Perplexity: 4536.9860
2025-09-17 10:48:21,390 - INFO -   Batch 1380/1827 | Batch Energy: 42.2189 | Batch Loss: 9.1966  | Perplexity: 9864.0153
2025-09-17 10:48:25,966 - INFO -   Batch 1390/1827 | Batch Energy: 40.3298 | Batch Loss: 9.5126  | Perplexity: 13528.8527
2025-09-17 10:48:30,364 - INFO -   Batch 1400/1827 | Batch Energy: 43.7733 | Batch Loss: 9.3235  | Perplexity: 11198.2847
2025-09-17 10:48:35,475 - INFO -   Batch 1410/1827 | Batch Energy: 44.3145 | Batch Loss: 9.3959  | Perplexity: 12038.9286
2025-09-17 10:48:39,675 - INFO -   Batch 1420/1827 | Batch Energy: 43.7059 | Batch Loss: 9.4584  | Perplexity: 12815.2017
2025-09-17 10:48:43,978 - INFO -   Batch 1430/1827 | Batch Energy: 40.9750 | Batch Loss: 9.7381  | Perplexity: 16951.2233
2025-09-17 10:48:48,194 - INFO -   Batch 1440/1827 | Batch Energy: 44.2134 | Batch Loss: 10.3102  | Perplexity: 30036.8054
2025-09-17 10:48:52,057 - INFO -   Batch 1450/1827 | Batch Energy: 47.1146 | Batch Loss: 9.2252  | Perplexity: 10150.0319
2025-09-17 10:48:56,090 - INFO -   Batch 1460/1827 | Batch Energy: 46.0301 | Batch Loss: 10.1904  | Perplexity: 26646.1291
2025-09-17 10:49:00,105 - INFO -   Batch 1470/1827 | Batch Energy: 47.4680 | Batch Loss: 10.4204  | Perplexity: 33537.9224
2025-09-17 10:49:04,351 - INFO -   Batch 1480/1827 | Batch Energy: 48.1014 | Batch Loss: 9.3545  | Perplexity: 11550.2530
2025-09-17 10:49:08,270 - INFO -   Batch 1490/1827 | Batch Energy: 46.6207 | Batch Loss: 10.8382  | Perplexity: 50928.4369
2025-09-17 10:49:12,202 - INFO -   Batch 1500/1827 | Batch Energy: 51.1244 | Batch Loss: 10.9941  | Perplexity: 59523.7180
2025-09-17 10:49:16,435 - INFO -   Batch 1510/1827 | Batch Energy: 49.3853 | Batch Loss: 10.1206  | Perplexity: 24848.6746
2025-09-17 10:49:20,693 - INFO -   Batch 1520/1827 | Batch Energy: 55.8211 | Batch Loss: 9.4034  | Perplexity: 12129.2208
2025-09-17 10:49:25,129 - INFO -   Batch 1530/1827 | Batch Energy: 48.7493 | Batch Loss: 9.5058  | Perplexity: 13438.0825
2025-09-17 10:49:29,480 - INFO -   Batch 1540/1827 | Batch Energy: 52.4015 | Batch Loss: 10.2458  | Perplexity: 28164.6226
2025-09-17 10:49:33,540 - INFO -   Batch 1550/1827 | Batch Energy: 53.6646 | Batch Loss: 9.0913  | Perplexity: 8877.4149
2025-09-17 10:49:37,556 - INFO -   Batch 1560/1827 | Batch Energy: 55.1722 | Batch Loss: 9.2261  | Perplexity: 10158.5731
2025-09-17 10:49:41,795 - INFO -   Batch 1570/1827 | Batch Energy: 60.5573 | Batch Loss: 10.5458  | Perplexity: 38016.4946
2025-09-17 10:49:45,910 - INFO -   Batch 1580/1827 | Batch Energy: 56.4625 | Batch Loss: 9.0923  | Perplexity: 8886.2834
2025-09-17 10:49:50,267 - INFO -   Batch 1590/1827 | Batch Energy: 56.4479 | Batch Loss: 10.2727  | Perplexity: 28930.4998
2025-09-17 10:49:54,671 - INFO -   Batch 1600/1827 | Batch Energy: 60.1141 | Batch Loss: 9.2940  | Perplexity: 10872.5529
2025-09-17 10:49:58,700 - INFO -   Batch 1610/1827 | Batch Energy: 58.8894 | Batch Loss: 11.7878  | Perplexity: 131636.1524
2025-09-17 10:50:02,805 - INFO -   Batch 1620/1827 | Batch Energy: 56.1976 | Batch Loss: 10.8967  | Perplexity: 53998.6438
2025-09-17 10:50:06,957 - INFO -   Batch 1630/1827 | Batch Energy: 61.3167 | Batch Loss: 9.1856  | Perplexity: 9755.2715
2025-09-17 10:50:11,062 - INFO -   Batch 1640/1827 | Batch Energy: 62.1528 | Batch Loss: 11.0176  | Perplexity: 60939.9896
2025-09-17 10:50:15,274 - INFO -   Batch 1650/1827 | Batch Energy: 63.8945 | Batch Loss: 9.3996  | Perplexity: 12083.1779
2025-09-17 10:50:19,393 - INFO -   Batch 1660/1827 | Batch Energy: 61.1766 | Batch Loss: 10.1939  | Perplexity: 26740.1146
2025-09-17 10:50:23,510 - INFO -   Batch 1670/1827 | Batch Energy: 65.0621 | Batch Loss: 10.2644  | Perplexity: 28693.9201
2025-09-17 10:50:27,566 - INFO -   Batch 1680/1827 | Batch Energy: 66.2758 | Batch Loss: 9.8824  | Perplexity: 19583.4778
2025-09-17 10:50:31,606 - INFO -   Batch 1690/1827 | Batch Energy: 61.0987 | Batch Loss: 10.1826  | Perplexity: 26439.1959
2025-09-17 10:50:35,958 - INFO -   Batch 1700/1827 | Batch Energy: 73.5891 | Batch Loss: 10.0343  | Perplexity: 22795.0548
2025-09-17 10:50:45,719 - INFO -   Batch 1710/1827 | Batch Energy: 72.1531 | Batch Loss: 10.6478  | Perplexity: 42100.7348
2025-09-17 10:50:50,763 - INFO -   Batch 1720/1827 | Batch Energy: 72.1165 | Batch Loss: 9.9561  | Perplexity: 21079.9488
2025-09-17 10:50:55,861 - INFO -   Batch 1730/1827 | Batch Energy: 72.0768 | Batch Loss: 10.7728  | Perplexity: 47703.4708
2025-09-17 10:51:01,165 - INFO -   Batch 1740/1827 | Batch Energy: 69.2387 | Batch Loss: 9.1759  | Perplexity: 9661.4455
2025-09-17 10:51:06,149 - INFO -   Batch 1750/1827 | Batch Energy: 71.3849 | Batch Loss: 11.5982  | Perplexity: 108906.8797
2025-09-17 10:51:10,925 - INFO -   Batch 1760/1827 | Batch Energy: 80.1269 | Batch Loss: 9.8987  | Perplexity: 19904.5300
2025-09-17 10:51:16,174 - INFO -   Batch 1770/1827 | Batch Energy: 72.9069 | Batch Loss: 10.0641  | Perplexity: 23485.4982
2025-09-17 10:51:21,018 - INFO -   Batch 1780/1827 | Batch Energy: 77.1639 | Batch Loss: 9.9991  | Perplexity: 22007.2746
2025-09-17 10:51:26,587 - INFO -   Batch 1790/1827 | Batch Energy: 74.7862 | Batch Loss: 9.3517  | Perplexity: 11518.2323
2025-09-17 10:51:31,084 - INFO -   Batch 1800/1827 | Batch Energy: 73.8707 | Batch Loss: 10.8310  | Perplexity: 50563.7801
2025-09-17 10:51:35,066 - INFO -   Batch 1810/1827 | Batch Energy: 83.8297 | Batch Loss: 10.8476  | Perplexity: 51412.2348
2025-09-17 10:51:39,253 - INFO -   Batch 1820/1827 | Batch Energy: 75.0462 | Batch Loss: 9.3417  | Perplexity: 11403.8171
2025-09-17 10:52:23,449 - INFO - Epoch 2/2 | Train Energy: 27.1183 | Train Perplexity: 13104.4551 | Val Energy: 82.2881 | Val Perplexity: 36330.2358
2025-09-17 10:52:23,567 - INFO - Saved checkpoint to checkpoints/model_epoch_2.pt
2025-09-17 10:52:24,300 - INFO - Training completed in 1651.20 seconds
2025-09-17 10:52:24,300 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 10:52:24,300 - INFO - ========== Training completed ==========
2025-09-17 11:50:39,383 - INFO - 
########################################################################################################################
2025-09-17 11:50:39,383 - INFO - Using device: cpu (local rank 0)
2025-09-17 11:50:39,383 - INFO - Saving the hyperparameters configurations:
2025-09-17 11:50:39,383 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 6,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 11:50:39,633 - INFO - ========== Training started ==========
2025-09-17 11:50:39,634 - INFO - 1.27 M parameters
2025-09-17 11:50:39,634 - INFO - Epoch 1/1
2025-09-17 11:50:43,657 - INFO -   Batch 10/1827 | Batch Energy: 1.8084 | Batch Loss: 9.5975  | Perplexity: 14727.4078
2025-09-17 11:50:47,533 - INFO -   Batch 20/1827 | Batch Energy: 1.8000 | Batch Loss: 9.0719  | Perplexity: 8707.4455
2025-09-17 11:50:51,741 - INFO -   Batch 30/1827 | Batch Energy: 1.8044 | Batch Loss: 8.7819  | Perplexity: 6515.2719
2025-09-17 11:50:55,523 - INFO -   Batch 40/1827 | Batch Energy: 1.8338 | Batch Loss: 9.0654  | Perplexity: 8650.7728
2025-09-17 11:50:59,263 - INFO -   Batch 50/1827 | Batch Energy: 1.8154 | Batch Loss: 9.0353  | Perplexity: 8394.1214
2025-09-17 11:51:03,172 - INFO -   Batch 60/1827 | Batch Energy: 1.8121 | Batch Loss: 8.4136  | Perplexity: 4508.0157
2025-09-17 11:51:07,124 - INFO -   Batch 70/1827 | Batch Energy: 1.8014 | Batch Loss: 8.6630  | Perplexity: 5784.8583
2025-09-17 11:51:11,142 - INFO -   Batch 80/1827 | Batch Energy: 1.8209 | Batch Loss: 8.2146  | Perplexity: 3694.5354
2025-09-17 11:51:15,227 - INFO -   Batch 90/1827 | Batch Energy: 1.8007 | Batch Loss: 8.7084  | Perplexity: 6053.5650
2025-09-17 11:51:19,420 - INFO -   Batch 100/1827 | Batch Energy: 1.8410 | Batch Loss: 8.1412  | Perplexity: 3433.1040
2025-09-17 11:51:23,408 - INFO -   Batch 110/1827 | Batch Energy: 1.8136 | Batch Loss: 8.5357  | Perplexity: 5093.4822
2025-09-17 11:51:27,406 - INFO -   Batch 120/1827 | Batch Energy: 1.8037 | Batch Loss: 8.0014  | Perplexity: 2985.2225
2025-09-17 11:51:31,292 - INFO -   Batch 130/1827 | Batch Energy: 1.8546 | Batch Loss: 8.6454  | Perplexity: 5683.6913
2025-09-17 11:51:35,251 - INFO -   Batch 140/1827 | Batch Energy: 1.8364 | Batch Loss: 8.0657  | Perplexity: 3183.4310
2025-09-17 11:51:39,124 - INFO -   Batch 150/1827 | Batch Energy: 1.8308 | Batch Loss: 7.6774  | Perplexity: 2158.9715
2025-09-17 11:51:42,967 - INFO -   Batch 160/1827 | Batch Energy: 1.7994 | Batch Loss: 8.0781  | Perplexity: 3223.0796
2025-09-17 11:51:46,877 - INFO -   Batch 170/1827 | Batch Energy: 1.8371 | Batch Loss: 8.5167  | Perplexity: 4997.5288
2025-09-17 11:51:50,678 - INFO -   Batch 180/1827 | Batch Energy: 1.8449 | Batch Loss: 8.1788  | Perplexity: 3564.5461
2025-09-17 11:51:54,624 - INFO -   Batch 190/1827 | Batch Energy: 1.8595 | Batch Loss: 8.1014  | Perplexity: 3298.9873
2025-09-17 11:51:58,387 - INFO -   Batch 200/1827 | Batch Energy: 1.8937 | Batch Loss: 7.6856  | Perplexity: 2176.7119
2025-09-17 11:52:02,096 - INFO -   Batch 210/1827 | Batch Energy: 1.8466 | Batch Loss: 8.1993  | Perplexity: 3638.2839
2025-09-17 11:52:06,178 - INFO -   Batch 220/1827 | Batch Energy: 1.8542 | Batch Loss: 8.1220  | Perplexity: 3367.7262
2025-09-17 11:52:09,974 - INFO -   Batch 230/1827 | Batch Energy: 1.8616 | Batch Loss: 8.3356  | Perplexity: 4169.5551
2025-09-17 11:52:13,659 - INFO -   Batch 240/1827 | Batch Energy: 1.8406 | Batch Loss: 8.1702  | Perplexity: 3534.0620
2025-09-17 11:52:17,384 - INFO -   Batch 250/1827 | Batch Energy: 1.8385 | Batch Loss: 7.9759  | Perplexity: 2909.9096
2025-09-17 11:52:21,111 - INFO -   Batch 260/1827 | Batch Energy: 1.8416 | Batch Loss: 8.0742  | Perplexity: 3210.5048
2025-09-17 11:52:24,951 - INFO -   Batch 270/1827 | Batch Energy: 1.8573 | Batch Loss: 7.6000  | Perplexity: 1998.2567
2025-09-17 11:52:28,823 - INFO -   Batch 280/1827 | Batch Energy: 1.8463 | Batch Loss: 7.5654  | Perplexity: 1930.1903
2025-09-17 11:52:32,796 - INFO -   Batch 290/1827 | Batch Energy: 1.8426 | Batch Loss: 7.9540  | Perplexity: 2847.0146
2025-09-17 11:52:36,732 - INFO -   Batch 300/1827 | Batch Energy: 1.8586 | Batch Loss: 7.8772  | Perplexity: 2636.3735
2025-09-17 11:52:40,449 - INFO -   Batch 310/1827 | Batch Energy: 1.8262 | Batch Loss: 7.8145  | Perplexity: 2476.3580
2025-09-17 11:52:44,300 - INFO -   Batch 320/1827 | Batch Energy: 1.8606 | Batch Loss: 7.9604  | Perplexity: 2865.2013
2025-09-17 11:52:48,119 - INFO -   Batch 330/1827 | Batch Energy: 1.8942 | Batch Loss: 7.7513  | Perplexity: 2324.4768
2025-09-17 11:52:52,146 - INFO -   Batch 340/1827 | Batch Energy: 1.8660 | Batch Loss: 8.0014  | Perplexity: 2985.1855
2025-09-17 11:52:56,221 - INFO -   Batch 350/1827 | Batch Energy: 1.8576 | Batch Loss: 7.9766  | Perplexity: 2911.8986
2025-09-17 11:53:00,284 - INFO -   Batch 360/1827 | Batch Energy: 1.8769 | Batch Loss: 7.7299  | Perplexity: 2275.3527
2025-09-17 11:53:04,272 - INFO -   Batch 370/1827 | Batch Energy: 1.8298 | Batch Loss: 8.0970  | Perplexity: 3284.7408
2025-09-17 11:53:08,084 - INFO -   Batch 380/1827 | Batch Energy: 1.8828 | Batch Loss: 8.1402  | Perplexity: 3429.5764
2025-09-17 11:53:12,071 - INFO -   Batch 390/1827 | Batch Energy: 1.8735 | Batch Loss: 7.5662  | Perplexity: 1931.7308
2025-09-17 11:53:16,120 - INFO -   Batch 400/1827 | Batch Energy: 1.9030 | Batch Loss: 7.7145  | Perplexity: 2240.4911
2025-09-17 11:53:20,467 - INFO -   Batch 410/1827 | Batch Energy: 1.8510 | Batch Loss: 7.3629  | Perplexity: 1576.3470
2025-09-17 11:53:24,580 - INFO -   Batch 420/1827 | Batch Energy: 1.8570 | Batch Loss: 8.1735  | Perplexity: 3545.7630
2025-09-17 11:53:31,810 - INFO -   Batch 430/1827 | Batch Energy: 1.9093 | Batch Loss: 8.2990  | Perplexity: 4019.9992
2025-09-17 11:53:36,720 - INFO -   Batch 440/1827 | Batch Energy: 1.8833 | Batch Loss: 8.2378  | Perplexity: 3781.1282
2025-09-17 11:53:40,916 - INFO -   Batch 450/1827 | Batch Energy: 1.8748 | Batch Loss: 7.7356  | Perplexity: 2288.3497
2025-09-17 11:53:46,768 - INFO -   Batch 460/1827 | Batch Energy: 1.8825 | Batch Loss: 8.1087  | Perplexity: 3323.2480
2025-09-17 11:53:53,140 - INFO -   Batch 470/1827 | Batch Energy: 1.8332 | Batch Loss: 8.5162  | Perplexity: 4995.2464
2025-09-17 11:53:57,415 - INFO -   Batch 480/1827 | Batch Energy: 1.8827 | Batch Loss: 7.8941  | Perplexity: 2681.2904
2025-09-17 11:54:01,573 - INFO -   Batch 490/1827 | Batch Energy: 1.8710 | Batch Loss: 7.5969  | Perplexity: 1992.0206
2025-09-17 11:54:05,615 - INFO -   Batch 500/1827 | Batch Energy: 1.9213 | Batch Loss: 8.2611  | Perplexity: 3870.5256
2025-09-17 11:54:09,619 - INFO -   Batch 510/1827 | Batch Energy: 1.8752 | Batch Loss: 8.2590  | Perplexity: 3862.1335
2025-09-17 11:54:13,461 - INFO -   Batch 520/1827 | Batch Energy: 1.9042 | Batch Loss: 8.7956  | Perplexity: 6604.9596
2025-09-17 11:54:17,672 - INFO -   Batch 530/1827 | Batch Energy: 1.8979 | Batch Loss: 8.1706  | Perplexity: 3535.4576
2025-09-17 11:54:22,815 - INFO -   Batch 540/1827 | Batch Energy: 1.9252 | Batch Loss: 8.2425  | Perplexity: 3798.9293
2025-09-17 11:54:26,913 - INFO -   Batch 550/1827 | Batch Energy: 1.8934 | Batch Loss: 7.2526  | Perplexity: 1411.7945
2025-09-17 11:54:30,808 - INFO -   Batch 560/1827 | Batch Energy: 1.9732 | Batch Loss: 7.7793  | Perplexity: 2390.6150
2025-09-17 11:54:34,835 - INFO -   Batch 570/1827 | Batch Energy: 1.9160 | Batch Loss: 7.5793  | Perplexity: 1957.2452
2025-09-17 11:54:38,905 - INFO -   Batch 580/1827 | Batch Energy: 1.9627 | Batch Loss: 7.7731  | Perplexity: 2375.9142
2025-09-17 11:54:42,780 - INFO -   Batch 590/1827 | Batch Energy: 1.9374 | Batch Loss: 7.2775  | Perplexity: 1447.3018
2025-09-17 11:54:46,911 - INFO -   Batch 600/1827 | Batch Energy: 1.9559 | Batch Loss: 7.4905  | Perplexity: 1790.9610
2025-09-17 11:54:51,121 - INFO -   Batch 610/1827 | Batch Energy: 1.9474 | Batch Loss: 7.9273  | Perplexity: 2771.8121
2025-09-17 11:54:55,173 - INFO -   Batch 620/1827 | Batch Energy: 1.9327 | Batch Loss: 7.1849  | Perplexity: 1319.3879
2025-09-17 11:54:59,069 - INFO -   Batch 630/1827 | Batch Energy: 1.9260 | Batch Loss: 8.3894  | Perplexity: 4400.0069
2025-09-17 11:55:03,269 - INFO -   Batch 640/1827 | Batch Energy: 1.8963 | Batch Loss: 7.9301  | Perplexity: 2779.7219
2025-09-17 11:55:07,561 - INFO -   Batch 650/1827 | Batch Energy: 1.9390 | Batch Loss: 7.8797  | Perplexity: 2643.1418
2025-09-17 11:55:11,728 - INFO -   Batch 660/1827 | Batch Energy: 1.9523 | Batch Loss: 7.8392  | Perplexity: 2538.1300
2025-09-17 11:55:15,686 - INFO -   Batch 670/1827 | Batch Energy: 1.9361 | Batch Loss: 7.5156  | Perplexity: 1836.4160
2025-09-17 11:55:20,162 - INFO -   Batch 680/1827 | Batch Energy: 1.9303 | Batch Loss: 7.5718  | Perplexity: 1942.5371
2025-09-17 11:55:24,293 - INFO -   Batch 690/1827 | Batch Energy: 1.9353 | Batch Loss: 7.3998  | Perplexity: 1635.6780
2025-09-17 11:55:28,092 - INFO -   Batch 700/1827 | Batch Energy: 1.9301 | Batch Loss: 8.3010  | Perplexity: 4027.9775
2025-09-17 11:55:31,962 - INFO -   Batch 710/1827 | Batch Energy: 1.9592 | Batch Loss: 7.1260  | Perplexity: 1243.8522
2025-09-17 11:55:35,746 - INFO -   Batch 720/1827 | Batch Energy: 1.9546 | Batch Loss: 7.5702  | Perplexity: 1939.4948
2025-09-17 11:55:39,609 - INFO -   Batch 730/1827 | Batch Energy: 1.9865 | Batch Loss: 7.6582  | Perplexity: 2117.8584
2025-09-17 11:55:43,869 - INFO -   Batch 740/1827 | Batch Energy: 2.0253 | Batch Loss: 7.6765  | Perplexity: 2156.9722
2025-09-17 11:55:47,893 - INFO -   Batch 750/1827 | Batch Energy: 2.0030 | Batch Loss: 7.6169  | Perplexity: 2032.2135
2025-09-17 11:55:51,887 - INFO -   Batch 760/1827 | Batch Energy: 2.0271 | Batch Loss: 8.4596  | Perplexity: 4720.0051
2025-09-17 11:55:55,825 - INFO -   Batch 770/1827 | Batch Energy: 2.0182 | Batch Loss: 8.3293  | Perplexity: 4143.6146
2025-09-17 11:55:59,937 - INFO -   Batch 780/1827 | Batch Energy: 2.0022 | Batch Loss: 7.8858  | Perplexity: 2659.3235
2025-09-17 11:56:03,761 - INFO -   Batch 790/1827 | Batch Energy: 2.0028 | Batch Loss: 7.6503  | Perplexity: 2101.2870
2025-09-17 11:56:08,175 - INFO -   Batch 800/1827 | Batch Energy: 2.0428 | Batch Loss: 8.0068  | Perplexity: 3001.4283
2025-09-17 11:56:11,826 - INFO -   Batch 810/1827 | Batch Energy: 2.0144 | Batch Loss: 7.6591  | Perplexity: 2119.7983
2025-09-17 11:56:15,844 - INFO -   Batch 820/1827 | Batch Energy: 2.0855 | Batch Loss: 7.9578  | Perplexity: 2857.8073
2025-09-17 11:56:19,943 - INFO -   Batch 830/1827 | Batch Energy: 2.0636 | Batch Loss: 8.1752  | Perplexity: 3551.7736
2025-09-17 11:56:23,934 - INFO -   Batch 840/1827 | Batch Energy: 2.0508 | Batch Loss: 8.5538  | Perplexity: 5186.5818
2025-09-17 11:56:27,945 - INFO -   Batch 850/1827 | Batch Energy: 2.0645 | Batch Loss: 8.9684  | Perplexity: 7851.1048
2025-09-17 11:56:31,899 - INFO -   Batch 860/1827 | Batch Energy: 2.0814 | Batch Loss: 8.0355  | Perplexity: 3088.7404
2025-09-17 11:56:35,982 - INFO -   Batch 870/1827 | Batch Energy: 2.0954 | Batch Loss: 7.8622  | Perplexity: 2597.1519
2025-09-17 11:56:39,978 - INFO -   Batch 880/1827 | Batch Energy: 2.1178 | Batch Loss: 8.5253  | Perplexity: 5040.4586
2025-09-17 11:56:43,878 - INFO -   Batch 890/1827 | Batch Energy: 2.1011 | Batch Loss: 7.9440  | Perplexity: 2818.7139
2025-09-17 11:56:48,287 - INFO -   Batch 900/1827 | Batch Energy: 2.2028 | Batch Loss: 7.5515  | Perplexity: 1903.6728
2025-09-17 11:56:52,628 - INFO -   Batch 910/1827 | Batch Energy: 2.1150 | Batch Loss: 8.3322  | Perplexity: 4155.7402
2025-09-17 11:56:56,783 - INFO -   Batch 920/1827 | Batch Energy: 2.1481 | Batch Loss: 8.1839  | Perplexity: 3582.9059
2025-09-17 11:57:00,683 - INFO -   Batch 930/1827 | Batch Energy: 2.1661 | Batch Loss: 7.9393  | Perplexity: 2805.5179
2025-09-17 11:57:04,873 - INFO -   Batch 940/1827 | Batch Energy: 2.2331 | Batch Loss: 7.0044  | Perplexity: 1101.4792
2025-09-17 11:57:10,322 - INFO -   Batch 950/1827 | Batch Energy: 2.2083 | Batch Loss: 7.9314  | Perplexity: 2783.3308
2025-09-17 11:57:15,348 - INFO -   Batch 960/1827 | Batch Energy: 2.2151 | Batch Loss: 8.3511  | Perplexity: 4235.0100
2025-09-17 11:57:20,258 - INFO -   Batch 970/1827 | Batch Energy: 2.2607 | Batch Loss: 8.4937  | Perplexity: 4883.8427
2025-09-17 11:57:25,623 - INFO -   Batch 980/1827 | Batch Energy: 2.2739 | Batch Loss: 7.6960  | Perplexity: 2199.4737
2025-09-17 11:57:30,618 - INFO -   Batch 990/1827 | Batch Energy: 2.2942 | Batch Loss: 8.1464  | Perplexity: 3451.0830
2025-09-17 11:57:35,290 - INFO -   Batch 1000/1827 | Batch Energy: 2.2440 | Batch Loss: 6.7808  | Perplexity: 880.7549
2025-09-17 11:57:40,073 - INFO -   Batch 1010/1827 | Batch Energy: 2.3217 | Batch Loss: 8.1392  | Perplexity: 3426.0687
2025-09-17 11:57:43,976 - INFO -   Batch 1020/1827 | Batch Energy: 2.3869 | Batch Loss: 7.6776  | Perplexity: 2159.4214
2025-09-17 11:57:47,978 - INFO -   Batch 1030/1827 | Batch Energy: 2.3894 | Batch Loss: 8.0596  | Perplexity: 3163.9515
2025-09-17 11:57:52,037 - INFO -   Batch 1040/1827 | Batch Energy: 2.3888 | Batch Loss: 8.1001  | Perplexity: 3294.7898
2025-09-17 11:57:56,613 - INFO -   Batch 1050/1827 | Batch Energy: 2.3916 | Batch Loss: 7.8456  | Perplexity: 2554.5445
2025-09-17 11:58:00,954 - INFO -   Batch 1060/1827 | Batch Energy: 2.4383 | Batch Loss: 8.0669  | Perplexity: 3187.1918
2025-09-17 11:58:05,099 - INFO -   Batch 1070/1827 | Batch Energy: 2.4549 | Batch Loss: 8.8429  | Perplexity: 6924.8037
2025-09-17 11:58:09,447 - INFO -   Batch 1080/1827 | Batch Energy: 2.5491 | Batch Loss: 8.3740  | Perplexity: 4332.7868
2025-09-17 11:58:13,230 - INFO -   Batch 1090/1827 | Batch Energy: 2.4630 | Batch Loss: 7.7201  | Perplexity: 2253.1998
2025-09-17 11:58:17,155 - INFO -   Batch 1100/1827 | Batch Energy: 2.4292 | Batch Loss: 8.0064  | Perplexity: 2999.9574
2025-09-17 11:58:22,188 - INFO -   Batch 1110/1827 | Batch Energy: 2.3776 | Batch Loss: 8.1096  | Perplexity: 3326.3585
2025-09-17 11:58:26,944 - INFO -   Batch 1120/1827 | Batch Energy: 2.4303 | Batch Loss: 8.0371  | Perplexity: 3093.5986
2025-09-17 11:58:31,441 - INFO -   Batch 1130/1827 | Batch Energy: 2.4708 | Batch Loss: 8.6795  | Perplexity: 5881.0975
2025-09-17 11:58:35,595 - INFO -   Batch 1140/1827 | Batch Energy: 2.4942 | Batch Loss: 8.0356  | Perplexity: 3089.1233
2025-09-17 11:58:39,308 - INFO -   Batch 1150/1827 | Batch Energy: 2.5512 | Batch Loss: 8.8248  | Perplexity: 6800.7105
2025-09-17 11:58:43,495 - INFO -   Batch 1160/1827 | Batch Energy: 2.5107 | Batch Loss: 7.9585  | Perplexity: 2859.6584
2025-09-17 11:58:47,502 - INFO -   Batch 1170/1827 | Batch Energy: 2.6162 | Batch Loss: 9.0782  | Perplexity: 8762.1411
2025-09-17 11:58:51,652 - INFO -   Batch 1180/1827 | Batch Energy: 2.5875 | Batch Loss: 7.3694  | Perplexity: 1586.6240
2025-09-17 11:58:56,636 - INFO -   Batch 1190/1827 | Batch Energy: 2.5865 | Batch Loss: 7.8479  | Perplexity: 2560.3371
2025-09-17 11:59:00,851 - INFO -   Batch 1200/1827 | Batch Energy: 2.6411 | Batch Loss: 8.7616  | Perplexity: 6384.3215
2025-09-17 11:59:04,728 - INFO -   Batch 1210/1827 | Batch Energy: 2.6927 | Batch Loss: 8.3949  | Perplexity: 4424.6357
2025-09-17 11:59:08,570 - INFO -   Batch 1220/1827 | Batch Energy: 2.7239 | Batch Loss: 8.2226  | Perplexity: 3724.3537
2025-09-17 11:59:12,530 - INFO -   Batch 1230/1827 | Batch Energy: 2.7780 | Batch Loss: 8.2858  | Perplexity: 3967.0614
2025-09-17 11:59:16,756 - INFO -   Batch 1240/1827 | Batch Energy: 2.9058 | Batch Loss: 9.0686  | Perplexity: 8678.3056
2025-09-17 11:59:20,652 - INFO -   Batch 1250/1827 | Batch Energy: 2.9246 | Batch Loss: 8.3887  | Perplexity: 4396.9573
2025-09-17 11:59:24,929 - INFO -   Batch 1260/1827 | Batch Energy: 2.9593 | Batch Loss: 8.3376  | Perplexity: 4177.8780
2025-09-17 11:59:29,132 - INFO -   Batch 1270/1827 | Batch Energy: 2.8881 | Batch Loss: 7.5772  | Perplexity: 1953.0825
2025-09-17 11:59:33,304 - INFO -   Batch 1280/1827 | Batch Energy: 3.1351 | Batch Loss: 9.1090  | Perplexity: 9036.4111
2025-09-17 11:59:37,613 - INFO -   Batch 1290/1827 | Batch Energy: 3.2244 | Batch Loss: 8.4179  | Perplexity: 4527.4986
2025-09-17 11:59:41,973 - INFO -   Batch 1300/1827 | Batch Energy: 3.0714 | Batch Loss: 7.8646  | Perplexity: 2603.5339
2025-09-17 11:59:46,134 - INFO -   Batch 1310/1827 | Batch Energy: 3.1960 | Batch Loss: 8.2254  | Perplexity: 3734.6433
2025-09-17 11:59:50,999 - INFO -   Batch 1320/1827 | Batch Energy: 3.2612 | Batch Loss: 8.4446  | Perplexity: 4649.9092
2025-09-17 11:59:55,380 - INFO -   Batch 1330/1827 | Batch Energy: 3.2644 | Batch Loss: 7.9862  | Perplexity: 2940.1716
2025-09-17 11:59:59,685 - INFO -   Batch 1340/1827 | Batch Energy: 3.2475 | Batch Loss: 8.4448  | Perplexity: 4650.8361
2025-09-17 12:00:03,813 - INFO -   Batch 1350/1827 | Batch Energy: 3.4064 | Batch Loss: 8.1705  | Perplexity: 3534.9755
2025-09-17 12:00:07,966 - INFO -   Batch 1360/1827 | Batch Energy: 3.5105 | Batch Loss: 8.1370  | Perplexity: 3418.7642
2025-09-17 12:00:12,193 - INFO -   Batch 1370/1827 | Batch Energy: 3.3217 | Batch Loss: 8.1605  | Perplexity: 3500.0448
2025-09-17 12:00:16,611 - INFO -   Batch 1380/1827 | Batch Energy: 3.3157 | Batch Loss: 9.3753  | Perplexity: 11793.2349
2025-09-17 12:00:20,562 - INFO -   Batch 1390/1827 | Batch Energy: 3.3030 | Batch Loss: 7.9548  | Perplexity: 2849.3533
2025-09-17 12:00:24,578 - INFO -   Batch 1400/1827 | Batch Energy: 3.4613 | Batch Loss: 8.3126  | Perplexity: 4074.7119
2025-09-17 12:00:28,414 - INFO -   Batch 1410/1827 | Batch Energy: 3.5009 | Batch Loss: 6.5397  | Perplexity: 692.0575
2025-09-17 12:00:32,603 - INFO -   Batch 1420/1827 | Batch Energy: 3.6469 | Batch Loss: 8.3841  | Perplexity: 4376.8339
2025-09-17 12:00:36,724 - INFO -   Batch 1430/1827 | Batch Energy: 3.7492 | Batch Loss: 8.0142  | Perplexity: 3023.5441
2025-09-17 12:00:40,794 - INFO -   Batch 1440/1827 | Batch Energy: 3.7475 | Batch Loss: 8.4862  | Perplexity: 4847.3570
2025-09-17 12:00:44,870 - INFO -   Batch 1450/1827 | Batch Energy: 3.7191 | Batch Loss: 8.5608  | Perplexity: 5222.6116
2025-09-17 12:00:48,826 - INFO -   Batch 1460/1827 | Batch Energy: 3.9716 | Batch Loss: 8.4133  | Perplexity: 4506.8293
2025-09-17 12:00:52,688 - INFO -   Batch 1470/1827 | Batch Energy: 4.1451 | Batch Loss: 7.7651  | Perplexity: 2356.9020
2025-09-17 12:00:56,656 - INFO -   Batch 1480/1827 | Batch Energy: 4.1110 | Batch Loss: 8.2927  | Perplexity: 3994.5015
2025-09-17 12:01:00,858 - INFO -   Batch 1490/1827 | Batch Energy: 4.3209 | Batch Loss: 8.9166  | Perplexity: 7454.3535
2025-09-17 12:01:04,958 - INFO -   Batch 1500/1827 | Batch Energy: 4.2789 | Batch Loss: 7.8226  | Perplexity: 2496.4540
2025-09-17 12:01:09,002 - INFO -   Batch 1510/1827 | Batch Energy: 4.3085 | Batch Loss: 7.6746  | Perplexity: 2152.9493
2025-09-17 12:01:13,187 - INFO -   Batch 1520/1827 | Batch Energy: 4.1535 | Batch Loss: 7.6212  | Perplexity: 2041.0558
2025-09-17 12:01:18,204 - INFO -   Batch 1530/1827 | Batch Energy: 4.0987 | Batch Loss: 8.1142  | Perplexity: 3341.5056
2025-09-17 12:01:22,409 - INFO -   Batch 1540/1827 | Batch Energy: 4.3218 | Batch Loss: 8.2736  | Perplexity: 3918.8513
2025-09-17 12:01:26,290 - INFO -   Batch 1550/1827 | Batch Energy: 4.4768 | Batch Loss: 8.6457  | Perplexity: 5685.4369
2025-09-17 12:01:30,815 - INFO -   Batch 1560/1827 | Batch Energy: 4.5936 | Batch Loss: 8.0423  | Perplexity: 3109.7314
2025-09-17 12:01:35,159 - INFO -   Batch 1570/1827 | Batch Energy: 4.5185 | Batch Loss: 8.7700  | Perplexity: 6437.8561
2025-09-17 12:01:40,997 - INFO -   Batch 1580/1827 | Batch Energy: 4.5874 | Batch Loss: 8.7296  | Perplexity: 6183.3248
2025-09-17 12:01:46,649 - INFO -   Batch 1590/1827 | Batch Energy: 5.0764 | Batch Loss: 7.6930  | Perplexity: 2192.8752
2025-09-17 12:01:51,180 - INFO -   Batch 1600/1827 | Batch Energy: 4.7148 | Batch Loss: 8.6013  | Perplexity: 5438.6022
2025-09-17 12:01:55,866 - INFO -   Batch 1610/1827 | Batch Energy: 4.6299 | Batch Loss: 8.4792  | Perplexity: 4813.6635
2025-09-17 12:02:00,543 - INFO -   Batch 1620/1827 | Batch Energy: 4.8061 | Batch Loss: 8.7740  | Perplexity: 6464.0949
2025-09-17 12:02:04,874 - INFO -   Batch 1630/1827 | Batch Energy: 4.9200 | Batch Loss: 8.8917  | Perplexity: 7271.6112
2025-09-17 12:02:09,429 - INFO -   Batch 1640/1827 | Batch Energy: 5.2172 | Batch Loss: 8.4406  | Perplexity: 4631.1669
2025-09-17 12:02:13,852 - INFO -   Batch 1650/1827 | Batch Energy: 5.0275 | Batch Loss: 8.3973  | Perplexity: 4435.2821
2025-09-17 12:02:17,959 - INFO -   Batch 1660/1827 | Batch Energy: 5.2273 | Batch Loss: 8.7641  | Perplexity: 6400.5620
2025-09-17 12:02:22,909 - INFO -   Batch 1670/1827 | Batch Energy: 5.1176 | Batch Loss: 9.0793  | Perplexity: 8771.6640
2025-09-17 12:02:29,145 - INFO -   Batch 1680/1827 | Batch Energy: 5.6723 | Batch Loss: 7.9978  | Perplexity: 2974.4904
2025-09-17 12:02:33,355 - INFO -   Batch 1690/1827 | Batch Energy: 6.0029 | Batch Loss: 8.0461  | Perplexity: 3121.4739
2025-09-17 12:02:37,637 - INFO -   Batch 1700/1827 | Batch Energy: 6.0361 | Batch Loss: 8.0629  | Perplexity: 3174.6026
2025-09-17 12:02:41,848 - INFO -   Batch 1710/1827 | Batch Energy: 6.1558 | Batch Loss: 8.4009  | Perplexity: 4451.1001
2025-09-17 12:02:46,409 - INFO -   Batch 1720/1827 | Batch Energy: 6.5233 | Batch Loss: 9.4007  | Perplexity: 12097.2447
2025-09-17 12:02:51,142 - INFO -   Batch 1730/1827 | Batch Energy: 6.3940 | Batch Loss: 9.2939  | Perplexity: 10871.8478
2025-09-17 12:02:57,631 - INFO -   Batch 1740/1827 | Batch Energy: 6.0971 | Batch Loss: 9.0727  | Perplexity: 8714.3905
2025-09-17 12:03:02,115 - INFO -   Batch 1750/1827 | Batch Energy: 6.0473 | Batch Loss: 7.5560  | Perplexity: 1912.2065
2025-09-17 12:03:06,679 - INFO -   Batch 1760/1827 | Batch Energy: 6.9037 | Batch Loss: 8.6781  | Perplexity: 5872.6065
2025-09-17 12:03:10,987 - INFO -   Batch 1770/1827 | Batch Energy: 6.9511 | Batch Loss: 8.4779  | Perplexity: 4807.5755
2025-09-17 12:03:15,231 - INFO -   Batch 1780/1827 | Batch Energy: 6.4512 | Batch Loss: 8.4582  | Perplexity: 4713.6805
2025-09-17 12:03:19,676 - INFO -   Batch 1790/1827 | Batch Energy: 6.2935 | Batch Loss: 8.3698  | Perplexity: 4314.7302
2025-09-17 12:03:23,812 - INFO -   Batch 1800/1827 | Batch Energy: 7.2316 | Batch Loss: 8.7557  | Perplexity: 6346.4961
2025-09-17 12:03:28,691 - INFO -   Batch 1810/1827 | Batch Energy: 6.8763 | Batch Loss: 8.4037  | Perplexity: 4463.4614
2025-09-17 12:03:32,690 - INFO -   Batch 1820/1827 | Batch Energy: 6.9398 | Batch Loss: 9.3480  | Perplexity: 11475.7235
2025-09-17 12:04:17,939 - INFO - Epoch 1/1 | Train Energy: 2.8609 | Train Perplexity: 3561.9524 | Val Energy: 7.3720 | Val Perplexity: 6089.7682
2025-09-17 12:04:18,079 - INFO - Saved checkpoint to checkpoints/model_epoch_1.pt
2025-09-17 12:04:18,792 - INFO - Training completed in 819.16 seconds
2025-09-17 12:04:18,792 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 12:04:18,792 - INFO - ========== Training completed ==========
2025-09-17 12:32:15,152 - INFO - 
########################################################################################################################
2025-09-17 12:32:15,153 - INFO - Using device: cpu (local rank 0)
2025-09-17 12:32:15,153 - INFO - Saving the hyperparameters configurations:
2025-09-17 12:32:15,153 - INFO - {
      "vocab_size": 50259,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 6,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": 50258,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 12:32:15,406 - INFO - ========== Training started ==========
2025-09-17 12:32:15,406 - INFO - 1.27 M parameters
2025-09-17 12:32:15,406 - INFO - Epoch 1/1
2025-09-17 12:32:19,349 - INFO -   Batch 10/1827 | Batch Energy: 1.8240 | Batch Loss: 9.6274  | Perplexity: 15174.5742
2025-09-17 12:32:23,200 - INFO -   Batch 20/1827 | Batch Energy: 1.8212 | Batch Loss: 9.4289  | Perplexity: 12442.3664
2025-09-17 12:32:27,273 - INFO -   Batch 30/1827 | Batch Energy: 1.8136 | Batch Loss: 9.0651  | Perplexity: 8648.2817
2025-09-17 12:32:31,111 - INFO -   Batch 40/1827 | Batch Energy: 1.8395 | Batch Loss: 8.9983  | Perplexity: 8089.7029
2025-09-17 12:32:35,082 - INFO -   Batch 50/1827 | Batch Energy: 1.7957 | Batch Loss: 9.1797  | Perplexity: 9698.3344
2025-09-17 12:32:38,974 - INFO -   Batch 60/1827 | Batch Energy: 1.8451 | Batch Loss: 8.3729  | Perplexity: 4327.9632
2025-09-17 12:32:42,963 - INFO -   Batch 70/1827 | Batch Energy: 1.8146 | Batch Loss: 8.7910  | Perplexity: 6574.9566
2025-09-17 12:32:46,621 - INFO -   Batch 80/1827 | Batch Energy: 1.8567 | Batch Loss: 8.7289  | Perplexity: 6178.9744
2025-09-17 12:32:50,490 - INFO -   Batch 90/1827 | Batch Energy: 1.8373 | Batch Loss: 8.5432  | Perplexity: 5131.6150
2025-09-17 12:32:54,445 - INFO -   Batch 100/1827 | Batch Energy: 1.8410 | Batch Loss: 8.7023  | Perplexity: 6016.6434
2025-09-17 12:32:58,441 - INFO -   Batch 110/1827 | Batch Energy: 1.8387 | Batch Loss: 8.4083  | Perplexity: 4484.3081
2025-09-17 12:33:02,154 - INFO -   Batch 120/1827 | Batch Energy: 1.8322 | Batch Loss: 8.4446  | Perplexity: 4649.7052
2025-09-17 12:33:05,946 - INFO -   Batch 130/1827 | Batch Energy: 1.8148 | Batch Loss: 8.0732  | Perplexity: 3207.5057
2025-09-17 12:33:09,971 - INFO -   Batch 140/1827 | Batch Energy: 1.8642 | Batch Loss: 7.8852  | Perplexity: 2657.6959
2025-09-17 12:33:13,837 - INFO -   Batch 150/1827 | Batch Energy: 1.8468 | Batch Loss: 7.7252  | Perplexity: 2264.7577
2025-09-17 12:33:17,719 - INFO -   Batch 160/1827 | Batch Energy: 1.8432 | Batch Loss: 8.3676  | Perplexity: 4305.1943
2025-09-17 12:33:21,648 - INFO -   Batch 170/1827 | Batch Energy: 1.8425 | Batch Loss: 8.0820  | Perplexity: 3235.6296
2025-09-17 12:33:25,284 - INFO -   Batch 180/1827 | Batch Energy: 1.8455 | Batch Loss: 8.1517  | Perplexity: 3469.4307
2025-09-17 12:33:29,039 - INFO -   Batch 190/1827 | Batch Energy: 1.8420 | Batch Loss: 8.4559  | Perplexity: 4702.5632
2025-09-17 12:33:32,980 - INFO -   Batch 200/1827 | Batch Energy: 1.8709 | Batch Loss: 8.1377  | Perplexity: 3421.1255
2025-09-17 12:33:36,916 - INFO -   Batch 210/1827 | Batch Energy: 1.8540 | Batch Loss: 7.8627  | Perplexity: 2598.4749
2025-09-17 12:33:40,645 - INFO -   Batch 220/1827 | Batch Energy: 1.8258 | Batch Loss: 7.5164  | Perplexity: 1837.8877
2025-09-17 12:33:44,557 - INFO -   Batch 230/1827 | Batch Energy: 1.8629 | Batch Loss: 8.6537  | Perplexity: 5731.1378
2025-09-17 12:33:48,389 - INFO -   Batch 240/1827 | Batch Energy: 1.8317 | Batch Loss: 8.1923  | Perplexity: 3613.1565
2025-09-17 12:33:52,240 - INFO -   Batch 250/1827 | Batch Energy: 1.8510 | Batch Loss: 7.9266  | Perplexity: 2769.8976
2025-09-17 12:33:56,283 - INFO -   Batch 260/1827 | Batch Energy: 1.8487 | Batch Loss: 8.4565  | Perplexity: 4705.6497
2025-09-17 12:34:00,053 - INFO -   Batch 270/1827 | Batch Energy: 1.8707 | Batch Loss: 8.0199  | Perplexity: 3040.8800
2025-09-17 12:34:03,666 - INFO -   Batch 280/1827 | Batch Energy: 1.8493 | Batch Loss: 7.8101  | Perplexity: 2465.4641
2025-09-17 12:34:07,636 - INFO -   Batch 290/1827 | Batch Energy: 1.8489 | Batch Loss: 7.8761  | Perplexity: 2633.5177
2025-09-17 12:34:11,776 - INFO -   Batch 300/1827 | Batch Energy: 1.8711 | Batch Loss: 7.9846  | Perplexity: 2935.2883
2025-09-17 12:34:15,632 - INFO -   Batch 310/1827 | Batch Energy: 1.8660 | Batch Loss: 8.0084  | Perplexity: 3006.2439
2025-09-17 12:34:19,430 - INFO -   Batch 320/1827 | Batch Energy: 1.8776 | Batch Loss: 8.0165  | Perplexity: 3030.5619
2025-09-17 12:34:23,154 - INFO -   Batch 330/1827 | Batch Energy: 1.8352 | Batch Loss: 8.0564  | Perplexity: 3153.9887
2025-09-17 12:34:26,925 - INFO -   Batch 340/1827 | Batch Energy: 1.8763 | Batch Loss: 7.8813  | Perplexity: 2647.2827
2025-09-17 12:34:30,681 - INFO -   Batch 350/1827 | Batch Energy: 1.8636 | Batch Loss: 7.7429  | Perplexity: 2305.0924
2025-09-17 12:34:34,620 - INFO -   Batch 360/1827 | Batch Energy: 1.8807 | Batch Loss: 7.8956  | Perplexity: 2685.4822
2025-09-17 12:34:38,379 - INFO -   Batch 370/1827 | Batch Energy: 1.8881 | Batch Loss: 7.9065  | Perplexity: 2714.8106
2025-09-17 12:34:42,060 - INFO -   Batch 380/1827 | Batch Energy: 1.8807 | Batch Loss: 8.1679  | Perplexity: 3525.8110
2025-09-17 12:34:45,826 - INFO -   Batch 390/1827 | Batch Energy: 1.8902 | Batch Loss: 7.5106  | Perplexity: 1827.3150
2025-09-17 12:34:49,932 - INFO -   Batch 400/1827 | Batch Energy: 1.8602 | Batch Loss: 8.4348  | Perplexity: 4604.5409
2025-09-17 12:34:53,862 - INFO -   Batch 410/1827 | Batch Energy: 1.8819 | Batch Loss: 8.3269  | Perplexity: 4133.5185
2025-09-17 12:34:57,556 - INFO -   Batch 420/1827 | Batch Energy: 1.8643 | Batch Loss: 6.7281  | Perplexity: 835.5959
2025-09-17 12:35:01,572 - INFO -   Batch 430/1827 | Batch Energy: 1.9316 | Batch Loss: 7.6537  | Perplexity: 2108.4361
2025-09-17 12:35:05,301 - INFO -   Batch 440/1827 | Batch Energy: 1.8941 | Batch Loss: 8.7526  | Perplexity: 6326.8862
2025-09-17 12:35:08,947 - INFO -   Batch 450/1827 | Batch Energy: 1.8687 | Batch Loss: 7.8024  | Perplexity: 2446.4702
2025-09-17 12:35:12,989 - INFO -   Batch 460/1827 | Batch Energy: 1.8690 | Batch Loss: 8.1596  | Perplexity: 3496.9352
2025-09-17 12:35:16,757 - INFO -   Batch 470/1827 | Batch Energy: 1.9147 | Batch Loss: 7.4223  | Perplexity: 1672.8119
2025-09-17 12:35:20,485 - INFO -   Batch 480/1827 | Batch Energy: 1.9211 | Batch Loss: 8.0633  | Perplexity: 3175.8593
2025-09-17 12:35:24,441 - INFO -   Batch 490/1827 | Batch Energy: 1.8910 | Batch Loss: 7.6493  | Perplexity: 2099.1939
2025-09-17 12:35:28,055 - INFO -   Batch 500/1827 | Batch Energy: 1.9100 | Batch Loss: 7.6667  | Perplexity: 2136.0472
2025-09-17 12:35:32,338 - INFO -   Batch 510/1827 | Batch Energy: 1.8963 | Batch Loss: 8.0142  | Perplexity: 3023.5815
2025-09-17 12:35:36,253 - INFO -   Batch 520/1827 | Batch Energy: 1.8837 | Batch Loss: 7.5145  | Perplexity: 1834.4214
2025-09-17 12:35:40,130 - INFO -   Batch 530/1827 | Batch Energy: 1.8377 | Batch Loss: 7.3481  | Perplexity: 1553.2791
2025-09-17 12:35:43,825 - INFO -   Batch 540/1827 | Batch Energy: 1.8659 | Batch Loss: 8.0657  | Perplexity: 3183.4219
2025-09-17 12:35:47,615 - INFO -   Batch 550/1827 | Batch Energy: 1.8790 | Batch Loss: 7.6245  | Perplexity: 2047.6924
2025-09-17 12:35:51,315 - INFO -   Batch 560/1827 | Batch Energy: 1.8763 | Batch Loss: 7.4817  | Perplexity: 1775.1976
2025-09-17 12:35:55,170 - INFO -   Batch 570/1827 | Batch Energy: 1.8512 | Batch Loss: 7.9715  | Perplexity: 2897.0905
2025-09-17 12:35:58,842 - INFO -   Batch 580/1827 | Batch Energy: 1.9208 | Batch Loss: 8.2745  | Perplexity: 3922.5343
2025-09-17 12:36:02,691 - INFO -   Batch 590/1827 | Batch Energy: 1.9275 | Batch Loss: 8.4877  | Perplexity: 4854.7036
2025-09-17 12:36:06,550 - INFO -   Batch 600/1827 | Batch Energy: 1.9194 | Batch Loss: 7.5647  | Perplexity: 1928.9114
2025-09-17 12:36:10,278 - INFO -   Batch 610/1827 | Batch Energy: 1.9154 | Batch Loss: 7.4157  | Perplexity: 1661.8213
2025-09-17 12:36:14,331 - INFO -   Batch 620/1827 | Batch Energy: 1.8877 | Batch Loss: 7.4966  | Perplexity: 1801.8379
2025-09-17 12:36:18,203 - INFO -   Batch 630/1827 | Batch Energy: 1.9585 | Batch Loss: 7.5209  | Perplexity: 1846.2762
2025-09-17 12:36:22,136 - INFO -   Batch 640/1827 | Batch Energy: 1.9964 | Batch Loss: 8.3350  | Perplexity: 4167.0825
2025-09-17 12:36:26,077 - INFO -   Batch 650/1827 | Batch Energy: 2.0016 | Batch Loss: 7.3527  | Perplexity: 1560.3418
2025-09-17 12:36:30,313 - INFO -   Batch 660/1827 | Batch Energy: 1.9847 | Batch Loss: 8.7942  | Perplexity: 6596.0777
2025-09-17 12:36:34,488 - INFO -   Batch 670/1827 | Batch Energy: 1.9105 | Batch Loss: 8.0458  | Perplexity: 3120.5958
2025-09-17 12:36:38,469 - INFO -   Batch 680/1827 | Batch Energy: 1.9481 | Batch Loss: 7.7746  | Perplexity: 2379.4232
2025-09-17 12:36:42,260 - INFO -   Batch 690/1827 | Batch Energy: 1.9762 | Batch Loss: 7.5938  | Perplexity: 1985.8654
2025-09-17 12:36:46,377 - INFO -   Batch 700/1827 | Batch Energy: 1.9486 | Batch Loss: 7.3083  | Perplexity: 1492.5714
2025-09-17 12:36:50,223 - INFO -   Batch 710/1827 | Batch Energy: 1.9600 | Batch Loss: 8.0199  | Perplexity: 3040.9061
2025-09-17 12:36:54,279 - INFO -   Batch 720/1827 | Batch Energy: 1.9798 | Batch Loss: 7.7500  | Perplexity: 2321.5392
2025-09-17 12:36:58,047 - INFO -   Batch 730/1827 | Batch Energy: 1.9837 | Batch Loss: 7.8380  | Perplexity: 2535.1810
2025-09-17 12:37:01,934 - INFO -   Batch 740/1827 | Batch Energy: 1.9499 | Batch Loss: 7.7340  | Perplexity: 2284.7124
2025-09-17 12:37:05,941 - INFO -   Batch 750/1827 | Batch Energy: 2.0014 | Batch Loss: 7.7330  | Perplexity: 2282.4627
2025-09-17 12:37:09,752 - INFO -   Batch 760/1827 | Batch Energy: 2.0363 | Batch Loss: 7.6425  | Perplexity: 2084.9505
2025-09-17 12:37:13,678 - INFO -   Batch 770/1827 | Batch Energy: 2.0142 | Batch Loss: 7.5200  | Perplexity: 1844.6288
2025-09-17 12:37:17,932 - INFO -   Batch 780/1827 | Batch Energy: 1.9667 | Batch Loss: 7.8173  | Perplexity: 2483.0848
2025-09-17 12:37:21,940 - INFO -   Batch 790/1827 | Batch Energy: 2.0178 | Batch Loss: 8.2592  | Perplexity: 3863.0618
2025-09-17 12:37:26,350 - INFO -   Batch 800/1827 | Batch Energy: 2.0060 | Batch Loss: 7.6746  | Perplexity: 2153.0016
2025-09-17 12:37:30,018 - INFO -   Batch 810/1827 | Batch Energy: 2.0033 | Batch Loss: 7.6268  | Perplexity: 2052.4463
2025-09-17 12:37:33,883 - INFO -   Batch 820/1827 | Batch Energy: 2.0030 | Batch Loss: 8.2750  | Perplexity: 3924.5361
2025-09-17 12:37:37,842 - INFO -   Batch 830/1827 | Batch Energy: 1.9819 | Batch Loss: 7.8626  | Perplexity: 2598.2890
2025-09-17 12:37:41,876 - INFO -   Batch 840/1827 | Batch Energy: 2.0007 | Batch Loss: 7.9654  | Perplexity: 2879.4427
2025-09-17 12:37:46,116 - INFO -   Batch 850/1827 | Batch Energy: 2.0110 | Batch Loss: 7.9704  | Perplexity: 2893.9605
2025-09-17 12:37:50,542 - INFO -   Batch 860/1827 | Batch Energy: 2.0146 | Batch Loss: 7.8617  | Perplexity: 2595.9261
2025-09-17 12:37:54,904 - INFO -   Batch 870/1827 | Batch Energy: 1.9857 | Batch Loss: 7.9581  | Perplexity: 2858.5760
2025-09-17 12:37:59,030 - INFO -   Batch 880/1827 | Batch Energy: 2.0451 | Batch Loss: 7.5532  | Perplexity: 1906.9126
2025-09-17 12:38:03,397 - INFO -   Batch 890/1827 | Batch Energy: 2.0531 | Batch Loss: 8.2876  | Perplexity: 3974.1652
2025-09-17 12:38:07,372 - INFO -   Batch 900/1827 | Batch Energy: 2.0394 | Batch Loss: 7.9093  | Perplexity: 2722.5473
2025-09-17 12:38:11,210 - INFO -   Batch 910/1827 | Batch Energy: 2.0905 | Batch Loss: 8.1302  | Perplexity: 3395.5479
2025-09-17 12:38:15,246 - INFO -   Batch 920/1827 | Batch Energy: 2.1211 | Batch Loss: 7.7667  | Perplexity: 2360.6362
2025-09-17 12:38:19,130 - INFO -   Batch 930/1827 | Batch Energy: 2.1003 | Batch Loss: 7.4239  | Perplexity: 1675.5660
2025-09-17 12:38:23,544 - INFO -   Batch 940/1827 | Batch Energy: 2.0752 | Batch Loss: 7.9754  | Perplexity: 2908.4003
2025-09-17 12:38:27,618 - INFO -   Batch 950/1827 | Batch Energy: 2.0958 | Batch Loss: 8.5593  | Perplexity: 5214.8625
2025-09-17 12:38:31,772 - INFO -   Batch 960/1827 | Batch Energy: 2.0963 | Batch Loss: 7.6235  | Perplexity: 2045.6732
2025-09-17 12:38:35,764 - INFO -   Batch 970/1827 | Batch Energy: 2.1360 | Batch Loss: 8.2143  | Perplexity: 3693.4715
2025-09-17 12:38:39,932 - INFO -   Batch 980/1827 | Batch Energy: 2.1706 | Batch Loss: 8.1400  | Perplexity: 3429.0597
2025-09-17 12:38:43,737 - INFO -   Batch 990/1827 | Batch Energy: 2.1584 | Batch Loss: 8.1556  | Perplexity: 3482.8536
2025-09-17 12:38:47,727 - INFO -   Batch 1000/1827 | Batch Energy: 2.1981 | Batch Loss: 8.6190  | Perplexity: 5535.9452
2025-09-17 12:38:51,664 - INFO -   Batch 1010/1827 | Batch Energy: 2.1506 | Batch Loss: 7.4793  | Perplexity: 1770.9466
2025-09-17 12:38:55,531 - INFO -   Batch 1020/1827 | Batch Energy: 2.2025 | Batch Loss: 8.2207  | Perplexity: 3717.1434
2025-09-17 12:38:59,164 - INFO -   Batch 1030/1827 | Batch Energy: 2.1490 | Batch Loss: 8.0630  | Perplexity: 3174.7146
2025-09-17 12:39:02,928 - INFO -   Batch 1040/1827 | Batch Energy: 2.1442 | Batch Loss: 8.2883  | Perplexity: 3977.2477
2025-09-17 12:39:07,068 - INFO -   Batch 1050/1827 | Batch Energy: 2.1569 | Batch Loss: 8.0143  | Perplexity: 3023.7661
2025-09-17 12:39:11,484 - INFO -   Batch 1060/1827 | Batch Energy: 2.2095 | Batch Loss: 8.0952  | Perplexity: 3278.7287
2025-09-17 12:39:17,970 - INFO -   Batch 1070/1827 | Batch Energy: 2.2398 | Batch Loss: 8.1046  | Perplexity: 3309.6826
2025-09-17 12:39:21,930 - INFO -   Batch 1080/1827 | Batch Energy: 2.2313 | Batch Loss: 7.9413  | Perplexity: 2810.9010
2025-09-17 12:39:25,894 - INFO -   Batch 1090/1827 | Batch Energy: 2.2337 | Batch Loss: 8.0761  | Perplexity: 3216.7722
2025-09-17 12:39:29,876 - INFO -   Batch 1100/1827 | Batch Energy: 2.2675 | Batch Loss: 8.1876  | Perplexity: 3596.2395
2025-09-17 12:39:33,726 - INFO -   Batch 1110/1827 | Batch Energy: 2.3227 | Batch Loss: 8.4782  | Perplexity: 4808.7907
2025-09-17 12:39:37,526 - INFO -   Batch 1120/1827 | Batch Energy: 2.2886 | Batch Loss: 8.9578  | Perplexity: 7768.0774
2025-09-17 12:39:41,336 - INFO -   Batch 1130/1827 | Batch Energy: 2.3121 | Batch Loss: 8.1437  | Perplexity: 3441.7683
2025-09-17 12:39:45,373 - INFO -   Batch 1140/1827 | Batch Energy: 2.3057 | Batch Loss: 8.2920  | Perplexity: 3991.6949
2025-09-17 12:39:49,430 - INFO -   Batch 1150/1827 | Batch Energy: 2.3524 | Batch Loss: 9.2083  | Perplexity: 9979.9371
2025-09-17 12:39:53,289 - INFO -   Batch 1160/1827 | Batch Energy: 2.3206 | Batch Loss: 8.0434  | Perplexity: 3113.2804
2025-09-17 12:39:57,237 - INFO -   Batch 1170/1827 | Batch Energy: 2.2778 | Batch Loss: 7.8539  | Perplexity: 2575.7933
2025-09-17 12:40:01,041 - INFO -   Batch 1180/1827 | Batch Energy: 2.4469 | Batch Loss: 8.3459  | Perplexity: 4213.0556
2025-09-17 12:40:05,100 - INFO -   Batch 1190/1827 | Batch Energy: 2.4413 | Batch Loss: 8.6428  | Perplexity: 5669.3562
2025-09-17 12:40:09,104 - INFO -   Batch 1200/1827 | Batch Energy: 2.3996 | Batch Loss: 8.0213  | Perplexity: 3045.1083
2025-09-17 12:40:12,990 - INFO -   Batch 1210/1827 | Batch Energy: 2.5048 | Batch Loss: 7.6977  | Perplexity: 2203.2589
2025-09-17 12:40:16,745 - INFO -   Batch 1220/1827 | Batch Energy: 2.4830 | Batch Loss: 8.5880  | Perplexity: 5367.1114
2025-09-17 12:40:20,504 - INFO -   Batch 1230/1827 | Batch Energy: 2.5901 | Batch Loss: 8.2513  | Perplexity: 3832.7360
2025-09-17 12:40:24,182 - INFO -   Batch 1240/1827 | Batch Energy: 2.6586 | Batch Loss: 8.3117  | Perplexity: 4071.1422
2025-09-17 12:40:28,001 - INFO -   Batch 1250/1827 | Batch Energy: 2.6762 | Batch Loss: 8.3473  | Perplexity: 4218.9821
2025-09-17 12:40:31,982 - INFO -   Batch 1260/1827 | Batch Energy: 2.6204 | Batch Loss: 8.6002  | Perplexity: 5432.5268
2025-09-17 12:40:35,970 - INFO -   Batch 1270/1827 | Batch Energy: 2.6894 | Batch Loss: 8.7706  | Perplexity: 6441.8850
2025-09-17 12:40:39,882 - INFO -   Batch 1280/1827 | Batch Energy: 2.7894 | Batch Loss: 7.8099  | Perplexity: 2464.9493
2025-09-17 12:40:43,732 - INFO -   Batch 1290/1827 | Batch Energy: 2.7887 | Batch Loss: 7.9221  | Perplexity: 2757.4758
2025-09-17 12:40:47,811 - INFO -   Batch 1300/1827 | Batch Energy: 2.8465 | Batch Loss: 8.3590  | Perplexity: 4268.5024
2025-09-17 12:40:51,978 - INFO -   Batch 1310/1827 | Batch Energy: 2.9410 | Batch Loss: 8.5947  | Perplexity: 5402.8287
2025-09-17 12:40:55,741 - INFO -   Batch 1320/1827 | Batch Energy: 2.9391 | Batch Loss: 7.9140  | Perplexity: 2735.3373
2025-09-17 12:40:59,616 - INFO -   Batch 1330/1827 | Batch Energy: 3.0036 | Batch Loss: 8.3459  | Perplexity: 4212.9431
2025-09-17 12:41:03,704 - INFO -   Batch 1340/1827 | Batch Energy: 3.0767 | Batch Loss: 8.1912  | Perplexity: 3608.9241
2025-09-17 12:41:07,737 - INFO -   Batch 1350/1827 | Batch Energy: 3.0488 | Batch Loss: 7.7849  | Perplexity: 2404.0892
2025-09-17 12:41:11,873 - INFO -   Batch 1360/1827 | Batch Energy: 3.1567 | Batch Loss: 8.4561  | Perplexity: 4703.7204
2025-09-17 12:41:15,616 - INFO -   Batch 1370/1827 | Batch Energy: 3.2112 | Batch Loss: 8.0191  | Perplexity: 3038.5841
2025-09-17 12:41:19,428 - INFO -   Batch 1380/1827 | Batch Energy: 3.3456 | Batch Loss: 8.0557  | Perplexity: 3151.7096
2025-09-17 12:41:23,533 - INFO -   Batch 1390/1827 | Batch Energy: 3.2247 | Batch Loss: 8.5690  | Perplexity: 5265.9881
2025-09-17 12:41:27,376 - INFO -   Batch 1400/1827 | Batch Energy: 3.1392 | Batch Loss: 8.3755  | Perplexity: 4339.6515
2025-09-17 12:41:31,421 - INFO -   Batch 1410/1827 | Batch Energy: 3.4844 | Batch Loss: 8.2169  | Perplexity: 3702.9200
2025-09-17 12:41:35,286 - INFO -   Batch 1420/1827 | Batch Energy: 3.4511 | Batch Loss: 9.6694  | Perplexity: 15825.3560
2025-09-17 12:41:39,076 - INFO -   Batch 1430/1827 | Batch Energy: 3.7513 | Batch Loss: 7.6814  | Perplexity: 2167.7099
2025-09-17 12:41:43,130 - INFO -   Batch 1440/1827 | Batch Energy: 3.9251 | Batch Loss: 8.5268  | Perplexity: 5048.3915
2025-09-17 12:41:46,791 - INFO -   Batch 1450/1827 | Batch Energy: 3.8069 | Batch Loss: 8.1713  | Perplexity: 3538.0312
2025-09-17 12:41:50,541 - INFO -   Batch 1460/1827 | Batch Energy: 3.8793 | Batch Loss: 7.8579  | Perplexity: 2585.9807
2025-09-17 12:41:54,219 - INFO -   Batch 1470/1827 | Batch Energy: 4.0171 | Batch Loss: 8.6378  | Perplexity: 5640.8536
2025-09-17 12:41:57,989 - INFO -   Batch 1480/1827 | Batch Energy: 4.1664 | Batch Loss: 8.3931  | Perplexity: 4416.4024
2025-09-17 12:42:01,810 - INFO -   Batch 1490/1827 | Batch Energy: 3.9069 | Batch Loss: 7.8629  | Perplexity: 2599.1093
2025-09-17 12:42:05,782 - INFO -   Batch 1500/1827 | Batch Energy: 4.2110 | Batch Loss: 8.6407  | Perplexity: 5657.5225
2025-09-17 12:42:09,762 - INFO -   Batch 1510/1827 | Batch Energy: 4.2615 | Batch Loss: 8.3165  | Perplexity: 4090.9758
2025-09-17 12:42:13,569 - INFO -   Batch 1520/1827 | Batch Energy: 4.2304 | Batch Loss: 8.6722  | Perplexity: 5838.3196
2025-09-17 12:42:17,510 - INFO -   Batch 1530/1827 | Batch Energy: 4.4994 | Batch Loss: 7.4468  | Perplexity: 1714.3541
2025-09-17 12:42:21,333 - INFO -   Batch 1540/1827 | Batch Energy: 4.4315 | Batch Loss: 8.5373  | Perplexity: 5101.4451
2025-09-17 12:42:25,308 - INFO -   Batch 1550/1827 | Batch Energy: 4.7760 | Batch Loss: 9.2891  | Perplexity: 10819.2738
2025-09-17 12:42:29,304 - INFO -   Batch 1560/1827 | Batch Energy: 4.6074 | Batch Loss: 8.6663  | Perplexity: 5803.8233
2025-09-17 12:42:33,119 - INFO -   Batch 1570/1827 | Batch Energy: 4.8021 | Batch Loss: 8.8112  | Perplexity: 6709.1581
2025-09-17 12:42:37,006 - INFO -   Batch 1580/1827 | Batch Energy: 5.0123 | Batch Loss: 8.0179  | Perplexity: 3034.7729
2025-09-17 12:42:40,966 - INFO -   Batch 1590/1827 | Batch Energy: 5.1553 | Batch Loss: 8.6017  | Perplexity: 5440.7343
2025-09-17 12:42:44,873 - INFO -   Batch 1600/1827 | Batch Energy: 5.4518 | Batch Loss: 8.0908  | Perplexity: 3264.4577
2025-09-17 12:42:48,772 - INFO -   Batch 1610/1827 | Batch Energy: 5.5679 | Batch Loss: 8.5399  | Perplexity: 5114.6466
2025-09-17 12:42:52,733 - INFO -   Batch 1620/1827 | Batch Energy: 5.4277 | Batch Loss: 8.6607  | Perplexity: 5771.2972
2025-09-17 12:42:56,488 - INFO -   Batch 1630/1827 | Batch Energy: 5.7000 | Batch Loss: 9.2010  | Perplexity: 9907.3073
2025-09-17 12:43:00,232 - INFO -   Batch 1640/1827 | Batch Energy: 5.6294 | Batch Loss: 8.0761  | Perplexity: 3216.7784
2025-09-17 12:43:04,271 - INFO -   Batch 1650/1827 | Batch Energy: 6.3720 | Batch Loss: 9.1470  | Perplexity: 9386.0543
2025-09-17 12:49:57,705 - INFO -   Batch 1660/1827 | Batch Energy: 5.5991 | Batch Loss: 8.5012  | Perplexity: 4920.4482
2025-09-17 12:50:01,926 - INFO -   Batch 1670/1827 | Batch Energy: 6.3966 | Batch Loss: 9.3915  | Perplexity: 11985.7963
2025-09-17 12:50:06,586 - INFO -   Batch 1680/1827 | Batch Energy: 5.9979 | Batch Loss: 9.0771  | Perplexity: 8752.1527
2025-09-17 12:50:10,873 - INFO -   Batch 1690/1827 | Batch Energy: 6.4524 | Batch Loss: 8.2274  | Perplexity: 3742.0839
2025-09-17 12:50:14,943 - INFO -   Batch 1700/1827 | Batch Energy: 6.4126 | Batch Loss: 9.2430  | Perplexity: 10331.8307
2025-09-17 12:50:19,068 - INFO -   Batch 1710/1827 | Batch Energy: 6.3115 | Batch Loss: 8.1800  | Perplexity: 3568.9987
2025-09-17 12:50:23,069 - INFO -   Batch 1720/1827 | Batch Energy: 6.5897 | Batch Loss: 8.2812  | Perplexity: 3949.0825
2025-09-17 12:50:27,118 - INFO -   Batch 1730/1827 | Batch Energy: 6.8369 | Batch Loss: 7.5587  | Perplexity: 1917.2866
2025-09-17 12:50:30,985 - INFO -   Batch 1740/1827 | Batch Energy: 6.6783 | Batch Loss: 8.7981  | Perplexity: 6621.4646
2025-09-17 12:50:35,112 - INFO -   Batch 1750/1827 | Batch Energy: 6.4504 | Batch Loss: 8.7665  | Perplexity: 6415.5100
2025-09-17 12:50:39,005 - INFO -   Batch 1760/1827 | Batch Energy: 6.5954 | Batch Loss: 8.5363  | Perplexity: 5096.3830
2025-09-17 12:50:42,867 - INFO -   Batch 1770/1827 | Batch Energy: 6.9958 | Batch Loss: 8.1549  | Perplexity: 3480.4596
2025-09-17 12:50:46,932 - INFO -   Batch 1780/1827 | Batch Energy: 6.8063 | Batch Loss: 10.1083  | Perplexity: 24546.8621
2025-09-17 12:50:51,021 - INFO -   Batch 1790/1827 | Batch Energy: 7.0043 | Batch Loss: 9.2795  | Perplexity: 10715.7660
2025-09-17 12:50:55,235 - INFO -   Batch 1800/1827 | Batch Energy: 6.9893 | Batch Loss: 8.4244  | Perplexity: 4556.8548
2025-09-17 12:50:59,219 - INFO -   Batch 1810/1827 | Batch Energy: 7.3057 | Batch Loss: 8.0177  | Perplexity: 3034.1102
2025-09-17 12:51:03,285 - INFO -   Batch 1820/1827 | Batch Energy: 7.6992 | Batch Loss: 8.9977  | Perplexity: 8084.5124
2025-09-17 12:51:45,548 - INFO - Epoch 1/1 | Train Energy: 2.8633 | Train Perplexity: 3566.6037 | Val Energy: 7.5930 | Val Perplexity: 6189.1967
2025-09-17 12:51:45,659 - INFO - Saved checkpoint to checkpoints/model_epoch_1.pt
2025-09-17 12:51:46,045 - INFO - Training completed in 1170.64 seconds
2025-09-17 12:51:46,045 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 12:51:46,045 - INFO - ========== Training completed ==========
2025-09-17 13:41:20,075 - INFO - 
########################################################################################################################
2025-09-17 13:41:20,075 - INFO - Using device: cpu (local rank 0)
2025-09-17 13:41:20,076 - INFO - Saving the hyperparameters configurations:
2025-09-17 13:41:20,076 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 6,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 13:41:20,253 - INFO - ========== Training started ==========
2025-09-17 13:41:20,254 - INFO - 1.27 M parameters
2025-09-17 13:41:20,254 - INFO - Epoch 1/1
2025-09-17 13:47:14,993 - INFO - 
########################################################################################################################
2025-09-17 13:47:14,994 - INFO - Using device: cpu (local rank 0)
2025-09-17 13:47:14,994 - INFO - Saving the hyperparameters configurations:
2025-09-17 13:47:14,994 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 6,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 13:47:15,174 - INFO - ========== Training started ==========
2025-09-17 13:47:15,175 - INFO - 1.27 M parameters
2025-09-17 13:47:15,175 - INFO - Epoch 1/1
2025-09-17 13:48:54,656 - INFO - 
########################################################################################################################
2025-09-17 13:48:54,657 - INFO - Using device: cpu (local rank 0)
2025-09-17 13:48:54,657 - INFO - Saving the hyperparameters configurations:
2025-09-17 13:48:54,657 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 3,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 6,
      "n_blocks": 6,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 13:48:54,823 - INFO - ========== Training started ==========
2025-09-17 13:48:54,824 - INFO - 1.27 M parameters
2025-09-17 13:48:54,824 - INFO - Epoch 1/1
2025-09-17 13:57:23,314 - INFO - 
########################################################################################################################
2025-09-17 13:57:23,314 - INFO - Using device: cpu (local rank 0)
2025-09-17 13:57:23,314 - INFO - Saving the hyperparameters configurations:
2025-09-17 13:57:23,314 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 13:57:23,482 - INFO - ========== Training started ==========
2025-09-17 13:57:23,483 - INFO - 1.26 M parameters
2025-09-17 13:57:23,483 - INFO - Epoch 1/1
2025-09-17 13:58:57,980 - INFO - 
########################################################################################################################
2025-09-17 13:58:57,980 - INFO - Using device: cpu (local rank 0)
2025-09-17 13:58:57,980 - INFO - Saving the hyperparameters configurations:
2025-09-17 13:58:57,980 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 13:58:58,144 - INFO - ========== Training started ==========
2025-09-17 13:58:58,144 - INFO - 1.26 M parameters
2025-09-17 13:58:58,144 - INFO - Epoch 1/1
2025-09-17 14:05:05,645 - INFO - 
########################################################################################################################
2025-09-17 14:05:05,645 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:05:05,646 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:05:05,646 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:05:05,807 - INFO - ========== Training started ==========
2025-09-17 14:05:05,808 - INFO - 1.26 M parameters
2025-09-17 14:05:05,808 - INFO - Epoch 1/1
2025-09-17 14:05:22,579 - INFO -   Batch 10/10 | Batch Energy: 2.8086 | Batch Loss: 11.0214  | Perplexity: 61167.7092
2025-09-17 14:05:22,691 - INFO - Epoch 1/1 | Train Energy: 3.0488 | Train Perplexity: 61148.0830
2025-09-17 14:05:22,761 - INFO - Saved checkpoint to checkpoints/model_epoch_1.pt
2025-09-17 14:05:23,391 - INFO - Training completed in 17.58 seconds
2025-09-17 14:05:23,391 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 14:05:23,391 - INFO - ========== Training completed ==========
2025-09-17 14:15:52,369 - INFO - 
########################################################################################################################
2025-09-17 14:15:52,369 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:15:52,369 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:15:52,370 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:15:52,538 - INFO - ========== Training started ==========
2025-09-17 14:15:52,539 - INFO - 1.26 M parameters
2025-09-17 14:15:52,539 - INFO - Epoch 1/1
2025-09-17 14:16:15,891 - INFO -   Batch 10/10 | Batch Energy: 2.8419 | Batch Loss: 11.0503  | Perplexity: 62962.0977
2025-09-17 14:16:16,127 - INFO - Epoch 1/1 | Train Energy: 3.0698 | Train Perplexity: 61828.2318
2025-09-17 14:16:16,277 - INFO - Saved checkpoint to checkpoints/model_epoch_1.pt
2025-09-17 14:16:16,961 - INFO - Training completed in 24.42 seconds
2025-09-17 14:16:16,962 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 14:16:16,962 - INFO - ========== Training completed ==========
2025-09-17 14:19:43,602 - INFO - 
########################################################################################################################
2025-09-17 14:19:43,602 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:19:43,602 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:19:43,602 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:19:43,764 - INFO - ========== Training started ==========
2025-09-17 14:19:43,765 - INFO - 1.26 M parameters
2025-09-17 14:19:43,765 - INFO - Epoch 1/1
2025-09-17 14:19:59,241 - INFO -   Batch 10/10 | Batch Energy: 2.8317 | Batch Loss: 10.9829  | Perplexity: 58861.4483
2025-09-17 14:19:59,350 - INFO - Epoch 1/1 | Train Energy: 3.0666 | Train Perplexity: 58865.4677
2025-09-17 14:19:59,468 - INFO - Saved checkpoint to checkpoints/model_epoch_1.pt
2025-09-17 14:19:59,952 - INFO - Training completed in 16.19 seconds
2025-09-17 14:19:59,952 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 14:19:59,952 - INFO - ========== Training completed ==========
2025-09-17 14:23:52,387 - INFO - 
########################################################################################################################
2025-09-17 14:23:52,387 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:23:52,387 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:23:52,387 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 1,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:23:52,551 - INFO - ========== Training started ==========
2025-09-17 14:23:52,551 - INFO - 1.26 M parameters
2025-09-17 14:23:52,551 - INFO - Epoch 1/1
2025-09-17 14:24:39,375 - INFO - 
########################################################################################################################
2025-09-17 14:24:39,376 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:24:39,376 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:24:39,376 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 10,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 1,
      "n_blocks": 1,
      "batch_size": 8,
      "num_epochs": 10,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:24:39,532 - INFO - ========== Training started ==========
2025-09-17 14:24:39,532 - INFO - 1.26 M parameters
2025-09-17 14:24:39,532 - INFO - Epoch 1/10
2025-09-17 14:24:57,938 - INFO -   Batch 10/100 | Batch Energy: 2.8402 | Batch Loss: 10.9617  | Perplexity: 57625.2258
2025-09-17 14:25:10,976 - INFO -   Batch 20/100 | Batch Energy: 2.5636 | Batch Loss: 10.9940  | Perplexity: 59518.4390
2025-09-17 14:25:28,907 - INFO -   Batch 30/100 | Batch Energy: 2.5267 | Batch Loss: 11.0032  | Perplexity: 60063.5573
2025-09-17 14:25:49,764 - INFO -   Batch 40/100 | Batch Energy: 2.4865 | Batch Loss: 10.9977  | Perplexity: 59736.8016
2025-09-17 14:26:27,444 - INFO - 
########################################################################################################################
2025-09-17 14:26:27,444 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:26:27,444 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:26:27,444 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.0001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 100,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 2,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 4,
      "n_blocks": 4,
      "batch_size": 8,
      "num_epochs": 10,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:26:27,612 - INFO - ========== Training started ==========
2025-09-17 14:26:27,612 - INFO - 1.27 M parameters
2025-09-17 14:26:27,612 - INFO - Epoch 1/10
2025-09-17 14:27:16,503 - INFO - 
########################################################################################################################
2025-09-17 14:27:16,503 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:27:16,503 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:27:16,503 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.0001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 100,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 2,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 10,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:27:16,671 - INFO - ========== Training started ==========
2025-09-17 14:27:16,672 - INFO - 1.27 M parameters
2025-09-17 14:27:16,672 - INFO - Epoch 1/10
2025-09-17 14:27:43,693 - INFO -   Batch 10/100 | Batch Energy: 1.9676 | Batch Loss: 9.6172  | Perplexity: 15020.2862
2025-09-17 14:28:23,373 - INFO - 
########################################################################################################################
2025-09-17 14:28:23,374 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:28:23,374 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:28:23,374 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.0001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 100,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 10,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:28:23,542 - INFO - ========== Training started ==========
2025-09-17 14:28:23,543 - INFO - 1.27 M parameters
2025-09-17 14:28:23,543 - INFO - Epoch 1/10
2025-09-17 14:28:35,887 - INFO -   Batch 10/100 | Batch Energy: 3.1585 | Batch Loss: 11.0088  | Perplexity: 60405.9822
2025-09-17 14:28:46,474 - INFO -   Batch 20/100 | Batch Energy: 2.9821 | Batch Loss: 10.9874  | Perplexity: 59126.6628
2025-09-17 14:28:57,565 - INFO -   Batch 30/100 | Batch Energy: 2.9429 | Batch Loss: 11.0324  | Perplexity: 61846.9026
2025-09-17 14:29:08,287 - INFO -   Batch 40/100 | Batch Energy: 2.9017 | Batch Loss: 10.9635  | Perplexity: 57729.6261
2025-09-17 14:29:18,919 - INFO -   Batch 50/100 | Batch Energy: 2.8690 | Batch Loss: 10.9904  | Perplexity: 59304.5507
2025-09-17 14:29:30,071 - INFO -   Batch 60/100 | Batch Energy: 2.8493 | Batch Loss: 10.9421  | Perplexity: 56508.0662
2025-09-17 14:29:40,865 - INFO -   Batch 70/100 | Batch Energy: 2.8141 | Batch Loss: 10.9902  | Perplexity: 59291.1482
2025-09-17 14:29:57,637 - INFO - 
########################################################################################################################
2025-09-17 14:29:57,638 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:29:57,638 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:29:57,638 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.001,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 100,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 2,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 10,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:29:57,797 - INFO - ========== Training started ==========
2025-09-17 14:29:57,797 - INFO - 1.27 M parameters
2025-09-17 14:29:57,797 - INFO - Epoch 1/10
2025-09-17 14:30:09,272 - INFO -   Batch 10/100 | Batch Energy: 3.1408 | Batch Loss: 11.0139  | Perplexity: 60714.9706
2025-09-17 14:30:20,151 - INFO -   Batch 20/100 | Batch Energy: 2.9606 | Batch Loss: 11.0131  | Perplexity: 60666.4679
2025-09-17 14:30:30,699 - INFO -   Batch 30/100 | Batch Energy: 2.8995 | Batch Loss: 11.0354  | Perplexity: 62030.4900
2025-09-17 14:30:45,722 - INFO -   Batch 40/100 | Batch Energy: 2.8483 | Batch Loss: 11.0207  | Perplexity: 61125.4899
2025-09-17 14:30:57,426 - INFO -   Batch 50/100 | Batch Energy: 2.8241 | Batch Loss: 10.9983  | Perplexity: 59771.1641
2025-09-17 14:31:09,270 - INFO -   Batch 60/100 | Batch Energy: 2.7900 | Batch Loss: 11.0009  | Perplexity: 59925.4970
2025-09-17 14:31:33,313 - INFO - 
########################################################################################################################
2025-09-17 14:31:33,314 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:31:33,314 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:31:33,314 - INFO - {
      "vocab_size": 50340,
      "block_size": 256,
      "local_learning_rate": 0.002,
      "peak_learning_rate": 0.0005,
      "warmup_steps": 100,
      "la": 0.5,
      "n_embed": 12,
      "dropout": 0.1,
      "T": 1,
      "is_holding_error": true,
      "update_bias": false,
      "num_heads": 3,
      "n_blocks": 2,
      "batch_size": 8,
      "num_epochs": 5,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": true,
      "combined_internal_weight": 0.7,
      "combined_output_weight": 0.3
}
2025-09-17 14:31:33,476 - INFO - ========== Training started ==========
2025-09-17 14:31:33,476 - INFO - 1.27 M parameters
2025-09-17 14:31:33,476 - INFO - Epoch 1/5
2025-09-17 14:31:46,141 - INFO -   Batch 10/100 | Batch Energy: 3.2260 | Batch Loss: 11.0311  | Perplexity: 61766.2092
2025-09-17 14:31:57,304 - INFO -   Batch 20/100 | Batch Energy: 3.0422 | Batch Loss: 11.0095  | Perplexity: 60446.1481
2025-09-17 14:32:08,449 - INFO -   Batch 30/100 | Batch Energy: 2.9623 | Batch Loss: 11.0561  | Perplexity: 63331.1932
2025-09-17 14:32:19,103 - INFO -   Batch 40/100 | Batch Energy: 2.9058 | Batch Loss: 10.9906  | Perplexity: 59313.3177
2025-09-17 14:32:29,862 - INFO -   Batch 50/100 | Batch Energy: 2.8775 | Batch Loss: 11.0668  | Perplexity: 64010.0479
2025-09-17 14:32:40,756 - INFO -   Batch 60/100 | Batch Energy: 2.8561 | Batch Loss: 11.0171  | Perplexity: 60905.1295
2025-09-17 14:32:51,483 - INFO -   Batch 70/100 | Batch Energy: 2.8368 | Batch Loss: 11.0596  | Perplexity: 63549.1791
2025-09-17 14:33:04,538 - INFO -   Batch 80/100 | Batch Energy: 2.8547 | Batch Loss: 11.0292  | Perplexity: 61650.9223
2025-09-17 14:33:16,282 - INFO -   Batch 90/100 | Batch Energy: 2.8441 | Batch Loss: 11.0464  | Perplexity: 62717.5887
2025-09-17 14:33:27,171 - INFO -   Batch 100/100 | Batch Energy: 2.8596 | Batch Loss: 11.0737  | Perplexity: 64456.1843
2025-09-17 14:33:27,292 - INFO - Epoch 1/5 | Train Energy: 2.9547 | Train Perplexity: 62310.6703
2025-09-17 14:33:27,292 - INFO - Epoch 2/5
2025-09-17 14:33:38,583 - INFO -   Batch 10/100 | Batch Energy: 2.8941 | Batch Loss: 11.0382  | Perplexity: 62206.7316
2025-09-17 14:33:49,751 - INFO -   Batch 20/100 | Batch Energy: 2.9744 | Batch Loss: 11.1291  | Perplexity: 68123.2023
2025-09-17 14:34:01,137 - INFO -   Batch 30/100 | Batch Energy: 3.0647 | Batch Loss: 11.2866  | Perplexity: 79746.0886
2025-09-17 14:34:16,504 - INFO -   Batch 40/100 | Batch Energy: 3.1377 | Batch Loss: 11.1581  | Perplexity: 70126.6496
2025-09-17 14:34:32,391 - INFO -   Batch 50/100 | Batch Energy: 3.1749 | Batch Loss: 11.1668  | Perplexity: 70743.1499
2025-09-17 14:34:43,919 - INFO -   Batch 60/100 | Batch Energy: 3.3157 | Batch Loss: 11.2894  | Perplexity: 79969.7659
2025-09-17 14:34:59,909 - INFO -   Batch 70/100 | Batch Energy: 3.4796 | Batch Loss: 11.4787  | Perplexity: 96634.1315
2025-09-17 14:35:12,203 - INFO -   Batch 80/100 | Batch Energy: 3.5204 | Batch Loss: 11.4680  | Perplexity: 95604.4516
2025-09-17 14:35:23,021 - INFO -   Batch 90/100 | Batch Energy: 3.7819 | Batch Loss: 11.3353  | Perplexity: 83722.8374
2025-09-17 14:35:34,755 - INFO -   Batch 100/100 | Batch Energy: 3.7378 | Batch Loss: 11.4982  | Perplexity: 98535.0884
2025-09-17 14:35:34,865 - INFO - Epoch 2/5 | Train Energy: 3.2660 | Train Perplexity: 79085.6932
2025-09-17 14:35:34,865 - INFO - Epoch 3/5
2025-09-17 14:35:51,576 - INFO -   Batch 10/100 | Batch Energy: 3.9135 | Batch Loss: 11.4003  | Perplexity: 89352.9572
2025-09-17 14:36:05,254 - INFO -   Batch 20/100 | Batch Energy: 4.0984 | Batch Loss: 11.6971  | Perplexity: 120222.1818
2025-09-17 14:36:16,176 - INFO -   Batch 30/100 | Batch Energy: 4.1490 | Batch Loss: 11.6676  | Perplexity: 116729.5427
2025-09-17 14:36:27,581 - INFO -   Batch 40/100 | Batch Energy: 4.1270 | Batch Loss: 11.6614  | Perplexity: 116008.2986
2025-09-17 14:36:41,734 - INFO -   Batch 50/100 | Batch Energy: 4.0917 | Batch Loss: 11.8478  | Perplexity: 139771.7372
2025-09-17 14:36:52,832 - INFO -   Batch 60/100 | Batch Energy: 4.1522 | Batch Loss: 11.8746  | Perplexity: 143576.2298
2025-09-17 14:37:05,079 - INFO -   Batch 70/100 | Batch Energy: 4.2219 | Batch Loss: 11.7572  | Perplexity: 127663.4212
2025-09-17 14:37:16,364 - INFO -   Batch 80/100 | Batch Energy: 4.0633 | Batch Loss: 12.0206  | Perplexity: 166137.9284
2025-09-17 14:37:26,719 - INFO -   Batch 90/100 | Batch Energy: 4.2552 | Batch Loss: 12.2086  | Perplexity: 200508.7961
2025-09-17 14:37:37,480 - INFO -   Batch 100/100 | Batch Energy: 4.1224 | Batch Loss: 12.0743  | Perplexity: 175303.0031
2025-09-17 14:37:37,592 - INFO - Epoch 3/5 | Train Energy: 4.1098 | Train Perplexity: 144227.7672
2025-09-17 14:37:37,592 - INFO - Epoch 4/5
2025-09-17 14:37:48,540 - INFO -   Batch 10/100 | Batch Energy: 4.2723 | Batch Loss: 12.3774  | Perplexity: 237369.5991
2025-09-17 14:38:00,916 - INFO -   Batch 20/100 | Batch Energy: 4.1884 | Batch Loss: 12.3583  | Perplexity: 232894.1435
2025-09-17 14:38:12,206 - INFO -   Batch 30/100 | Batch Energy: 4.1970 | Batch Loss: 12.4740  | Perplexity: 261459.9032
2025-09-17 14:38:23,857 - INFO -   Batch 40/100 | Batch Energy: 4.0882 | Batch Loss: 12.6572  | Perplexity: 314030.8755
2025-09-17 14:38:34,232 - INFO -   Batch 50/100 | Batch Energy: 4.2316 | Batch Loss: 12.4819  | Perplexity: 263513.0716
2025-09-17 14:38:45,007 - INFO -   Batch 60/100 | Batch Energy: 4.2686 | Batch Loss: 13.0936  | Perplexity: 485845.5478
2025-09-17 14:38:55,807 - INFO -   Batch 70/100 | Batch Energy: 4.2286 | Batch Loss: 12.5531  | Perplexity: 282969.3623
2025-09-17 14:39:07,600 - INFO -   Batch 80/100 | Batch Energy: 4.2918 | Batch Loss: 12.8291  | Perplexity: 372923.7369
2025-09-17 14:39:18,094 - INFO -   Batch 90/100 | Batch Energy: 4.2570 | Batch Loss: 12.8641  | Perplexity: 386212.2694
2025-09-17 14:39:29,871 - INFO -   Batch 100/100 | Batch Energy: 4.2050 | Batch Loss: 12.9941  | Perplexity: 439797.2479
2025-09-17 14:39:29,973 - INFO - Epoch 4/5 | Train Energy: 4.2260 | Train Perplexity: 322147.0186
2025-09-17 14:39:29,973 - INFO - Epoch 5/5
2025-09-17 14:39:40,929 - INFO -   Batch 10/100 | Batch Energy: 4.3367 | Batch Loss: 13.3224  | Perplexity: 610725.5491
2025-09-17 14:39:52,112 - INFO -   Batch 20/100 | Batch Energy: 4.1788 | Batch Loss: 13.1441  | Perplexity: 510983.0029
2025-09-17 14:40:02,920 - INFO -   Batch 30/100 | Batch Energy: 4.1802 | Batch Loss: 13.5835  | Perplexity: 792964.9027
2025-09-17 14:40:13,746 - INFO -   Batch 40/100 | Batch Energy: 4.2631 | Batch Loss: 13.3832  | Perplexity: 649008.8287
2025-09-17 14:40:25,030 - INFO -   Batch 50/100 | Batch Energy: 4.3402 | Batch Loss: 13.5701  | Perplexity: 782379.3954
2025-09-17 14:40:35,690 - INFO -   Batch 60/100 | Batch Energy: 4.1751 | Batch Loss: 13.8884  | Perplexity: 1075622.9803
2025-09-17 14:40:46,405 - INFO -   Batch 70/100 | Batch Energy: 4.3929 | Batch Loss: 13.7852  | Perplexity: 970147.0918
2025-09-17 14:40:57,655 - INFO -   Batch 80/100 | Batch Energy: 4.1729 | Batch Loss: 13.7748  | Perplexity: 960068.8180
2025-09-17 14:41:08,892 - INFO -   Batch 90/100 | Batch Energy: 4.2434 | Batch Loss: 14.1349  | Perplexity: 1376296.5205
2025-09-17 14:41:22,522 - INFO -   Batch 100/100 | Batch Energy: 4.4008 | Batch Loss: 14.1436  | Perplexity: 1388321.7283
2025-09-17 14:41:22,622 - INFO - Epoch 5/5 | Train Energy: 4.2659 | Train Perplexity: 846110.4856
2025-09-17 14:41:22,726 - INFO - Saved checkpoint to checkpoints/model_epoch_5.pt
2025-09-17 14:41:23,394 - INFO - Training completed in 589.92 seconds
2025-09-17 14:41:23,394 - INFO - Final model saved to: checkpoints/final_model.pt
2025-09-17 14:41:23,394 - INFO - ========== Training completed ==========
2025-09-17 14:53:15,104 - INFO - 
########################################################################################################################
2025-09-17 14:53:15,105 - INFO - Using device: cpu (local rank 0)
2025-09-17 14:53:15,105 - INFO - Saving the hyperparameters configurations:
2025-09-17 14:53:15,105 - INFO - {
      "vocab_size": 50259,
      "block_size": 176,
      "local_learning_rate": 1e-05,
      "peak_learning_rate": 1.1479716638455936e-05,
      "warmup_steps": 166,
      "la": 0.5,
      "n_embed": 64,
      "dropout": 0.1854371025507931,
      "T": 6,
      "is_holding_error": true,
      "update_bias": true,
      "num_heads": 4,
      "n_blocks": 5,
      "batch_size": 8,
      "num_epochs": 3,
      "use_lateral": true,
      "internal_energy_fn_name": "pc_e",
      "output_energy_fn_name": "pc_e",
      "eos_token_id": null,
      "use_flash_attention": false,
      "combined_internal_weight": 0.3,
      "combined_output_weight": 0.7
}
2025-09-17 14:53:15,335 - INFO - ========== Training started ==========
2025-09-17 14:53:15,335 - INFO - 6.74 M parameters
2025-09-17 14:53:15,335 - INFO - Epoch 1/3
